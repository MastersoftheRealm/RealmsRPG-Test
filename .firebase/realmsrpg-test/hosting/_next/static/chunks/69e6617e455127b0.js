(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31278,e=>{"use strict";let a=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>a],31278)},84004,44604,e=>{"use strict";e.i(45872);var a=e.i(43476),t=e.i(22016);function s(){return(0,a.jsx)("footer",{className:"w-full bg-gray-400 border-t border-[#707070] h-10 flex items-center justify-center mt-auto",children:(0,a.jsxs)("div",{className:"w-full max-w-[1440px] px-4 sm:px-6 lg:px-24 flex items-center justify-between",children:[(0,a.jsx)(t.default,{href:"/terms",className:"font-semibold text-lg text-gray-800 hover:text-gray-900 transition-colors whitespace-nowrap",children:"Terms of Service"}),(0,a.jsx)(t.default,{href:"/privacy",className:"font-semibold text-lg text-gray-800 hover:text-gray-900 transition-colors whitespace-nowrap",children:"Privacy Policy"}),(0,a.jsx)("a",{href:"mailto:RealmsRoleplayGame@gmail.com",className:"font-semibold text-lg text-gray-800 hover:text-gray-900 transition-colors whitespace-nowrap",children:"Contact"}),(0,a.jsx)("a",{href:"https://discord.gg/Dbd5X9FQFJ",target:"_blank",rel:"noopener noreferrer",className:"font-semibold text-lg text-gray-800 hover:text-gray-900 transition-colors whitespace-nowrap",children:"Discord"})]})})}e.s(["Footer",()=>s],44604),e.i(23495),e.s([],84004)},63488,e=>{"use strict";let a=(0,e.i(75254).default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);e.s(["Mail",()=>a],63488)},27612,e=>{"use strict";let a=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>a],27612)},84614,e=>{"use strict";let a=(0,e.i(75254).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>a],84614)},54234,e=>{"use strict";var a=e.i(43476),t=e.i(71645),s=e.i(18566);e.i(51718);var r=e.i(18357);e.i(36180);var l=e.i(98925),i=e.i(67426);e.i(28856);var d=e.i(82943);e.i(84004);var n=e.i(23495);e.i(79121);var c=e.i(49838),o=e.i(84614),m=e.i(63488);let u=(0,e.i(75254).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var x=e.i(27612),p=e.i(78894),h=e.i(43531),y=e.i(37727),g=e.i(31278);function b(){let e=(0,s.useRouter)(),{user:n}=(0,d.useAuthStore)(),[b,f]=(0,t.useState)(null),[w,j]=(0,t.useState)(!0),[v,N]=(0,t.useState)(""),[E,k]=(0,t.useState)(""),[C,P]=(0,t.useState)(!1),[S,D]=(0,t.useState)(null),[A,T]=(0,t.useState)(""),[M,L]=(0,t.useState)(""),[U,q]=(0,t.useState)(""),[F,R]=(0,t.useState)(!1),[I,z]=(0,t.useState)(null),[V,W]=(0,t.useState)(!1),[X,B]=(0,t.useState)(""),[H,K]=(0,t.useState)(""),[O,G]=(0,t.useState)(!1),[J,Q]=(0,t.useState)(null);(0,t.useEffect)(()=>{!async function(){if(n)try{let e=(await (0,l.getDoc)((0,l.doc)(i.db,"users",n.uid))).data();f({username:e?.username,email:n.email||void 0,createdAt:e?.createdAt?.toDate?.()||void 0})}catch(e){console.error("Error loading profile:",e)}finally{j(!1)}}()},[n]);let Z=async e=>{if(e.preventDefault(),n&&n.email){P(!0),D(null);try{let e=r.EmailAuthProvider.credential(n.email,E);await (0,r.reauthenticateWithCredential)(n,e),await (0,r.updateEmail)(n,v),await (0,l.updateDoc)((0,l.doc)(i.db,"users",n.uid),{email:v}),f(e=>e?{...e,email:v}:null),N(""),k(""),D({type:"success",text:"Email updated successfully!"})}catch(a){let e="Failed to update email";"auth/wrong-password"===a.code?e="Incorrect password":"auth/email-already-in-use"===a.code?e="Email already in use":"auth/invalid-email"===a.code&&(e="Invalid email address"),D({type:"error",text:e})}finally{P(!1)}}},_=async e=>{if(e.preventDefault(),n&&n.email){if(M!==U)return void z({type:"error",text:"Passwords do not match"});if(M.length<6)return void z({type:"error",text:"Password must be at least 6 characters"});R(!0),z(null);try{let e=r.EmailAuthProvider.credential(n.email,A);await (0,r.reauthenticateWithCredential)(n,e),await (0,r.updatePassword)(n,M),T(""),L(""),q(""),z({type:"success",text:"Password updated successfully!"})}catch(a){let e="Failed to update password";"auth/wrong-password"===a.code?e="Current password is incorrect":"auth/weak-password"===a.code&&(e="Password is too weak"),z({type:"error",text:e})}finally{R(!1)}}},Y=async()=>{if(n?.email)try{await (0,r.sendPasswordResetEmail)(i.auth,n.email),z({type:"success",text:"Password reset email sent!"})}catch{z({type:"error",text:"Failed to send reset email"})}},$=async()=>{if(n&&n.email&&"DELETE"===H){G(!0),Q(null);try{let a=r.EmailAuthProvider.credential(n.email,X);await (0,r.reauthenticateWithCredential)(n,a);let t=(0,l.collection)(i.db,"users",n.uid,"character");for(let e of(await (0,l.getDocs)(t)).docs)await (0,l.deleteDoc)(e.ref);await (0,l.deleteDoc)((0,l.doc)(i.db,"users",n.uid)),b?.username&&await (0,l.deleteDoc)((0,l.doc)(i.db,"usernames",b.username)),await (0,r.deleteUser)(n),e.push("/")}catch(a){let e="Failed to delete account";"auth/wrong-password"===a.code&&(e="Incorrect password"),Q(e),G(!1)}}};return w?(0,a.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,a.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),(0,a.jsx)("div",{className:"h-48 bg-gray-200 rounded"}),(0,a.jsx)("div",{className:"h-48 bg-gray-200 rounded"})]})}):(0,a.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[(0,a.jsx)(o.User,{className:"w-8 h-8 text-primary-600"}),"My Account"]}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage your profile and account settings"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"Profile Information"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-gray-100",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Username"}),(0,a.jsx)("span",{className:"font-medium text-gray-900",children:b?.username||"Not set"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-gray-100",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Email"}),(0,a.jsx)("span",{className:"font-medium text-gray-900",children:b?.email})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between py-2",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Member Since"}),(0,a.jsx)("span",{className:"font-medium text-gray-900",children:b?.createdAt?.toLocaleDateString()||"Unknown"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,a.jsxs)("h2",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[(0,a.jsx)(m.Mail,{className:"w-5 h-5 text-gray-600"}),"Change Email"]}),(0,a.jsxs)("form",{onSubmit:Z,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Email Address"}),(0,a.jsx)("input",{type:"email",value:v,onChange:e=>N(e.target.value),required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter new email"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),(0,a.jsx)("input",{type:"password",value:E,onChange:e=>k(e.target.value),required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter current password"})]}),S&&(0,a.jsxs)("div",{className:(0,c.cn)("p-3 rounded-lg text-sm flex items-center gap-2","success"===S.type?"bg-green-50 text-green-700":"bg-red-50 text-red-700"),children:["success"===S.type?(0,a.jsx)(h.Check,{className:"w-4 h-4"}):(0,a.jsx)(y.X,{className:"w-4 h-4"}),S.text]}),(0,a.jsxs)("button",{type:"submit",disabled:C||!v||!E,className:"px-4 py-2 bg-primary-600 text-white rounded-lg font-medium hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[C&&(0,a.jsx)(g.Loader2,{className:"w-4 h-4 animate-spin"}),"Update Email"]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,a.jsxs)("h2",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[(0,a.jsx)(u,{className:"w-5 h-5 text-gray-600"}),"Change Password"]}),(0,a.jsxs)("form",{onSubmit:_,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),(0,a.jsx)("input",{type:"password",value:A,onChange:e=>T(e.target.value),required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter current password"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),(0,a.jsx)("input",{type:"password",value:M,onChange:e=>L(e.target.value),required:!0,minLength:6,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter new password"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),(0,a.jsx)("input",{type:"password",value:U,onChange:e=>q(e.target.value),required:!0,minLength:6,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Confirm new password"})]}),I&&(0,a.jsxs)("div",{className:(0,c.cn)("p-3 rounded-lg text-sm flex items-center gap-2","success"===I.type?"bg-green-50 text-green-700":"bg-red-50 text-red-700"),children:["success"===I.type?(0,a.jsx)(h.Check,{className:"w-4 h-4"}):(0,a.jsx)(y.X,{className:"w-4 h-4"}),I.text]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("button",{type:"submit",disabled:F||!A||!M||!U,className:"px-4 py-2 bg-primary-600 text-white rounded-lg font-medium hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[F&&(0,a.jsx)(g.Loader2,{className:"w-4 h-4 animate-spin"}),"Update Password"]}),(0,a.jsx)("button",{type:"button",onClick:Y,className:"text-sm text-primary-600 hover:text-primary-700 hover:underline",children:"Send password reset email instead"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 border-2 border-red-200",children:[(0,a.jsxs)("h2",{className:"text-lg font-bold text-red-700 mb-4 flex items-center gap-2",children:[(0,a.jsx)(p.AlertTriangle,{className:"w-5 h-5"}),"Danger Zone"]}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Deleting your account is permanent and cannot be undone. All your characters, creations, and data will be permanently deleted."}),V?(0,a.jsxs)("div",{className:"bg-red-50 rounded-lg p-4 space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-red-700 font-medium",children:"To confirm deletion, enter your password and type DELETE below:"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-red-700 mb-1",children:"Password"}),(0,a.jsx)("input",{type:"password",value:X,onChange:e=>B(e.target.value),className:"w-full px-4 py-2 border border-red-300 rounded-lg focus:ring-2 focus:ring-red-500",placeholder:"Enter your password"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-red-700 mb-1",children:"Type DELETE to confirm"}),(0,a.jsx)("input",{type:"text",value:H,onChange:e=>K(e.target.value),className:"w-full px-4 py-2 border border-red-300 rounded-lg focus:ring-2 focus:ring-red-500",placeholder:"DELETE"})]}),J&&(0,a.jsx)("div",{className:"p-3 rounded-lg bg-red-100 text-red-700 text-sm",children:J}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)("button",{onClick:$,disabled:O||"DELETE"!==H||!X,className:"px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[O&&(0,a.jsx)(g.Loader2,{className:"w-4 h-4 animate-spin"}),"Permanently Delete Account"]}),(0,a.jsx)("button",{onClick:()=>{W(!1),B(""),K(""),Q(null)},className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"})]})]}):(0,a.jsxs)("button",{onClick:()=>W(!0),className:"px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 flex items-center gap-2",children:[(0,a.jsx)(x.Trash2,{className:"w-4 h-4"}),"Delete My Account"]})]})]})}function f(){return(0,a.jsx)(n.ProtectedRoute,{children:(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 py-8 px-4",children:(0,a.jsx)(b,{})})})}e.s(["default",()=>f],54234)}]);