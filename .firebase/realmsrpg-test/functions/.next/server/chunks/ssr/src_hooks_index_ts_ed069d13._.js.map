{"version":3,"sources":["../../../../src/hooks/use-user-library.ts","../../../../src/hooks/index.ts","../../../../node_modules/%40tanstack/react-query/build/modern/QueryErrorResetBoundary.js","../../../../node_modules/%40tanstack/react-query/build/modern/errorBoundaryUtils.js","../../../../node_modules/%40tanstack/react-query/build/modern/IsRestoringProvider.js","../../../../node_modules/%40tanstack/react-query/build/modern/suspense.js","../../../../node_modules/%40tanstack/react-query/build/modern/useBaseQuery.js","../../../../node_modules/%40tanstack/react-query/build/modern/useQuery.js","../../../../node_modules/%40tanstack/query-core/build/modern/mutationObserver.js","../../../../node_modules/%40tanstack/react-query/build/modern/useMutation.js","../../../../node_modules/%40tanstack/query-core/build/modern/queryObserver.js","../../../../src/services/character-service.ts","../../../../src/hooks/use-characters.ts","../../../../src/services/game-data-service.ts","../../../../src/hooks/use-game-data.ts","../../../../src/hooks/use-rtdb.ts","../../../../src/hooks/use-auto-save.ts"],"sourcesContent":["/**\r\n * User Library Hooks\r\n * ===================\r\n * React Query hooks for fetching user-specific library data from Firestore\r\n * (powers, techniques, items/armaments, creatures)\r\n */\r\n\r\n'use client';\r\n\r\nimport { useQuery, useMutation, useQueryClient, UseQueryResult, UseMutationResult } from '@tanstack/react-query';\r\nimport { collection, getDocs, doc, deleteDoc, addDoc, updateDoc, query, orderBy } from 'firebase/firestore';\r\nimport { db } from '@/lib/firebase/client';\r\nimport { useAuthStore } from '@/stores/auth-store';\r\n\r\n// =============================================================================\r\n// Types\r\n// =============================================================================\r\n\r\n// Part with option levels as saved to Firestore\r\nexport interface SavedPart {\r\n  id?: number;\r\n  name?: string;\r\n  op_1_lvl?: number;\r\n  op_2_lvl?: number;\r\n  op_3_lvl?: number;\r\n  applyDuration?: boolean;\r\n}\r\n\r\n// Damage entry as saved to Firestore\r\nexport interface SavedDamage {\r\n  amount?: number | string;\r\n  size?: number | string;\r\n  type?: string;\r\n  applyDuration?: boolean;\r\n}\r\n\r\nexport interface UserPower {\r\n  id: string;\r\n  docId: string;\r\n  name: string;\r\n  description?: string;\r\n  parts: SavedPart[];\r\n  damage?: SavedDamage[];\r\n  createdAt?: Date;\r\n  updatedAt?: Date;\r\n}\r\n\r\nexport interface UserTechnique {\r\n  id: string;\r\n  docId: string;\r\n  name: string;\r\n  description?: string;\r\n  parts: SavedPart[];\r\n  damage?: SavedDamage[];\r\n  weapon?: {\r\n    id?: number;\r\n    name?: string;\r\n  };\r\n  createdAt?: Date;\r\n  updatedAt?: Date;\r\n}\r\n\r\nexport interface UserItem {\r\n  id: string;\r\n  docId: string;\r\n  name: string;\r\n  description?: string;\r\n  type: 'weapon' | 'armor' | 'equipment';\r\n  properties: string[];\r\n  damage?: string;\r\n  armorValue?: number;\r\n  createdAt?: Date;\r\n  updatedAt?: Date;\r\n}\r\n\r\nexport interface UserCreature {\r\n  id: string;\r\n  docId: string;\r\n  name: string;\r\n  description?: string;\r\n  level: number;\r\n  type?: string;\r\n  size?: string;\r\n  hp?: number;\r\n  abilities?: Record<string, number>;\r\n  attacks?: unknown[];\r\n  createdAt?: Date;\r\n  updatedAt?: Date;\r\n}\r\n\r\n// =============================================================================\r\n// Query Keys\r\n// =============================================================================\r\n\r\nconst QUERY_KEYS = {\r\n  userPowers: (userId: string) => ['user-powers', userId] as const,\r\n  userTechniques: (userId: string) => ['user-techniques', userId] as const,\r\n  userItems: (userId: string) => ['user-items', userId] as const,\r\n  userCreatures: (userId: string) => ['user-creatures', userId] as const,\r\n};\r\n\r\n// =============================================================================\r\n// Fetch Functions\r\n// =============================================================================\r\n\r\nasync function fetchUserPowers(userId: string): Promise<UserPower[]> {\r\n  if (!userId) return [];\r\n  \r\n  const colRef = collection(db, 'users', userId, 'library');\r\n  const q = query(colRef, orderBy('name'));\r\n  const snapshot = await getDocs(q);\r\n  \r\n  return snapshot.docs.map(doc => ({\r\n    id: doc.id,\r\n    docId: doc.id,\r\n    ...doc.data(),\r\n  })) as UserPower[];\r\n}\r\n\r\nasync function fetchUserTechniques(userId: string): Promise<UserTechnique[]> {\r\n  if (!userId) return [];\r\n  \r\n  const colRef = collection(db, 'users', userId, 'techniqueLibrary');\r\n  const q = query(colRef, orderBy('name'));\r\n  const snapshot = await getDocs(q);\r\n  \r\n  return snapshot.docs.map(doc => ({\r\n    id: doc.id,\r\n    docId: doc.id,\r\n    ...doc.data(),\r\n  })) as UserTechnique[];\r\n}\r\n\r\nasync function fetchUserItems(userId: string): Promise<UserItem[]> {\r\n  if (!userId) return [];\r\n  \r\n  const colRef = collection(db, 'users', userId, 'itemLibrary');\r\n  const q = query(colRef, orderBy('name'));\r\n  const snapshot = await getDocs(q);\r\n  \r\n  return snapshot.docs.map(doc => ({\r\n    id: doc.id,\r\n    docId: doc.id,\r\n    ...doc.data(),\r\n  })) as UserItem[];\r\n}\r\n\r\nasync function fetchUserCreatures(userId: string): Promise<UserCreature[]> {\r\n  if (!userId) return [];\r\n  \r\n  const colRef = collection(db, 'users', userId, 'creatureLibrary');\r\n  const q = query(colRef, orderBy('name'));\r\n  const snapshot = await getDocs(q);\r\n  \r\n  return snapshot.docs.map(doc => ({\r\n    id: doc.id,\r\n    docId: doc.id,\r\n    ...doc.data(),\r\n  })) as UserCreature[];\r\n}\r\n\r\n// =============================================================================\r\n// Hooks\r\n// =============================================================================\r\n\r\nexport function useUserPowers(): UseQueryResult<UserPower[], Error> {\r\n  const { user } = useAuthStore();\r\n  const userId = user?.uid || '';\r\n  \r\n  return useQuery({\r\n    queryKey: QUERY_KEYS.userPowers(userId),\r\n    queryFn: () => fetchUserPowers(userId),\r\n    enabled: !!userId,\r\n    staleTime: 2 * 60 * 1000, // 2 minutes\r\n    gcTime: 10 * 60 * 1000, // 10 minutes\r\n  });\r\n}\r\n\r\nexport function useUserTechniques(): UseQueryResult<UserTechnique[], Error> {\r\n  const { user } = useAuthStore();\r\n  const userId = user?.uid || '';\r\n  \r\n  return useQuery({\r\n    queryKey: QUERY_KEYS.userTechniques(userId),\r\n    queryFn: () => fetchUserTechniques(userId),\r\n    enabled: !!userId,\r\n    staleTime: 2 * 60 * 1000,\r\n    gcTime: 10 * 60 * 1000,\r\n  });\r\n}\r\n\r\nexport function useUserItems(): UseQueryResult<UserItem[], Error> {\r\n  const { user } = useAuthStore();\r\n  const userId = user?.uid || '';\r\n  \r\n  return useQuery({\r\n    queryKey: QUERY_KEYS.userItems(userId),\r\n    queryFn: () => fetchUserItems(userId),\r\n    enabled: !!userId,\r\n    staleTime: 2 * 60 * 1000,\r\n    gcTime: 10 * 60 * 1000,\r\n  });\r\n}\r\n\r\nexport function useUserCreatures(): UseQueryResult<UserCreature[], Error> {\r\n  const { user } = useAuthStore();\r\n  const userId = user?.uid || '';\r\n  \r\n  return useQuery({\r\n    queryKey: QUERY_KEYS.userCreatures(userId),\r\n    queryFn: () => fetchUserCreatures(userId),\r\n    enabled: !!userId,\r\n    staleTime: 2 * 60 * 1000,\r\n    gcTime: 10 * 60 * 1000,\r\n  });\r\n}\r\n\r\n// =============================================================================\r\n// Mutations\r\n// =============================================================================\r\n\r\nexport function useDeletePower(): UseMutationResult<void, Error, string> {\r\n  const { user } = useAuthStore();\r\n  const queryClient = useQueryClient();\r\n  \r\n  return useMutation({\r\n    mutationFn: async (docId: string) => {\r\n      if (!user?.uid) throw new Error('Not authenticated');\r\n      await deleteDoc(doc(db, 'users', user.uid, 'library', docId));\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ \r\n        queryKey: QUERY_KEYS.userPowers(user?.uid || '') \r\n      });\r\n    },\r\n  });\r\n}\r\n\r\nexport function useDeleteTechnique(): UseMutationResult<void, Error, string> {\r\n  const { user } = useAuthStore();\r\n  const queryClient = useQueryClient();\r\n  \r\n  return useMutation({\r\n    mutationFn: async (docId: string) => {\r\n      if (!user?.uid) throw new Error('Not authenticated');\r\n      await deleteDoc(doc(db, 'users', user.uid, 'techniqueLibrary', docId));\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ \r\n        queryKey: QUERY_KEYS.userTechniques(user?.uid || '') \r\n      });\r\n    },\r\n  });\r\n}\r\n\r\nexport function useDeleteItem(): UseMutationResult<void, Error, string> {\r\n  const { user } = useAuthStore();\r\n  const queryClient = useQueryClient();\r\n  \r\n  return useMutation({\r\n    mutationFn: async (docId: string) => {\r\n      if (!user?.uid) throw new Error('Not authenticated');\r\n      await deleteDoc(doc(db, 'users', user.uid, 'itemLibrary', docId));\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ \r\n        queryKey: QUERY_KEYS.userItems(user?.uid || '') \r\n      });\r\n    },\r\n  });\r\n}\r\n\r\nexport function useDeleteCreature(): UseMutationResult<void, Error, string> {\r\n  const { user } = useAuthStore();\r\n  const queryClient = useQueryClient();\r\n  \r\n  return useMutation({\r\n    mutationFn: async (docId: string) => {\r\n      if (!user?.uid) throw new Error('Not authenticated');\r\n      await deleteDoc(doc(db, 'users', user.uid, 'creatureLibrary', docId));\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ \r\n        queryKey: QUERY_KEYS.userCreatures(user?.uid || '') \r\n      });\r\n    },\r\n  });\r\n}\r\n","/**\n * Hooks Index\n * ============\n * Export all custom hooks\n */\n\n// Auth\nexport { useAuth, useAuthStore } from './use-auth';\n\n// Characters\nexport {\n  characterKeys,\n  useCharacters,\n  useCharacter,\n  useSaveCharacter,\n  useCreateCharacter,\n  useDeleteCharacter,\n  useDuplicateCharacter,\n} from './use-characters';\n\n// Game Data\nexport {\n  gameDataKeys,\n  useArchetypes,\n  useArchetype,\n  useSkills,\n  useSkill,\n  useFeats,\n  useFeat,\n  useAncestries,\n  useAncestry,\n  useGameData,\n  useGameDataList,\n} from './use-game-data';\n\n// RTDB Data (Codex, Parts, Properties)\nexport {\n  useFeats as useRTDBFeats,\n  useSkills as useRTDBSkills,\n  useSpecies,\n  useTraits,\n  usePowerParts,\n  useTechniqueParts,\n  useParts,\n  useItemProperties,\n  useEquipment,\n  prefetchFunctions,\n  type Feat as RTDBFeat,\n  type Skill as RTDBSkill,\n  type Species,\n  type Trait,\n  type PowerPart,\n  type TechniquePart,\n  type Part,\n  type ItemProperty,\n  type EquipmentItem,\n} from './use-rtdb';\n\n// User Library (user-specific content)\nexport {\n  useUserPowers,\n  useUserTechniques,\n  useUserItems,\n  useUserCreatures,\n  useDeletePower,\n  useDeleteTechnique,\n  useDeleteItem,\n  useDeleteCreature,\n  type UserPower,\n  type UserTechnique,\n  type UserItem,\n  type UserCreature,\n  type SavedPart,\n  type SavedDamage,\n} from './use-user-library';\n\n// Auto-save\nexport { useAutoSave } from './use-auto-save';\n","\"use client\";\n\n// src/QueryErrorResetBoundary.tsx\nimport * as React from \"react\";\nimport { jsx } from \"react/jsx-runtime\";\nfunction createValue() {\n  let isReset = false;\n  return {\n    clearReset: () => {\n      isReset = false;\n    },\n    reset: () => {\n      isReset = true;\n    },\n    isReset: () => {\n      return isReset;\n    }\n  };\n}\nvar QueryErrorResetBoundaryContext = React.createContext(createValue());\nvar useQueryErrorResetBoundary = () => React.useContext(QueryErrorResetBoundaryContext);\nvar QueryErrorResetBoundary = ({\n  children\n}) => {\n  const [value] = React.useState(() => createValue());\n  return /* @__PURE__ */ jsx(QueryErrorResetBoundaryContext.Provider, { value, children: typeof children === \"function\" ? children(value) : children });\n};\nexport {\n  QueryErrorResetBoundary,\n  useQueryErrorResetBoundary\n};\n//# sourceMappingURL=QueryErrorResetBoundary.js.map","\"use client\";\n\n// src/errorBoundaryUtils.ts\nimport * as React from \"react\";\nimport { shouldThrowError } from \"@tanstack/query-core\";\nvar ensurePreventErrorBoundaryRetry = (options, errorResetBoundary, query) => {\n  const throwOnError = query?.state.error && typeof options.throwOnError === \"function\" ? shouldThrowError(options.throwOnError, [query.state.error, query]) : options.throwOnError;\n  if (options.suspense || options.experimental_prefetchInRender || throwOnError) {\n    if (!errorResetBoundary.isReset()) {\n      options.retryOnMount = false;\n    }\n  }\n};\nvar useClearResetErrorBoundary = (errorResetBoundary) => {\n  React.useEffect(() => {\n    errorResetBoundary.clearReset();\n  }, [errorResetBoundary]);\n};\nvar getHasError = ({\n  result,\n  errorResetBoundary,\n  throwOnError,\n  query,\n  suspense\n}) => {\n  return result.isError && !errorResetBoundary.isReset() && !result.isFetching && query && (suspense && result.data === void 0 || shouldThrowError(throwOnError, [result.error, query]));\n};\nexport {\n  ensurePreventErrorBoundaryRetry,\n  getHasError,\n  useClearResetErrorBoundary\n};\n//# sourceMappingURL=errorBoundaryUtils.js.map","\"use client\";\n\n// src/IsRestoringProvider.ts\nimport * as React from \"react\";\nvar IsRestoringContext = React.createContext(false);\nvar useIsRestoring = () => React.useContext(IsRestoringContext);\nvar IsRestoringProvider = IsRestoringContext.Provider;\nexport {\n  IsRestoringProvider,\n  useIsRestoring\n};\n//# sourceMappingURL=IsRestoringProvider.js.map","// src/suspense.ts\nvar defaultThrowOnError = (_error, query) => query.state.data === void 0;\nvar ensureSuspenseTimers = (defaultedOptions) => {\n  if (defaultedOptions.suspense) {\n    const MIN_SUSPENSE_TIME_MS = 1e3;\n    const clamp = (value) => value === \"static\" ? value : Math.max(value ?? MIN_SUSPENSE_TIME_MS, MIN_SUSPENSE_TIME_MS);\n    const originalStaleTime = defaultedOptions.staleTime;\n    defaultedOptions.staleTime = typeof originalStaleTime === \"function\" ? (...args) => clamp(originalStaleTime(...args)) : clamp(originalStaleTime);\n    if (typeof defaultedOptions.gcTime === \"number\") {\n      defaultedOptions.gcTime = Math.max(\n        defaultedOptions.gcTime,\n        MIN_SUSPENSE_TIME_MS\n      );\n    }\n  }\n};\nvar willFetch = (result, isRestoring) => result.isLoading && result.isFetching && !isRestoring;\nvar shouldSuspend = (defaultedOptions, result) => defaultedOptions?.suspense && result.isPending;\nvar fetchOptimistic = (defaultedOptions, observer, errorResetBoundary) => observer.fetchOptimistic(defaultedOptions).catch(() => {\n  errorResetBoundary.clearReset();\n});\nexport {\n  defaultThrowOnError,\n  ensureSuspenseTimers,\n  fetchOptimistic,\n  shouldSuspend,\n  willFetch\n};\n//# sourceMappingURL=suspense.js.map","\"use client\";\n\n// src/useBaseQuery.ts\nimport * as React from \"react\";\nimport { isServer, noop, notifyManager } from \"@tanstack/query-core\";\nimport { useQueryClient } from \"./QueryClientProvider.js\";\nimport { useQueryErrorResetBoundary } from \"./QueryErrorResetBoundary.js\";\nimport {\n  ensurePreventErrorBoundaryRetry,\n  getHasError,\n  useClearResetErrorBoundary\n} from \"./errorBoundaryUtils.js\";\nimport { useIsRestoring } from \"./IsRestoringProvider.js\";\nimport {\n  ensureSuspenseTimers,\n  fetchOptimistic,\n  shouldSuspend,\n  willFetch\n} from \"./suspense.js\";\nfunction useBaseQuery(options, Observer, queryClient) {\n  if (process.env.NODE_ENV !== \"production\") {\n    if (typeof options !== \"object\" || Array.isArray(options)) {\n      throw new Error(\n        'Bad argument type. Starting with v5, only the \"Object\" form is allowed when calling query related functions. Please use the error stack to find the culprit call. More info here: https://tanstack.com/query/latest/docs/react/guides/migrating-to-v5#supports-a-single-signature-one-object'\n      );\n    }\n  }\n  const isRestoring = useIsRestoring();\n  const errorResetBoundary = useQueryErrorResetBoundary();\n  const client = useQueryClient(queryClient);\n  const defaultedOptions = client.defaultQueryOptions(options);\n  client.getDefaultOptions().queries?._experimental_beforeQuery?.(\n    defaultedOptions\n  );\n  const query = client.getQueryCache().get(defaultedOptions.queryHash);\n  if (process.env.NODE_ENV !== \"production\") {\n    if (!defaultedOptions.queryFn) {\n      console.error(\n        `[${defaultedOptions.queryHash}]: No queryFn was passed as an option, and no default queryFn was found. The queryFn parameter is only optional when using a default queryFn. More info here: https://tanstack.com/query/latest/docs/framework/react/guides/default-query-function`\n      );\n    }\n  }\n  defaultedOptions._optimisticResults = isRestoring ? \"isRestoring\" : \"optimistic\";\n  ensureSuspenseTimers(defaultedOptions);\n  ensurePreventErrorBoundaryRetry(defaultedOptions, errorResetBoundary, query);\n  useClearResetErrorBoundary(errorResetBoundary);\n  const isNewCacheEntry = !client.getQueryCache().get(defaultedOptions.queryHash);\n  const [observer] = React.useState(\n    () => new Observer(\n      client,\n      defaultedOptions\n    )\n  );\n  const result = observer.getOptimisticResult(defaultedOptions);\n  const shouldSubscribe = !isRestoring && options.subscribed !== false;\n  React.useSyncExternalStore(\n    React.useCallback(\n      (onStoreChange) => {\n        const unsubscribe = shouldSubscribe ? observer.subscribe(notifyManager.batchCalls(onStoreChange)) : noop;\n        observer.updateResult();\n        return unsubscribe;\n      },\n      [observer, shouldSubscribe]\n    ),\n    () => observer.getCurrentResult(),\n    () => observer.getCurrentResult()\n  );\n  React.useEffect(() => {\n    observer.setOptions(defaultedOptions);\n  }, [defaultedOptions, observer]);\n  if (shouldSuspend(defaultedOptions, result)) {\n    throw fetchOptimistic(defaultedOptions, observer, errorResetBoundary);\n  }\n  if (getHasError({\n    result,\n    errorResetBoundary,\n    throwOnError: defaultedOptions.throwOnError,\n    query,\n    suspense: defaultedOptions.suspense\n  })) {\n    throw result.error;\n  }\n  ;\n  client.getDefaultOptions().queries?._experimental_afterQuery?.(\n    defaultedOptions,\n    result\n  );\n  if (defaultedOptions.experimental_prefetchInRender && !isServer && willFetch(result, isRestoring)) {\n    const promise = isNewCacheEntry ? (\n      // Fetch immediately on render in order to ensure `.promise` is resolved even if the component is unmounted\n      fetchOptimistic(defaultedOptions, observer, errorResetBoundary)\n    ) : (\n      // subscribe to the \"cache promise\" so that we can finalize the currentThenable once data comes in\n      query?.promise\n    );\n    promise?.catch(noop).finally(() => {\n      observer.updateResult();\n    });\n  }\n  return !defaultedOptions.notifyOnChangeProps ? observer.trackResult(result) : result;\n}\nexport {\n  useBaseQuery\n};\n//# sourceMappingURL=useBaseQuery.js.map","\"use client\";\n\n// src/useQuery.ts\nimport { QueryObserver } from \"@tanstack/query-core\";\nimport { useBaseQuery } from \"./useBaseQuery.js\";\nfunction useQuery(options, queryClient) {\n  return useBaseQuery(options, QueryObserver, queryClient);\n}\nexport {\n  useQuery\n};\n//# sourceMappingURL=useQuery.js.map","// src/mutationObserver.ts\nimport { getDefaultState } from \"./mutation.js\";\nimport { notifyManager } from \"./notifyManager.js\";\nimport { Subscribable } from \"./subscribable.js\";\nimport { hashKey, shallowEqualObjects } from \"./utils.js\";\nvar MutationObserver = class extends Subscribable {\n  #client;\n  #currentResult = void 0;\n  #currentMutation;\n  #mutateOptions;\n  constructor(client, options) {\n    super();\n    this.#client = client;\n    this.setOptions(options);\n    this.bindMethods();\n    this.#updateResult();\n  }\n  bindMethods() {\n    this.mutate = this.mutate.bind(this);\n    this.reset = this.reset.bind(this);\n  }\n  setOptions(options) {\n    const prevOptions = this.options;\n    this.options = this.#client.defaultMutationOptions(options);\n    if (!shallowEqualObjects(this.options, prevOptions)) {\n      this.#client.getMutationCache().notify({\n        type: \"observerOptionsUpdated\",\n        mutation: this.#currentMutation,\n        observer: this\n      });\n    }\n    if (prevOptions?.mutationKey && this.options.mutationKey && hashKey(prevOptions.mutationKey) !== hashKey(this.options.mutationKey)) {\n      this.reset();\n    } else if (this.#currentMutation?.state.status === \"pending\") {\n      this.#currentMutation.setOptions(this.options);\n    }\n  }\n  onUnsubscribe() {\n    if (!this.hasListeners()) {\n      this.#currentMutation?.removeObserver(this);\n    }\n  }\n  onMutationUpdate(action) {\n    this.#updateResult();\n    this.#notify(action);\n  }\n  getCurrentResult() {\n    return this.#currentResult;\n  }\n  reset() {\n    this.#currentMutation?.removeObserver(this);\n    this.#currentMutation = void 0;\n    this.#updateResult();\n    this.#notify();\n  }\n  mutate(variables, options) {\n    this.#mutateOptions = options;\n    this.#currentMutation?.removeObserver(this);\n    this.#currentMutation = this.#client.getMutationCache().build(this.#client, this.options);\n    this.#currentMutation.addObserver(this);\n    return this.#currentMutation.execute(variables);\n  }\n  #updateResult() {\n    const state = this.#currentMutation?.state ?? getDefaultState();\n    this.#currentResult = {\n      ...state,\n      isPending: state.status === \"pending\",\n      isSuccess: state.status === \"success\",\n      isError: state.status === \"error\",\n      isIdle: state.status === \"idle\",\n      mutate: this.mutate,\n      reset: this.reset\n    };\n  }\n  #notify(action) {\n    notifyManager.batch(() => {\n      if (this.#mutateOptions && this.hasListeners()) {\n        const variables = this.#currentResult.variables;\n        const onMutateResult = this.#currentResult.context;\n        const context = {\n          client: this.#client,\n          meta: this.options.meta,\n          mutationKey: this.options.mutationKey\n        };\n        if (action?.type === \"success\") {\n          try {\n            this.#mutateOptions.onSuccess?.(\n              action.data,\n              variables,\n              onMutateResult,\n              context\n            );\n          } catch (e) {\n            void Promise.reject(e);\n          }\n          try {\n            this.#mutateOptions.onSettled?.(\n              action.data,\n              null,\n              variables,\n              onMutateResult,\n              context\n            );\n          } catch (e) {\n            void Promise.reject(e);\n          }\n        } else if (action?.type === \"error\") {\n          try {\n            this.#mutateOptions.onError?.(\n              action.error,\n              variables,\n              onMutateResult,\n              context\n            );\n          } catch (e) {\n            void Promise.reject(e);\n          }\n          try {\n            this.#mutateOptions.onSettled?.(\n              void 0,\n              action.error,\n              variables,\n              onMutateResult,\n              context\n            );\n          } catch (e) {\n            void Promise.reject(e);\n          }\n        }\n      }\n      this.listeners.forEach((listener) => {\n        listener(this.#currentResult);\n      });\n    });\n  }\n};\nexport {\n  MutationObserver\n};\n//# sourceMappingURL=mutationObserver.js.map","\"use client\";\n\n// src/useMutation.ts\nimport * as React from \"react\";\nimport {\n  MutationObserver,\n  noop,\n  notifyManager,\n  shouldThrowError\n} from \"@tanstack/query-core\";\nimport { useQueryClient } from \"./QueryClientProvider.js\";\nfunction useMutation(options, queryClient) {\n  const client = useQueryClient(queryClient);\n  const [observer] = React.useState(\n    () => new MutationObserver(\n      client,\n      options\n    )\n  );\n  React.useEffect(() => {\n    observer.setOptions(options);\n  }, [observer, options]);\n  const result = React.useSyncExternalStore(\n    React.useCallback(\n      (onStoreChange) => observer.subscribe(notifyManager.batchCalls(onStoreChange)),\n      [observer]\n    ),\n    () => observer.getCurrentResult(),\n    () => observer.getCurrentResult()\n  );\n  const mutate = React.useCallback(\n    (variables, mutateOptions) => {\n      observer.mutate(variables, mutateOptions).catch(noop);\n    },\n    [observer]\n  );\n  if (result.error && shouldThrowError(observer.options.throwOnError, [result.error])) {\n    throw result.error;\n  }\n  return { ...result, mutate, mutateAsync: result.mutate };\n}\nexport {\n  useMutation\n};\n//# sourceMappingURL=useMutation.js.map","// src/queryObserver.ts\nimport { focusManager } from \"./focusManager.js\";\nimport { notifyManager } from \"./notifyManager.js\";\nimport { fetchState } from \"./query.js\";\nimport { Subscribable } from \"./subscribable.js\";\nimport { pendingThenable } from \"./thenable.js\";\nimport {\n  isServer,\n  isValidTimeout,\n  noop,\n  replaceData,\n  resolveEnabled,\n  resolveStaleTime,\n  shallowEqualObjects,\n  timeUntilStale\n} from \"./utils.js\";\nimport { timeoutManager } from \"./timeoutManager.js\";\nvar QueryObserver = class extends Subscribable {\n  constructor(client, options) {\n    super();\n    this.options = options;\n    this.#client = client;\n    this.#selectError = null;\n    this.#currentThenable = pendingThenable();\n    this.bindMethods();\n    this.setOptions(options);\n  }\n  #client;\n  #currentQuery = void 0;\n  #currentQueryInitialState = void 0;\n  #currentResult = void 0;\n  #currentResultState;\n  #currentResultOptions;\n  #currentThenable;\n  #selectError;\n  #selectFn;\n  #selectResult;\n  // This property keeps track of the last query with defined data.\n  // It will be used to pass the previous data and query to the placeholder function between renders.\n  #lastQueryWithDefinedData;\n  #staleTimeoutId;\n  #refetchIntervalId;\n  #currentRefetchInterval;\n  #trackedProps = /* @__PURE__ */ new Set();\n  bindMethods() {\n    this.refetch = this.refetch.bind(this);\n  }\n  onSubscribe() {\n    if (this.listeners.size === 1) {\n      this.#currentQuery.addObserver(this);\n      if (shouldFetchOnMount(this.#currentQuery, this.options)) {\n        this.#executeFetch();\n      } else {\n        this.updateResult();\n      }\n      this.#updateTimers();\n    }\n  }\n  onUnsubscribe() {\n    if (!this.hasListeners()) {\n      this.destroy();\n    }\n  }\n  shouldFetchOnReconnect() {\n    return shouldFetchOn(\n      this.#currentQuery,\n      this.options,\n      this.options.refetchOnReconnect\n    );\n  }\n  shouldFetchOnWindowFocus() {\n    return shouldFetchOn(\n      this.#currentQuery,\n      this.options,\n      this.options.refetchOnWindowFocus\n    );\n  }\n  destroy() {\n    this.listeners = /* @__PURE__ */ new Set();\n    this.#clearStaleTimeout();\n    this.#clearRefetchInterval();\n    this.#currentQuery.removeObserver(this);\n  }\n  setOptions(options) {\n    const prevOptions = this.options;\n    const prevQuery = this.#currentQuery;\n    this.options = this.#client.defaultQueryOptions(options);\n    if (this.options.enabled !== void 0 && typeof this.options.enabled !== \"boolean\" && typeof this.options.enabled !== \"function\" && typeof resolveEnabled(this.options.enabled, this.#currentQuery) !== \"boolean\") {\n      throw new Error(\n        \"Expected enabled to be a boolean or a callback that returns a boolean\"\n      );\n    }\n    this.#updateQuery();\n    this.#currentQuery.setOptions(this.options);\n    if (prevOptions._defaulted && !shallowEqualObjects(this.options, prevOptions)) {\n      this.#client.getQueryCache().notify({\n        type: \"observerOptionsUpdated\",\n        query: this.#currentQuery,\n        observer: this\n      });\n    }\n    const mounted = this.hasListeners();\n    if (mounted && shouldFetchOptionally(\n      this.#currentQuery,\n      prevQuery,\n      this.options,\n      prevOptions\n    )) {\n      this.#executeFetch();\n    }\n    this.updateResult();\n    if (mounted && (this.#currentQuery !== prevQuery || resolveEnabled(this.options.enabled, this.#currentQuery) !== resolveEnabled(prevOptions.enabled, this.#currentQuery) || resolveStaleTime(this.options.staleTime, this.#currentQuery) !== resolveStaleTime(prevOptions.staleTime, this.#currentQuery))) {\n      this.#updateStaleTimeout();\n    }\n    const nextRefetchInterval = this.#computeRefetchInterval();\n    if (mounted && (this.#currentQuery !== prevQuery || resolveEnabled(this.options.enabled, this.#currentQuery) !== resolveEnabled(prevOptions.enabled, this.#currentQuery) || nextRefetchInterval !== this.#currentRefetchInterval)) {\n      this.#updateRefetchInterval(nextRefetchInterval);\n    }\n  }\n  getOptimisticResult(options) {\n    const query = this.#client.getQueryCache().build(this.#client, options);\n    const result = this.createResult(query, options);\n    if (shouldAssignObserverCurrentProperties(this, result)) {\n      this.#currentResult = result;\n      this.#currentResultOptions = this.options;\n      this.#currentResultState = this.#currentQuery.state;\n    }\n    return result;\n  }\n  getCurrentResult() {\n    return this.#currentResult;\n  }\n  trackResult(result, onPropTracked) {\n    return new Proxy(result, {\n      get: (target, key) => {\n        this.trackProp(key);\n        onPropTracked?.(key);\n        if (key === \"promise\") {\n          this.trackProp(\"data\");\n          if (!this.options.experimental_prefetchInRender && this.#currentThenable.status === \"pending\") {\n            this.#currentThenable.reject(\n              new Error(\n                \"experimental_prefetchInRender feature flag is not enabled\"\n              )\n            );\n          }\n        }\n        return Reflect.get(target, key);\n      }\n    });\n  }\n  trackProp(key) {\n    this.#trackedProps.add(key);\n  }\n  getCurrentQuery() {\n    return this.#currentQuery;\n  }\n  refetch({ ...options } = {}) {\n    return this.fetch({\n      ...options\n    });\n  }\n  fetchOptimistic(options) {\n    const defaultedOptions = this.#client.defaultQueryOptions(options);\n    const query = this.#client.getQueryCache().build(this.#client, defaultedOptions);\n    return query.fetch().then(() => this.createResult(query, defaultedOptions));\n  }\n  fetch(fetchOptions) {\n    return this.#executeFetch({\n      ...fetchOptions,\n      cancelRefetch: fetchOptions.cancelRefetch ?? true\n    }).then(() => {\n      this.updateResult();\n      return this.#currentResult;\n    });\n  }\n  #executeFetch(fetchOptions) {\n    this.#updateQuery();\n    let promise = this.#currentQuery.fetch(\n      this.options,\n      fetchOptions\n    );\n    if (!fetchOptions?.throwOnError) {\n      promise = promise.catch(noop);\n    }\n    return promise;\n  }\n  #updateStaleTimeout() {\n    this.#clearStaleTimeout();\n    const staleTime = resolveStaleTime(\n      this.options.staleTime,\n      this.#currentQuery\n    );\n    if (isServer || this.#currentResult.isStale || !isValidTimeout(staleTime)) {\n      return;\n    }\n    const time = timeUntilStale(this.#currentResult.dataUpdatedAt, staleTime);\n    const timeout = time + 1;\n    this.#staleTimeoutId = timeoutManager.setTimeout(() => {\n      if (!this.#currentResult.isStale) {\n        this.updateResult();\n      }\n    }, timeout);\n  }\n  #computeRefetchInterval() {\n    return (typeof this.options.refetchInterval === \"function\" ? this.options.refetchInterval(this.#currentQuery) : this.options.refetchInterval) ?? false;\n  }\n  #updateRefetchInterval(nextInterval) {\n    this.#clearRefetchInterval();\n    this.#currentRefetchInterval = nextInterval;\n    if (isServer || resolveEnabled(this.options.enabled, this.#currentQuery) === false || !isValidTimeout(this.#currentRefetchInterval) || this.#currentRefetchInterval === 0) {\n      return;\n    }\n    this.#refetchIntervalId = timeoutManager.setInterval(() => {\n      if (this.options.refetchIntervalInBackground || focusManager.isFocused()) {\n        this.#executeFetch();\n      }\n    }, this.#currentRefetchInterval);\n  }\n  #updateTimers() {\n    this.#updateStaleTimeout();\n    this.#updateRefetchInterval(this.#computeRefetchInterval());\n  }\n  #clearStaleTimeout() {\n    if (this.#staleTimeoutId) {\n      timeoutManager.clearTimeout(this.#staleTimeoutId);\n      this.#staleTimeoutId = void 0;\n    }\n  }\n  #clearRefetchInterval() {\n    if (this.#refetchIntervalId) {\n      timeoutManager.clearInterval(this.#refetchIntervalId);\n      this.#refetchIntervalId = void 0;\n    }\n  }\n  createResult(query, options) {\n    const prevQuery = this.#currentQuery;\n    const prevOptions = this.options;\n    const prevResult = this.#currentResult;\n    const prevResultState = this.#currentResultState;\n    const prevResultOptions = this.#currentResultOptions;\n    const queryChange = query !== prevQuery;\n    const queryInitialState = queryChange ? query.state : this.#currentQueryInitialState;\n    const { state } = query;\n    let newState = { ...state };\n    let isPlaceholderData = false;\n    let data;\n    if (options._optimisticResults) {\n      const mounted = this.hasListeners();\n      const fetchOnMount = !mounted && shouldFetchOnMount(query, options);\n      const fetchOptionally = mounted && shouldFetchOptionally(query, prevQuery, options, prevOptions);\n      if (fetchOnMount || fetchOptionally) {\n        newState = {\n          ...newState,\n          ...fetchState(state.data, query.options)\n        };\n      }\n      if (options._optimisticResults === \"isRestoring\") {\n        newState.fetchStatus = \"idle\";\n      }\n    }\n    let { error, errorUpdatedAt, status } = newState;\n    data = newState.data;\n    let skipSelect = false;\n    if (options.placeholderData !== void 0 && data === void 0 && status === \"pending\") {\n      let placeholderData;\n      if (prevResult?.isPlaceholderData && options.placeholderData === prevResultOptions?.placeholderData) {\n        placeholderData = prevResult.data;\n        skipSelect = true;\n      } else {\n        placeholderData = typeof options.placeholderData === \"function\" ? options.placeholderData(\n          this.#lastQueryWithDefinedData?.state.data,\n          this.#lastQueryWithDefinedData\n        ) : options.placeholderData;\n      }\n      if (placeholderData !== void 0) {\n        status = \"success\";\n        data = replaceData(\n          prevResult?.data,\n          placeholderData,\n          options\n        );\n        isPlaceholderData = true;\n      }\n    }\n    if (options.select && data !== void 0 && !skipSelect) {\n      if (prevResult && data === prevResultState?.data && options.select === this.#selectFn) {\n        data = this.#selectResult;\n      } else {\n        try {\n          this.#selectFn = options.select;\n          data = options.select(data);\n          data = replaceData(prevResult?.data, data, options);\n          this.#selectResult = data;\n          this.#selectError = null;\n        } catch (selectError) {\n          this.#selectError = selectError;\n        }\n      }\n    }\n    if (this.#selectError) {\n      error = this.#selectError;\n      data = this.#selectResult;\n      errorUpdatedAt = Date.now();\n      status = \"error\";\n    }\n    const isFetching = newState.fetchStatus === \"fetching\";\n    const isPending = status === \"pending\";\n    const isError = status === \"error\";\n    const isLoading = isPending && isFetching;\n    const hasData = data !== void 0;\n    const result = {\n      status,\n      fetchStatus: newState.fetchStatus,\n      isPending,\n      isSuccess: status === \"success\",\n      isError,\n      isInitialLoading: isLoading,\n      isLoading,\n      data,\n      dataUpdatedAt: newState.dataUpdatedAt,\n      error,\n      errorUpdatedAt,\n      failureCount: newState.fetchFailureCount,\n      failureReason: newState.fetchFailureReason,\n      errorUpdateCount: newState.errorUpdateCount,\n      isFetched: newState.dataUpdateCount > 0 || newState.errorUpdateCount > 0,\n      isFetchedAfterMount: newState.dataUpdateCount > queryInitialState.dataUpdateCount || newState.errorUpdateCount > queryInitialState.errorUpdateCount,\n      isFetching,\n      isRefetching: isFetching && !isPending,\n      isLoadingError: isError && !hasData,\n      isPaused: newState.fetchStatus === \"paused\",\n      isPlaceholderData,\n      isRefetchError: isError && hasData,\n      isStale: isStale(query, options),\n      refetch: this.refetch,\n      promise: this.#currentThenable,\n      isEnabled: resolveEnabled(options.enabled, query) !== false\n    };\n    const nextResult = result;\n    if (this.options.experimental_prefetchInRender) {\n      const finalizeThenableIfPossible = (thenable) => {\n        if (nextResult.status === \"error\") {\n          thenable.reject(nextResult.error);\n        } else if (nextResult.data !== void 0) {\n          thenable.resolve(nextResult.data);\n        }\n      };\n      const recreateThenable = () => {\n        const pending = this.#currentThenable = nextResult.promise = pendingThenable();\n        finalizeThenableIfPossible(pending);\n      };\n      const prevThenable = this.#currentThenable;\n      switch (prevThenable.status) {\n        case \"pending\":\n          if (query.queryHash === prevQuery.queryHash) {\n            finalizeThenableIfPossible(prevThenable);\n          }\n          break;\n        case \"fulfilled\":\n          if (nextResult.status === \"error\" || nextResult.data !== prevThenable.value) {\n            recreateThenable();\n          }\n          break;\n        case \"rejected\":\n          if (nextResult.status !== \"error\" || nextResult.error !== prevThenable.reason) {\n            recreateThenable();\n          }\n          break;\n      }\n    }\n    return nextResult;\n  }\n  updateResult() {\n    const prevResult = this.#currentResult;\n    const nextResult = this.createResult(this.#currentQuery, this.options);\n    this.#currentResultState = this.#currentQuery.state;\n    this.#currentResultOptions = this.options;\n    if (this.#currentResultState.data !== void 0) {\n      this.#lastQueryWithDefinedData = this.#currentQuery;\n    }\n    if (shallowEqualObjects(nextResult, prevResult)) {\n      return;\n    }\n    this.#currentResult = nextResult;\n    const shouldNotifyListeners = () => {\n      if (!prevResult) {\n        return true;\n      }\n      const { notifyOnChangeProps } = this.options;\n      const notifyOnChangePropsValue = typeof notifyOnChangeProps === \"function\" ? notifyOnChangeProps() : notifyOnChangeProps;\n      if (notifyOnChangePropsValue === \"all\" || !notifyOnChangePropsValue && !this.#trackedProps.size) {\n        return true;\n      }\n      const includedProps = new Set(\n        notifyOnChangePropsValue ?? this.#trackedProps\n      );\n      if (this.options.throwOnError) {\n        includedProps.add(\"error\");\n      }\n      return Object.keys(this.#currentResult).some((key) => {\n        const typedKey = key;\n        const changed = this.#currentResult[typedKey] !== prevResult[typedKey];\n        return changed && includedProps.has(typedKey);\n      });\n    };\n    this.#notify({ listeners: shouldNotifyListeners() });\n  }\n  #updateQuery() {\n    const query = this.#client.getQueryCache().build(this.#client, this.options);\n    if (query === this.#currentQuery) {\n      return;\n    }\n    const prevQuery = this.#currentQuery;\n    this.#currentQuery = query;\n    this.#currentQueryInitialState = query.state;\n    if (this.hasListeners()) {\n      prevQuery?.removeObserver(this);\n      query.addObserver(this);\n    }\n  }\n  onQueryUpdate() {\n    this.updateResult();\n    if (this.hasListeners()) {\n      this.#updateTimers();\n    }\n  }\n  #notify(notifyOptions) {\n    notifyManager.batch(() => {\n      if (notifyOptions.listeners) {\n        this.listeners.forEach((listener) => {\n          listener(this.#currentResult);\n        });\n      }\n      this.#client.getQueryCache().notify({\n        query: this.#currentQuery,\n        type: \"observerResultsUpdated\"\n      });\n    });\n  }\n};\nfunction shouldLoadOnMount(query, options) {\n  return resolveEnabled(options.enabled, query) !== false && query.state.data === void 0 && !(query.state.status === \"error\" && options.retryOnMount === false);\n}\nfunction shouldFetchOnMount(query, options) {\n  return shouldLoadOnMount(query, options) || query.state.data !== void 0 && shouldFetchOn(query, options, options.refetchOnMount);\n}\nfunction shouldFetchOn(query, options, field) {\n  if (resolveEnabled(options.enabled, query) !== false && resolveStaleTime(options.staleTime, query) !== \"static\") {\n    const value = typeof field === \"function\" ? field(query) : field;\n    return value === \"always\" || value !== false && isStale(query, options);\n  }\n  return false;\n}\nfunction shouldFetchOptionally(query, prevQuery, options, prevOptions) {\n  return (query !== prevQuery || resolveEnabled(prevOptions.enabled, query) === false) && (!options.suspense || query.state.status !== \"error\") && isStale(query, options);\n}\nfunction isStale(query, options) {\n  return resolveEnabled(options.enabled, query) !== false && query.isStaleByTime(resolveStaleTime(options.staleTime, query));\n}\nfunction shouldAssignObserverCurrentProperties(observer, optimisticResult) {\n  if (!shallowEqualObjects(observer.getCurrentResult(), optimisticResult)) {\n    return true;\n  }\n  return false;\n}\nexport {\n  QueryObserver\n};\n//# sourceMappingURL=queryObserver.js.map","/**\n * Character Service\n * ==================\n * Firebase operations for character data\n */\n\nimport { \n  collection, \n  doc, \n  getDoc, \n  getDocs, \n  setDoc, \n  deleteDoc,\n  query,\n  orderBy,\n  Timestamp,\n  DocumentData,\n} from 'firebase/firestore';\nimport { db, auth } from '@/lib/firebase/client';\nimport type { Character, CharacterSummary } from '@/types';\n\n/**\n * Get the current user ID or throw an error.\n */\nfunction requireUserId(): string {\n  const userId = auth.currentUser?.uid;\n  if (!userId) {\n    throw new Error('User not authenticated');\n  }\n  return userId;\n}\n\n/**\n * Get the characters collection reference for the current user.\n */\nfunction getCharactersCollection(userId: string) {\n  return collection(db, 'users', userId, 'character');\n}\n\n/**\n * Remove undefined values from an object recursively.\n */\nfunction removeUndefined<T extends Record<string, unknown>>(obj: T): T {\n  if (Array.isArray(obj)) {\n    return obj.map(removeUndefined) as unknown as T;\n  } else if (obj && typeof obj === 'object') {\n    const clean: Record<string, unknown> = {};\n    for (const [k, v] of Object.entries(obj)) {\n      if (v !== undefined) {\n        clean[k] = typeof v === 'object' && v !== null \n          ? removeUndefined(v as Record<string, unknown>) \n          : v;\n      }\n    }\n    return clean as T;\n  }\n  return obj;\n}\n\n/**\n * Convert Firestore document to Character.\n */\nfunction docToCharacter(id: string, data: DocumentData): Character {\n  return {\n    id,\n    name: data.name || 'Unnamed',\n    level: data.level || 1,\n    abilities: data.abilities || {\n      strength: 0,\n      vitality: 0,\n      agility: 0,\n      acuity: 0,\n      intelligence: 0,\n      charisma: 0,\n    },\n    ...data,\n    createdAt: data.createdAt?.toDate?.() || data.createdAt,\n    updatedAt: data.updatedAt?.toDate?.() || data.updatedAt,\n  } as Character;\n}\n\n/**\n * Prepare character data for saving (update).\n */\nfunction prepareForSave(data: Partial<Character>): Record<string, unknown> {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const { id, createdAt, updatedAt, ...dataToSave } = data;\n\n  // Remove display-only properties\n  const cleaned = { ...dataToSave } as Record<string, unknown>;\n  delete cleaned._displayFeats;\n  delete cleaned.allTraits;\n  delete cleaned.defenses;\n  delete cleaned.defenseBonuses;\n\n  // Add timestamp\n  cleaned.updatedAt = Timestamp.now();\n\n  return removeUndefined(cleaned);\n}\n\n/**\n * Prepare character data for creation.\n */\nfunction prepareForCreate(data: Partial<Character>): Record<string, unknown> {\n  const cleaned = prepareForSave(data);\n  cleaned.createdAt = Timestamp.now();\n  return cleaned;\n}\n\n// =============================================================================\n// Character CRUD Operations\n// =============================================================================\n\n/**\n * Get all characters for the current user.\n */\nexport async function getCharacters(): Promise<CharacterSummary[]> {\n  const userId = requireUserId();\n  const charactersRef = getCharactersCollection(userId);\n  const q = query(charactersRef, orderBy('updatedAt', 'desc'));\n  \n  const snapshot = await getDocs(q);\n  \n  return snapshot.docs.map(doc => {\n    const data = doc.data();\n    return {\n      id: doc.id,\n      name: data.name || 'Unnamed',\n      level: data.level || 1,\n      portrait: data.portrait,\n      archetypeName: data.archetype?.name,\n      ancestryName: data.ancestry?.name,\n      status: data.status,\n      updatedAt: data.updatedAt?.toDate?.() || data.updatedAt,\n    };\n  });\n}\n\n/**\n * Get a single character by ID.\n */\nexport async function getCharacter(characterId: string): Promise<Character | null> {\n  const userId = requireUserId();\n  \n  if (!characterId?.trim()) {\n    throw new Error('Invalid character ID');\n  }\n  \n  const docRef = doc(db, 'users', userId, 'character', characterId.trim());\n  const docSnap = await getDoc(docRef);\n  \n  if (!docSnap.exists()) {\n    return null;\n  }\n  \n  return docToCharacter(docSnap.id, docSnap.data());\n}\n\n/**\n * Save a character (create or update).\n */\nexport async function saveCharacter(\n  characterId: string, \n  data: Partial<Character>\n): Promise<void> {\n  const userId = requireUserId();\n  \n  if (!characterId?.trim()) {\n    throw new Error('Invalid character ID');\n  }\n  \n  const cleanedData = prepareForSave(data);\n  const docRef = doc(db, 'users', userId, 'character', characterId.trim());\n  \n  await setDoc(docRef, cleanedData, { merge: true });\n}\n\n/**\n * Create a new character with auto-generated ID.\n */\nexport async function createCharacter(data: Partial<Character>): Promise<string> {\n  const userId = requireUserId();\n  const charactersRef = getCharactersCollection(userId);\n  const newDocRef = doc(charactersRef);\n  \n  const cleanedData = prepareForCreate(data);\n  \n  await setDoc(newDocRef, cleanedData);\n  \n  return newDocRef.id;\n}\n\n/**\n * Delete a character.\n */\nexport async function deleteCharacter(characterId: string): Promise<void> {\n  const userId = requireUserId();\n  \n  if (!characterId?.trim()) {\n    throw new Error('Invalid character ID');\n  }\n  \n  const docRef = doc(db, 'users', userId, 'character', characterId.trim());\n  await deleteDoc(docRef);\n}\n\n/**\n * Duplicate a character.\n */\nexport async function duplicateCharacter(characterId: string): Promise<string> {\n  const character = await getCharacter(characterId);\n  \n  if (!character) {\n    throw new Error('Character not found');\n  }\n  \n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const { id, createdAt, updatedAt, ...data } = character;\n  \n  return createCharacter({\n    ...data,\n    name: `${data.name} (Copy)`,\n  });\n}\n","/**\r\n * useCharacters Hook\r\n * ====================\r\n * React Query hooks for character data\r\n */\r\n\r\n'use client';\r\n\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\r\nimport {\r\n  getCharacters,\r\n  getCharacter,\r\n  saveCharacter,\r\n  createCharacter,\r\n  deleteCharacter,\r\n  duplicateCharacter,\r\n} from '@/services/character-service';\r\nimport type { Character, CharacterSummary } from '@/types';\r\n\r\n/** Query keys for character data */\r\nexport const characterKeys = {\r\n  all: ['characters'] as const,\r\n  lists: () => [...characterKeys.all, 'list'] as const,\r\n  list: () => [...characterKeys.lists()] as const,\r\n  details: () => [...characterKeys.all, 'detail'] as const,\r\n  detail: (id: string) => [...characterKeys.details(), id] as const,\r\n};\r\n\r\n/**\r\n * Get all characters for the current user.\r\n */\r\nexport function useCharacters() {\r\n  return useQuery({\r\n    queryKey: characterKeys.list(),\r\n    queryFn: getCharacters,\r\n  });\r\n}\r\n\r\n/**\r\n * Get a single character by ID.\r\n */\r\nexport function useCharacter(characterId: string | undefined) {\r\n  return useQuery({\r\n    queryKey: characterKeys.detail(characterId || ''),\r\n    queryFn: () => getCharacter(characterId || ''),\r\n    enabled: !!characterId,\r\n  });\r\n}\r\n\r\n/**\r\n * Save character mutation.\r\n */\r\nexport function useSaveCharacter() {\r\n  const queryClient = useQueryClient();\r\n  \r\n  return useMutation({\r\n    mutationFn: ({ id, data }: { id: string; data: Partial<Character> }) =>\r\n      saveCharacter(id, data),\r\n    onSuccess: (_, { id }) => {\r\n      queryClient.invalidateQueries({ queryKey: characterKeys.detail(id) });\r\n      queryClient.invalidateQueries({ queryKey: characterKeys.lists() });\r\n    },\r\n  });\r\n}\r\n\r\n/**\r\n * Create character mutation.\r\n */\r\nexport function useCreateCharacter() {\r\n  const queryClient = useQueryClient();\r\n  \r\n  return useMutation({\r\n    mutationFn: (data: Partial<Character>) => createCharacter(data),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: characterKeys.lists() });\r\n    },\r\n  });\r\n}\r\n\r\n/**\r\n * Delete character mutation.\r\n */\r\nexport function useDeleteCharacter() {\r\n  const queryClient = useQueryClient();\r\n  \r\n  return useMutation({\r\n    mutationFn: (id: string) => deleteCharacter(id),\r\n    onSuccess: (_, id) => {\r\n      queryClient.removeQueries({ queryKey: characterKeys.detail(id) });\r\n      queryClient.invalidateQueries({ queryKey: characterKeys.lists() });\r\n    },\r\n  });\r\n}\r\n\r\n/**\r\n * Duplicate character mutation.\r\n */\r\nexport function useDuplicateCharacter() {\r\n  const queryClient = useQueryClient();\r\n  \r\n  return useMutation({\r\n    mutationFn: (id: string) => duplicateCharacter(id),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: characterKeys.lists() });\r\n    },\r\n  });\r\n}\r\n","/**\n * Game Data Service\n * ==================\n * Firebase Realtime Database operations for game data\n * (archetypes, skills, feats, species, etc.)\n */\n\nimport { ref, get, child } from 'firebase/database';\nimport { rtdb } from '@/lib/firebase/client';\nimport type { Archetype, Skill, Feat, Ancestry } from '@/types';\n\n// Simple in-memory cache\nconst cache: Map<string, { data: unknown; timestamp: number }> = new Map();\nconst CACHE_TTL = 5 * 60 * 1000; // 5 minutes\n\n/**\n * Get cached data or fetch from RTDB.\n */\nasync function getCachedData<T>(path: string): Promise<T | null> {\n  const cached = cache.get(path);\n  \n  if (cached && Date.now() - cached.timestamp < CACHE_TTL) {\n    return cached.data as T;\n  }\n  \n  const snapshot = await get(child(ref(rtdb), path));\n  \n  if (!snapshot.exists()) {\n    return null;\n  }\n  \n  const data = snapshot.val();\n  cache.set(path, { data, timestamp: Date.now() });\n  \n  return data as T;\n}\n\n/**\n * Clear the cache for a specific path or all paths.\n */\nexport function clearCache(path?: string): void {\n  if (path) {\n    cache.delete(path);\n  } else {\n    cache.clear();\n  }\n}\n\n// =============================================================================\n// Archetypes\n// =============================================================================\n\n/**\n * Get all archetypes.\n */\nexport async function getArchetypes(): Promise<Archetype[]> {\n  const data = await getCachedData<Record<string, Archetype>>('archetypes');\n  \n  if (!data) return [];\n  \n  return Object.entries(data).map(([id, archetype]) => ({\n    ...archetype,\n    id,\n  }));\n}\n\n/**\n * Get a single archetype by ID.\n */\nexport async function getArchetype(id: string): Promise<Archetype | null> {\n  const data = await getCachedData<Archetype>(`archetypes/${id}`);\n  \n  if (!data) return null;\n  \n  return { ...data, id };\n}\n\n// =============================================================================\n// Skills\n// =============================================================================\n\n/**\n * Get all skills.\n */\nexport async function getSkills(): Promise<Skill[]> {\n  const data = await getCachedData<Record<string, Skill>>('skills');\n  \n  if (!data) return [];\n  \n  return Object.entries(data).map(([id, skill]) => ({\n    ...skill,\n    id,\n  }));\n}\n\n/**\n * Get a single skill by ID.\n */\nexport async function getSkill(id: string): Promise<Skill | null> {\n  const data = await getCachedData<Skill>(`skills/${id}`);\n  \n  if (!data) return null;\n  \n  return { ...data, id };\n}\n\n// =============================================================================\n// Feats\n// =============================================================================\n\n/**\n * Get all feats.\n */\nexport async function getFeats(): Promise<Feat[]> {\n  const data = await getCachedData<Record<string, Feat>>('feats');\n  \n  if (!data) return [];\n  \n  return Object.entries(data).map(([id, feat]) => ({\n    ...feat,\n    id,\n  }));\n}\n\n/**\n * Get a single feat by ID.\n */\nexport async function getFeat(id: string): Promise<Feat | null> {\n  const data = await getCachedData<Feat>(`feats/${id}`);\n  \n  if (!data) return null;\n  \n  return { ...data, id };\n}\n\n// =============================================================================\n// Ancestries / Species\n// =============================================================================\n\n/**\n * Get all ancestries/species.\n */\nexport async function getAncestries(): Promise<Ancestry[]> {\n  const data = await getCachedData<Record<string, Ancestry>>('species');\n  \n  if (!data) return [];\n  \n  return Object.entries(data).map(([id, ancestry]) => ({\n    ...ancestry,\n    id,\n  }));\n}\n\n/**\n * Get a single ancestry by ID.\n */\nexport async function getAncestry(id: string): Promise<Ancestry | null> {\n  const data = await getCachedData<Ancestry>(`species/${id}`);\n  \n  if (!data) return null;\n  \n  return { ...data, id };\n}\n\n// =============================================================================\n// Generic Data Fetching\n// =============================================================================\n\n/**\n * Get any data from RTDB by path.\n */\nexport async function getGameData<T>(path: string): Promise<T | null> {\n  return getCachedData<T>(path);\n}\n\n/**\n * Get data as an array with IDs.\n */\nexport async function getGameDataList<T extends { id?: string }>(\n  path: string\n): Promise<T[]> {\n  const data = await getCachedData<Record<string, T>>(path);\n  \n  if (!data) return [];\n  \n  return Object.entries(data).map(([id, item]) => ({\n    ...item,\n    id,\n  }));\n}\r\n","/**\r\n * useGameData Hook\r\n * ==================\r\n * React Query hooks for game data (archetypes, skills, feats, etc.)\r\n */\r\n\r\n'use client';\r\n\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport {\r\n  getArchetypes,\r\n  getArchetype,\r\n  getSkills,\r\n  getSkill,\r\n  getFeats,\r\n  getFeat,\r\n  getAncestries,\r\n  getAncestry,\r\n  getGameData,\r\n  getGameDataList,\r\n} from '@/services/game-data-service';\r\n\r\n/** Query keys for game data */\r\nexport const gameDataKeys = {\r\n  all: ['gameData'] as const,\r\n  archetypes: () => [...gameDataKeys.all, 'archetypes'] as const,\r\n  archetype: (id: string) => [...gameDataKeys.archetypes(), id] as const,\r\n  skills: () => [...gameDataKeys.all, 'skills'] as const,\r\n  skill: (id: string) => [...gameDataKeys.skills(), id] as const,\r\n  feats: () => [...gameDataKeys.all, 'feats'] as const,\r\n  feat: (id: string) => [...gameDataKeys.feats(), id] as const,\r\n  ancestries: () => [...gameDataKeys.all, 'ancestries'] as const,\r\n  ancestry: (id: string) => [...gameDataKeys.ancestries(), id] as const,\r\n  custom: (path: string) => [...gameDataKeys.all, 'custom', path] as const,\r\n};\r\n\r\n// =============================================================================\r\n// Archetypes\r\n// =============================================================================\r\n\r\nexport function useArchetypes() {\r\n  return useQuery({\r\n    queryKey: gameDataKeys.archetypes(),\r\n    queryFn: getArchetypes,\r\n    staleTime: 10 * 60 * 1000, // 10 minutes\r\n  });\r\n}\r\n\r\nexport function useArchetype(id: string | undefined) {\r\n  return useQuery({\r\n    queryKey: gameDataKeys.archetype(id || ''),\r\n    queryFn: () => getArchetype(id || ''),\r\n    enabled: !!id,\r\n    staleTime: 10 * 60 * 1000,\r\n  });\r\n}\r\n\r\n// =============================================================================\r\n// Skills\r\n// =============================================================================\r\n\r\nexport function useSkills() {\r\n  return useQuery({\r\n    queryKey: gameDataKeys.skills(),\r\n    queryFn: getSkills,\r\n    staleTime: 10 * 60 * 1000,\r\n  });\r\n}\r\n\r\nexport function useSkill(id: string | undefined) {\r\n  return useQuery({\r\n    queryKey: gameDataKeys.skill(id || ''),\r\n    queryFn: () => getSkill(id || ''),\r\n    enabled: !!id,\r\n    staleTime: 10 * 60 * 1000,\r\n  });\r\n}\r\n\r\n// =============================================================================\r\n// Feats\r\n// =============================================================================\r\n\r\nexport function useFeats() {\r\n  return useQuery({\r\n    queryKey: gameDataKeys.feats(),\r\n    queryFn: getFeats,\r\n    staleTime: 10 * 60 * 1000,\r\n  });\r\n}\r\n\r\nexport function useFeat(id: string | undefined) {\r\n  return useQuery({\r\n    queryKey: gameDataKeys.feat(id || ''),\r\n    queryFn: () => getFeat(id || ''),\r\n    enabled: !!id,\r\n    staleTime: 10 * 60 * 1000,\r\n  });\r\n}\r\n\r\n// =============================================================================\r\n// Ancestries\r\n// =============================================================================\r\n\r\nexport function useAncestries() {\r\n  return useQuery({\r\n    queryKey: gameDataKeys.ancestries(),\r\n    queryFn: getAncestries,\r\n    staleTime: 10 * 60 * 1000,\r\n  });\r\n}\r\n\r\nexport function useAncestry(id: string | undefined) {\r\n  return useQuery({\r\n    queryKey: gameDataKeys.ancestry(id || ''),\r\n    queryFn: () => getAncestry(id || ''),\r\n    enabled: !!id,\r\n    staleTime: 10 * 60 * 1000,\r\n  });\r\n}\r\n\r\n// =============================================================================\r\n// Generic Data\r\n// =============================================================================\r\n\r\nexport function useGameData<T>(path: string) {\r\n  return useQuery({\r\n    queryKey: gameDataKeys.custom(path),\r\n    queryFn: () => getGameData<T>(path),\r\n    staleTime: 10 * 60 * 1000,\r\n  });\r\n}\r\n\r\nexport function useGameDataList<T extends { id?: string }>(path: string) {\r\n  return useQuery({\r\n    queryKey: gameDataKeys.custom(path),\r\n    queryFn: () => getGameDataList<T>(path),\r\n    staleTime: 10 * 60 * 1000,\r\n  });\r\n}\r\n","/**\r\n * RTDB Hooks\r\n * ===========\r\n * React Query hooks for Firebase Realtime Database data fetching.\r\n * Provides caching, retry logic, and type-safe data access.\r\n */\r\n\r\n'use client';\r\n\r\nimport { useQuery, UseQueryResult } from '@tanstack/react-query';\r\nimport { ref, get } from 'firebase/database';\r\nimport { rtdb } from '@/lib/firebase/client';\r\n\r\n// =============================================================================\r\n// Types for RTDB Data\r\n// =============================================================================\r\n\r\nexport interface PowerPart {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  category: string;\r\n  base_en: number;\r\n  base_tp: number;\r\n  op_1_desc?: string;\r\n  op_1_en?: number;\r\n  op_1_tp?: number;\r\n  op_2_desc?: string;\r\n  op_2_en?: number;\r\n  op_2_tp?: number;\r\n  op_3_desc?: string;\r\n  op_3_en?: number;\r\n  op_3_tp?: number;\r\n  // Part type flags\r\n  duration?: boolean;\r\n  percentage?: boolean;\r\n  mechanic?: boolean;\r\n}\r\n\r\nexport interface TechniquePart {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  category: string;\r\n  base_tp: number;\r\n  base_stam: number;\r\n  base_en?: number;\r\n  op_1_desc?: string;\r\n  op_1_en?: number;\r\n  op_1_tp?: number;\r\n  op_2_desc?: string;\r\n  op_2_en?: number;\r\n  op_2_tp?: number;\r\n  op_3_desc?: string;\r\n  op_3_en?: number;\r\n  op_3_tp?: number;\r\n  percentage?: boolean;\r\n  mechanic?: boolean;\r\n}\r\n\r\n/** Combined Part type (for Codex Parts tab) */\r\nexport interface Part {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  category: string;\r\n  type: 'power' | 'technique';\r\n  base_en: number;\r\n  base_tp: number;\r\n  op_1_desc?: string;\r\n  op_1_en?: number;\r\n  op_1_tp?: number;\r\n  op_2_desc?: string;\r\n  op_2_en?: number;\r\n  op_2_tp?: number;\r\n  op_3_desc?: string;\r\n  op_3_en?: number;\r\n  op_3_tp?: number;\r\n  percentage?: boolean;\r\n  mechanic?: boolean;\r\n}\r\n\r\nexport interface ItemProperty {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  type?: 'weapon' | 'armor' | 'general';\r\n  // Legacy fields\r\n  tp_cost?: number;\r\n  gold_cost?: number;\r\n  // New standardized fields matching power/technique parts\r\n  base_ip?: number;\r\n  base_tp?: number;\r\n  base_c?: number;\r\n  op_1_desc?: string;\r\n  op_1_ip?: number;\r\n  op_1_tp?: number;\r\n  op_1_c?: number;\r\n}\r\n\r\nexport interface Feat {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  category: string;\r\n  ability?: string;\r\n  ability_req: string[];\r\n  abil_req_val: number[];\r\n  tags: string[];\r\n  skill_req: string[];\r\n  skill_req_val: number[];\r\n  lvl_req: number;\r\n  uses_per_rec: number;\r\n  mart_abil_req?: string;\r\n  char_feat: boolean;\r\n  state_feat: boolean;\r\n  prereq_text?: string;\r\n}\r\n\r\nexport interface Skill {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  ability: string;\r\n  category: string;\r\n  trained_only?: boolean;\r\n}\r\n\r\nexport interface Species {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  type: string; // Species type (Humanoid, Beast, etc.)\r\n  size: string; // Primary size\r\n  sizes: string[]; // All available sizes\r\n  speed: number;\r\n  traits: string[];\r\n  species_traits: string[];\r\n  ancestry_traits: string[];\r\n  flaws: string[];\r\n  characteristics: string[];\r\n  skills: string[];\r\n  languages: string[];\r\n  ability_bonuses?: Record<string, number>;\r\n  ave_height?: number;\r\n  ave_weight?: number;\r\n  adulthood_lifespan?: number[];\r\n}\r\n\r\nexport interface Trait {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  species?: string[];\r\n}\r\n\r\nexport interface EquipmentItem {\r\n  id: string;\r\n  name: string;\r\n  type: 'weapon' | 'armor' | 'equipment';\r\n  subtype?: string;\r\n  description: string;\r\n  damage?: string;\r\n  armor_value?: number;\r\n  gold_cost: number;\r\n  properties: string[];\r\n}\r\n\r\n// =============================================================================\r\n// Utility Functions\r\n// =============================================================================\r\n\r\nfunction toStrArray(val: unknown): string[] {\r\n  if (!val) return [];\r\n  if (Array.isArray(val)) return val.map(String);\r\n  if (typeof val === 'string') return val.split(',').map(s => s.trim()).filter(Boolean);\r\n  return [];\r\n}\r\n\r\nfunction toNumArray(val: unknown): number[] {\r\n  if (!val) return [];\r\n  if (Array.isArray(val)) return val.map(Number);\r\n  if (typeof val === 'number') return [val];\r\n  if (typeof val === 'string') return val.split(',').map(s => parseFloat(s.trim())).filter(n => !isNaN(n));\r\n  return [];\r\n}\r\n\r\nasync function fetchWithRetry<T>(\r\n  fetchFn: () => Promise<T>,\r\n  attempts = 3\r\n): Promise<T> {\r\n  let lastErr: Error | unknown;\r\n  \r\n  for (let i = 0; i < attempts; i++) {\r\n    try {\r\n      return await fetchFn();\r\n    } catch (err) {\r\n      lastErr = err;\r\n      const msg = (err as Error)?.message || '';\r\n      const isOffline = msg.includes('Client is offline') || \r\n                       msg.toLowerCase().includes('network');\r\n      \r\n      if (!isOffline || i === attempts - 1) throw err;\r\n      \r\n      // Exponential backoff\r\n      await new Promise(res => setTimeout(res, 500 * (i + 1)));\r\n    }\r\n  }\r\n  \r\n  throw lastErr;\r\n}\r\n\r\n// =============================================================================\r\n// Generic RTDB Fetch Function\r\n// =============================================================================\r\n\r\nasync function fetchRTDBData<T>(\r\n  path: string,\r\n  transform: (data: Record<string, unknown>) => T[]\r\n): Promise<T[]> {\r\n  if (!rtdb) {\r\n    console.warn('[rtdb-hooks] RTDB not initialized');\r\n    return [];\r\n  }\r\n  \r\n  const dbRef = ref(rtdb, path);\r\n  const snapshot = await fetchWithRetry(() => get(dbRef));\r\n  \r\n  if (!snapshot.exists()) {\r\n    console.warn(`[rtdb-hooks] No data found at path: ${path}`);\r\n    return [];\r\n  }\r\n  \r\n  const data = snapshot.val() as Record<string, unknown>;\r\n  return transform(data);\r\n}\r\n\r\n// =============================================================================\r\n// Data Fetching Functions\r\n// =============================================================================\r\n\r\nasync function fetchFeats(): Promise<Feat[]> {\r\n  return fetchRTDBData<Feat>('feats', (data) => \r\n    Object.entries(data).map(([id, f]) => {\r\n      const feat = f as Record<string, unknown>;\r\n      return {\r\n        id,\r\n        name: (feat.name as string) || '',\r\n        description: (feat.description as string) || '',\r\n        category: (feat.category as string) || '',\r\n        ability: feat.ability as string | undefined,\r\n        ability_req: toStrArray(feat.ability_req),\r\n        abil_req_val: toNumArray(feat.abil_req_val),\r\n        tags: toStrArray(feat.tags),\r\n        skill_req: toStrArray(feat.skill_req),\r\n        skill_req_val: toNumArray(feat.skill_req_val),\r\n        lvl_req: parseInt(feat.lvl_req as string) || 0,\r\n        uses_per_rec: parseInt(feat.uses_per_rec as string) || 0,\r\n        mart_abil_req: feat.mart_abil_req as string | undefined,\r\n        char_feat: Boolean(feat.char_feat),\r\n        state_feat: Boolean(feat.state_feat),\r\n      };\r\n    })\r\n  );\r\n}\r\n\r\nasync function fetchSkills(): Promise<Skill[]> {\r\n  return fetchRTDBData<Skill>('skills', (data) =>\r\n    Object.entries(data).map(([id, s]) => {\r\n      const skill = s as Record<string, unknown>;\r\n      return {\r\n        id,\r\n        name: (skill.name as string) || '',\r\n        description: (skill.description as string) || '',\r\n        ability: (skill.ability as string) || '',\r\n        category: (skill.category as string) || '',\r\n      };\r\n    })\r\n  );\r\n}\r\n\r\nasync function fetchSpecies(): Promise<Species[]> {\r\n  return fetchRTDBData<Species>('species', (data) =>\r\n    Object.entries(data).map(([id, s]) => {\r\n      const species = s as Record<string, unknown>;\r\n      \r\n      // Handle sizes - can be string (comma-separated) or array\r\n      let sizes: string[] = [];\r\n      if (typeof species.sizes === 'string') {\r\n        sizes = species.sizes.split(',').map((sz: string) => sz.trim());\r\n      } else if (Array.isArray(species.sizes)) {\r\n        sizes = species.sizes;\r\n      }\r\n      \r\n      // Get primary size for display\r\n      const primarySize = sizes[0] || 'Medium';\r\n      \r\n      return {\r\n        id,\r\n        name: (species.name as string) || '',\r\n        description: (species.description as string) || '',\r\n        type: (species.type as string) || '', // Species type (Humanoid, Beast, etc.)\r\n        size: primarySize, // Primary size for single-value compatibility\r\n        sizes: sizes, // All available sizes\r\n        speed: parseInt(species.speed as string) || 6,\r\n        traits: toStrArray(species.traits),\r\n        species_traits: toStrArray(species.species_traits),\r\n        ancestry_traits: toStrArray(species.ancestry_traits),\r\n        flaws: toStrArray(species.flaws),\r\n        characteristics: toStrArray(species.characteristics),\r\n        skills: toStrArray(species.skills),\r\n        languages: toStrArray(species.languages),\r\n        ability_bonuses: species.ability_bonuses as Record<string, number> | undefined,\r\n        ave_height: (species.ave_hgt_cm as number) || undefined,\r\n        ave_weight: (species.ave_wgt_kg as number) || undefined,\r\n        adulthood_lifespan: species.adulthood_lifespan as number[] | undefined,\r\n      };\r\n    })\r\n  );\r\n}\r\n\r\nasync function fetchTraits(): Promise<Trait[]> {\r\n  return fetchRTDBData<Trait>('traits', (data) =>\r\n    Object.entries(data).map(([id, t]) => {\r\n      const trait = t as Record<string, unknown>;\r\n      return {\r\n        id,\r\n        name: (trait.name as string) || '',\r\n        description: (trait.description as string) || '',\r\n        species: toStrArray(trait.species),\r\n      };\r\n    })\r\n  );\r\n}\r\n\r\nasync function fetchPowerParts(): Promise<PowerPart[]> {\r\n  return fetchRTDBData<PowerPart>('parts', (data) =>\r\n    Object.entries(data)\r\n      .filter(([, p]) => {\r\n        const part = p as Record<string, unknown>;\r\n        return (part.type as string)?.toLowerCase() === 'power';\r\n      })\r\n      .map(([id, p]) => {\r\n        const part = p as Record<string, unknown>;\r\n        return {\r\n          id,\r\n          name: (part.name as string) || '',\r\n          description: (part.description as string) || '',\r\n          category: (part.category as string) || '',\r\n          base_en: parseFloat(part.base_en as string) || 0,\r\n          base_tp: parseFloat(part.base_tp as string) || 0,\r\n          op_1_desc: part.op_1_desc as string | undefined,\r\n          op_1_en: parseFloat(part.op_1_en as string) || 0,\r\n          op_1_tp: parseFloat(part.op_1_tp as string) || 0,\r\n          op_2_desc: part.op_2_desc as string | undefined,\r\n          op_2_en: parseFloat(part.op_2_en as string) || 0,\r\n          op_2_tp: parseFloat(part.op_2_tp as string) || 0,\r\n        };\r\n      })\r\n  );\r\n}\r\n\r\nasync function fetchTechniqueParts(): Promise<TechniquePart[]> {\r\n  return fetchRTDBData<TechniquePart>('parts', (data) =>\r\n    Object.entries(data)\r\n      .filter(([, p]) => {\r\n        const part = p as Record<string, unknown>;\r\n        return (part.type as string)?.toLowerCase() === 'technique';\r\n      })\r\n      .map(([id, p]) => {\r\n        const part = p as Record<string, unknown>;\r\n        return {\r\n          id,\r\n          name: (part.name as string) || '',\r\n          description: (part.description as string) || '',\r\n          category: (part.category as string) || '',\r\n          base_tp: parseFloat(part.base_tp as string) || 0,\r\n          base_stam: parseFloat(part.base_stam as string) || 0,\r\n        };\r\n      })\r\n  );\r\n}\r\n\r\n/** Fetch ALL parts (both power and technique) for Codex Parts tab */\r\nasync function fetchParts(): Promise<Part[]> {\r\n  return fetchRTDBData<Part>('parts', (data) =>\r\n    Object.entries(data).map(([id, p]) => {\r\n      const part = p as Record<string, unknown>;\r\n      return {\r\n        id,\r\n        name: (part.name as string) || '',\r\n        description: (part.description as string) || '',\r\n        category: (part.category as string) || '',\r\n        type: ((part.type as string)?.toLowerCase() || 'power') as 'power' | 'technique',\r\n        base_en: parseFloat(part.base_en as string) || 0,\r\n        base_tp: parseFloat(part.base_tp as string) || 0,\r\n        op_1_desc: part.op_1_desc as string | undefined,\r\n        op_1_en: parseFloat(part.op_1_en as string) || 0,\r\n        op_1_tp: parseFloat(part.op_1_tp as string) || 0,\r\n        op_2_desc: part.op_2_desc as string | undefined,\r\n        op_2_en: parseFloat(part.op_2_en as string) || 0,\r\n        op_2_tp: parseFloat(part.op_2_tp as string) || 0,\r\n        op_3_desc: part.op_3_desc as string | undefined,\r\n        op_3_en: parseFloat(part.op_3_en as string) || 0,\r\n        op_3_tp: parseFloat(part.op_3_tp as string) || 0,\r\n        percentage: part.percentage === true || part.percentage === 'true',\r\n        mechanic: part.mechanic === true || part.mechanic === 'true',\r\n      };\r\n    })\r\n  );\r\n}\r\n\r\nasync function fetchItemProperties(): Promise<ItemProperty[]> {\r\n  return fetchRTDBData<ItemProperty>('properties', (data) =>\r\n    Object.entries(data).map(([id, p]) => {\r\n      const prop = p as Record<string, unknown>;\r\n      return {\r\n        id,\r\n        name: (prop.name as string) || '',\r\n        description: (prop.description as string) || '',\r\n        type: ((prop.type as string) || 'general') as 'weapon' | 'armor' | 'general',\r\n        tp_cost: parseFloat(prop.tp_cost as string) || 0,\r\n        gold_cost: parseFloat(prop.gold_cost as string) || 0,\r\n      };\r\n    })\r\n  );\r\n}\r\n\r\nasync function fetchEquipment(): Promise<EquipmentItem[]> {\r\n  return fetchRTDBData<EquipmentItem>('equipment', (data) =>\r\n    Object.entries(data).map(([id, e]) => {\r\n      const equip = e as Record<string, unknown>;\r\n      return {\r\n        id,\r\n        name: (equip.name as string) || '',\r\n        type: ((equip.type as string) || 'equipment') as 'weapon' | 'armor' | 'equipment',\r\n        subtype: equip.subtype as string | undefined,\r\n        description: (equip.description as string) || '',\r\n        damage: equip.damage as string | undefined,\r\n        armor_value: parseInt(equip.armor_value as string) || undefined,\r\n        gold_cost: parseFloat(equip.gold_cost as string) || 0,\r\n        properties: toStrArray(equip.properties),\r\n      };\r\n    })\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// React Query Hooks\r\n// =============================================================================\r\n\r\nconst DEFAULT_OPTIONS = {\r\n  staleTime: 5 * 60 * 1000, // 5 minutes\r\n  gcTime: 30 * 60 * 1000, // 30 minutes (formerly cacheTime)\r\n  retry: 2,\r\n  refetchOnWindowFocus: false,\r\n};\r\n\r\nexport function useFeats(): UseQueryResult<Feat[], Error> {\r\n  return useQuery({\r\n    queryKey: ['feats'],\r\n    queryFn: fetchFeats,\r\n    ...DEFAULT_OPTIONS,\r\n  });\r\n}\r\n\r\nexport function useSkills(): UseQueryResult<Skill[], Error> {\r\n  return useQuery({\r\n    queryKey: ['skills'],\r\n    queryFn: fetchSkills,\r\n    ...DEFAULT_OPTIONS,\r\n  });\r\n}\r\n\r\nexport function useSpecies(): UseQueryResult<Species[], Error> {\r\n  return useQuery({\r\n    queryKey: ['species'],\r\n    queryFn: fetchSpecies,\r\n    ...DEFAULT_OPTIONS,\r\n  });\r\n}\r\n\r\nexport function useTraits(): UseQueryResult<Trait[], Error> {\r\n  return useQuery({\r\n    queryKey: ['traits'],\r\n    queryFn: fetchTraits,\r\n    ...DEFAULT_OPTIONS,\r\n  });\r\n}\r\n\r\nexport function usePowerParts(): UseQueryResult<PowerPart[], Error> {\r\n  return useQuery({\r\n    queryKey: ['power-parts'],\r\n    queryFn: fetchPowerParts,\r\n    ...DEFAULT_OPTIONS,\r\n  });\r\n}\r\n\r\nexport function useTechniqueParts(): UseQueryResult<TechniquePart[], Error> {\r\n  return useQuery({\r\n    queryKey: ['technique-parts'],\r\n    queryFn: fetchTechniqueParts,\r\n    ...DEFAULT_OPTIONS,\r\n  });\r\n}\r\n\r\nexport function useParts(): UseQueryResult<Part[], Error> {\r\n  return useQuery({\r\n    queryKey: ['all-parts'],\r\n    queryFn: fetchParts,\r\n    ...DEFAULT_OPTIONS,\r\n  });\r\n}\r\n\r\nexport function useItemProperties(): UseQueryResult<ItemProperty[], Error> {\r\n  return useQuery({\r\n    queryKey: ['item-properties'],\r\n    queryFn: fetchItemProperties,\r\n    ...DEFAULT_OPTIONS,\r\n  });\r\n}\r\n\r\nexport function useEquipment(): UseQueryResult<EquipmentItem[], Error> {\r\n  return useQuery({\r\n    queryKey: ['equipment'],\r\n    queryFn: fetchEquipment,\r\n    ...DEFAULT_OPTIONS,\r\n  });\r\n}\r\n\r\n// =============================================================================\r\n// Prefetch Functions (for SSR or preloading)\r\n// =============================================================================\r\n\r\nexport const prefetchFunctions = {\r\n  feats: fetchFeats,\r\n  skills: fetchSkills,\r\n  species: fetchSpecies,\r\n  traits: fetchTraits,\r\n  powerParts: fetchPowerParts,\r\n  techniqueParts: fetchTechniqueParts,\r\n  parts: fetchParts,\r\n  itemProperties: fetchItemProperties,\r\n  equipment: fetchEquipment,\r\n};\r\n","/**\r\n * useAutoSave Hook\r\n * ================\r\n * Provides debounced auto-save functionality for forms.\r\n * Tracks changes and saves after a delay to reduce server calls.\r\n */\r\n\r\nimport { useState, useEffect, useCallback, useRef } from 'react';\r\n\r\ninterface AutoSaveOptions<T> {\r\n  /** Data to watch for changes */\r\n  data: T;\r\n  /** Function to call when saving */\r\n  onSave: (data: T) => Promise<void>;\r\n  /** Debounce delay in milliseconds (default: 2000) */\r\n  delay?: number;\r\n  /** Whether auto-save is enabled (default: true) */\r\n  enabled?: boolean;\r\n  /** Callback when save starts */\r\n  onSaveStart?: () => void;\r\n  /** Callback when save completes */\r\n  onSaveComplete?: () => void;\r\n  /** Callback when save fails */\r\n  onSaveError?: (error: Error) => void;\r\n}\r\n\r\ninterface AutoSaveResult {\r\n  /** Whether there are unsaved changes */\r\n  hasUnsavedChanges: boolean;\r\n  /** Whether currently saving */\r\n  isSaving: boolean;\r\n  /** Last save timestamp */\r\n  lastSaved: Date | null;\r\n  /** Force an immediate save */\r\n  saveNow: () => Promise<void>;\r\n  /** Mark as saved without calling onSave */\r\n  markSaved: () => void;\r\n  /** Reset dirty state */\r\n  reset: () => void;\r\n}\r\n\r\nexport function useAutoSave<T>({\r\n  data,\r\n  onSave,\r\n  delay = 2000,\r\n  enabled = true,\r\n  onSaveStart,\r\n  onSaveComplete,\r\n  onSaveError,\r\n}: AutoSaveOptions<T>): AutoSaveResult {\r\n  const [hasUnsavedChanges, setHasUnsavedChanges] = useState(false);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [lastSaved, setLastSaved] = useState<Date | null>(null);\r\n  \r\n  // Track initial data to compare changes\r\n  const initialDataRef = useRef<T>(data);\r\n  const currentDataRef = useRef<T>(data);\r\n  const timeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\r\n  const saveInProgressRef = useRef(false);\r\n\r\n  // Update current data ref\r\n  useEffect(() => {\r\n    currentDataRef.current = data;\r\n  }, [data]);\r\n\r\n  // Perform the actual save\r\n  const performSave = useCallback(async (dataToSave: T) => {\r\n    if (saveInProgressRef.current) return;\r\n    \r\n    saveInProgressRef.current = true;\r\n    setIsSaving(true);\r\n    onSaveStart?.();\r\n\r\n    try {\r\n      await onSave(dataToSave);\r\n      setHasUnsavedChanges(false);\r\n      setLastSaved(new Date());\r\n      initialDataRef.current = dataToSave;\r\n      onSaveComplete?.();\r\n    } catch (err) {\r\n      onSaveError?.(err instanceof Error ? err : new Error('Save failed'));\r\n    } finally {\r\n      setIsSaving(false);\r\n      saveInProgressRef.current = false;\r\n    }\r\n  }, [onSave, onSaveStart, onSaveComplete, onSaveError]);\r\n\r\n  // Debounced save effect\r\n  useEffect(() => {\r\n    if (!enabled) return;\r\n\r\n    // Compare current data with initial data\r\n    const hasChanges = JSON.stringify(data) !== JSON.stringify(initialDataRef.current);\r\n    \r\n    if (hasChanges) {\r\n      setHasUnsavedChanges(true);\r\n      \r\n      // Clear existing timeout\r\n      if (timeoutRef.current) {\r\n        clearTimeout(timeoutRef.current);\r\n      }\r\n      \r\n      // Set new timeout for auto-save\r\n      timeoutRef.current = setTimeout(() => {\r\n        performSave(data);\r\n      }, delay);\r\n    }\r\n\r\n    return () => {\r\n      if (timeoutRef.current) {\r\n        clearTimeout(timeoutRef.current);\r\n      }\r\n    };\r\n  }, [data, delay, enabled, performSave]);\r\n\r\n  // Save immediately\r\n  const saveNow = useCallback(async () => {\r\n    if (timeoutRef.current) {\r\n      clearTimeout(timeoutRef.current);\r\n    }\r\n    await performSave(currentDataRef.current);\r\n  }, [performSave]);\r\n\r\n  // Mark as saved without calling onSave\r\n  const markSaved = useCallback(() => {\r\n    setHasUnsavedChanges(false);\r\n    setLastSaved(new Date());\r\n    initialDataRef.current = currentDataRef.current;\r\n  }, []);\r\n\r\n  // Reset dirty state\r\n  const reset = useCallback(() => {\r\n    setHasUnsavedChanges(false);\r\n    if (timeoutRef.current) {\r\n      clearTimeout(timeoutRef.current);\r\n    }\r\n    initialDataRef.current = currentDataRef.current;\r\n  }, []);\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (timeoutRef.current) {\r\n        clearTimeout(timeoutRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // Save on page unload if there are unsaved changes\r\n  useEffect(() => {\r\n    const handleBeforeUnload = (e: BeforeUnloadEvent) => {\r\n      if (hasUnsavedChanges) {\r\n        e.preventDefault();\r\n        return '';\r\n      }\r\n    };\r\n\r\n    window.addEventListener('beforeunload', handleBeforeUnload);\r\n    return () => window.removeEventListener('beforeunload', handleBeforeUnload);\r\n  }, [hasUnsavedChanges]);\r\n\r\n  return {\r\n    hasUnsavedChanges,\r\n    isSaving,\r\n    lastSaved,\r\n    saveNow,\r\n    markSaved,\r\n    reset,\r\n  };\r\n}\r\n"],"names":[],"mappings":"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","ignoreList":[2,3,4,5,6,7,8,9,10]}