{"version":3,"sources":["../../../../src/lib/game/constants.ts","../../../../src/lib/game/formulas.ts"],"sourcesContent":["/**\n * Game Constants\n * ===============\n * Centralized game constants for RealmsRPG\n * Ported from public/js/shared/game-formulas.js\n */\n\nimport type { ArchetypeCategory, ArchetypeConfig } from '@/types';\n\n/** Shared constants for characters and creatures */\nexport const SHARED_CONSTANTS = {\n  BASE_ABILITY_POINTS: 7,\n  ABILITY_POINTS_PER_3_LEVELS: 1,\n  BASE_SKILL_POINTS: 2,\n  SKILL_POINTS_PER_LEVEL: 3,\n  BASE_PROFICIENCY: 2,\n  PROFICIENCY_PER_5_LEVELS: 1,\n  HIT_ENERGY_PER_LEVEL: 12,\n} as const;\n\n/** Player character specific constants */\nexport const PLAYER_CONSTANTS = {\n  BASE_HIT_ENERGY: 18,\n  BASE_TRAINING_POINTS: 22,\n  TP_PER_LEVEL_MULTIPLIER: 2,\n} as const;\n\n/** Creature/NPC specific constants */\nexport const CREATURE_CONSTANTS = {\n  BASE_HIT_ENERGY: 26,\n  BASE_TRAINING_POINTS: 9,\n  TP_PER_LEVEL: 1,\n  BASE_FEAT_POINTS: 4,\n  FEAT_POINTS_PER_LEVEL: 1,\n  BASE_CURRENCY: 200,\n  CURRENCY_GROWTH: 1.45,\n} as const;\n\n/** Ability score limits */\nexport const ABILITY_LIMITS = {\n  MIN: -2,\n  MAX_STARTING: 3,\n  MAX_ABSOLUTE: 6,\n  COST_INCREASE_THRESHOLD: 4,\n} as const;\n\n/** Skill limits */\nexport const SKILL_LIMITS = {\n  MAX_PER_SKILL: 3,\n  DEFENSE_MAX: 3,\n} as const;\n\n/** Archetype configurations */\nexport const ARCHETYPE_CONFIGS: Record<ArchetypeCategory, ArchetypeConfig> = {\n  power: {\n    featLimit: 1,\n    armamentMax: 4,\n    innateEnergy: 8,\n    proficiency: { martial: 0, power: 2 },\n    trainingPointBonus: 0,\n  },\n  'powered-martial': {\n    featLimit: 2,\n    armamentMax: 8,\n    innateEnergy: 6,\n    proficiency: { martial: 1, power: 1 },\n    trainingPointBonus: 0,\n  },\n  martial: {\n    featLimit: 3,\n    armamentMax: 16,\n    innateEnergy: 0,\n    proficiency: { martial: 2, power: 0 },\n    trainingPointBonus: 0,\n  },\n} as const;\n\n/** All game constants grouped */\nexport const GAME_CONSTANTS = {\n  SHARED: SHARED_CONSTANTS,\n  PLAYER: PLAYER_CONSTANTS,\n  CREATURE: CREATURE_CONSTANTS,\n  ABILITY: ABILITY_LIMITS,\n  SKILL: SKILL_LIMITS,\n  ARCHETYPE: ARCHETYPE_CONFIGS,\n} as const;\n\n/** Default combat values */\nexport const COMBAT_DEFAULTS = {\n  BASE_SPEED: 6,\n  BASE_EVASION: 10,\n  BASE_DEFENSE: 10,\n} as const;\r\n","/**\n * Game Formulas\n * ==============\n * Centralized game calculation formulas for RealmsRPG\n * Ported from public/js/shared/game-formulas.js\n */\n\nimport type { EntityType, Abilities, Defenses, DefenseBonuses, ArchetypeCategory, Character } from '@/types';\nimport { \n  SHARED_CONSTANTS, \n  PLAYER_CONSTANTS, \n  CREATURE_CONSTANTS, \n  ABILITY_LIMITS,\n  ARCHETYPE_CONFIGS,\n  COMBAT_DEFAULTS,\n} from './constants';\n\n// =============================================================================\n// Level Progression Calculations\n// =============================================================================\n\n/**\n * Calculate ability points based on level.\n * Formula: 7 at level 1, +1 every 3 levels starting at level 3\n */\nexport function calculateAbilityPoints(level: number, allowSubLevel = false): number {\n  const parsedLevel = parseFloat(String(level)) || 1;\n  \n  if (allowSubLevel && parsedLevel < 1) {\n    return Math.ceil(SHARED_CONSTANTS.BASE_ABILITY_POINTS * parsedLevel);\n  }\n  \n  if (parsedLevel < 1) return 0;\n  if (parsedLevel < 3) return SHARED_CONSTANTS.BASE_ABILITY_POINTS;\n  \n  const bonusPoints = Math.floor((parsedLevel - 1) / 3) * SHARED_CONSTANTS.ABILITY_POINTS_PER_3_LEVELS;\n  return SHARED_CONSTANTS.BASE_ABILITY_POINTS + bonusPoints;\n}\n\n/**\n * Calculate skill points based on level.\n * Formula: 2 + level * 3\n */\nexport function calculateSkillPoints(level: number, allowSubLevel = false): number {\n  const parsedLevel = parseFloat(String(level)) || 1;\n  \n  if (allowSubLevel && parsedLevel < 1) {\n    return Math.ceil(5 * parsedLevel);\n  }\n  \n  return SHARED_CONSTANTS.BASE_SKILL_POINTS + \n         (SHARED_CONSTANTS.SKILL_POINTS_PER_LEVEL * Math.floor(parsedLevel));\n}\n\n/**\n * Calculate health-energy pool based on level.\n */\nexport function calculateHealthEnergyPool(\n  level: number, \n  entityType: EntityType = 'PLAYER', \n  allowSubLevel = false\n): number {\n  const parsedLevel = parseFloat(String(level)) || 1;\n  const config = entityType === 'CREATURE' ? CREATURE_CONSTANTS : PLAYER_CONSTANTS;\n  \n  if (allowSubLevel && parsedLevel < 1) {\n    return Math.ceil(config.BASE_HIT_ENERGY * parsedLevel);\n  }\n  \n  return config.BASE_HIT_ENERGY + (SHARED_CONSTANTS.HIT_ENERGY_PER_LEVEL * (parsedLevel - 1));\n}\n\n/**\n * Calculate proficiency points based on level.\n * Formula: 2 + 1 every 5 levels starting at level 5\n */\nexport function calculateProficiency(level: number, allowSubLevel = false): number {\n  const parsedLevel = parseFloat(String(level)) || 1;\n  \n  if (allowSubLevel && parsedLevel < 1) {\n    return Math.ceil(SHARED_CONSTANTS.BASE_PROFICIENCY * parsedLevel);\n  }\n  \n  if (parsedLevel < 1) return 0;\n  if (parsedLevel < 5) return SHARED_CONSTANTS.BASE_PROFICIENCY;\n  \n  const bonusPoints = Math.floor(parsedLevel / 5) * SHARED_CONSTANTS.PROFICIENCY_PER_5_LEVELS;\n  return SHARED_CONSTANTS.BASE_PROFICIENCY + bonusPoints;\n}\n\n/**\n * Calculate training points for a player character.\n * Formula: 22 + ability + ((2 + ability) * (level - 1))\n */\nexport function calculateTrainingPoints(level: number, highestArchetypeAbility = 0): number {\n  const ability = highestArchetypeAbility || 0;\n  const base = PLAYER_CONSTANTS.BASE_TRAINING_POINTS;\n  const perLevel = PLAYER_CONSTANTS.TP_PER_LEVEL_MULTIPLIER + ability;\n  \n  return base + ability + (perLevel * (level - 1));\n}\n\n/**\n * Calculate training points for a creature.\n * Formula: 9 + ability + (level - 1) * (1 + ability)\n */\nexport function calculateCreatureTrainingPoints(level: number, highestNonVitality = 0): number {\n  const parsedLevel = parseFloat(String(level)) || 1;\n  const ability = highestNonVitality || 0;\n  \n  if (parsedLevel < 1) {\n    return Math.ceil(22 * parsedLevel) + ability;\n  }\n  \n  const base = CREATURE_CONSTANTS.BASE_TRAINING_POINTS;\n  const perLevel = CREATURE_CONSTANTS.TP_PER_LEVEL + ability;\n  \n  if (parsedLevel <= 1) return base + ability;\n  return base + ability + ((parsedLevel - 1) * perLevel);\n}\n\n/**\n * Calculate creature currency based on level.\n * Formula: 200 * 1.45^(level-1)\n */\nexport function calculateCreatureCurrency(level: number): number {\n  const parsedLevel = parseFloat(String(level)) || 1;\n  return Math.round(\n    CREATURE_CONSTANTS.BASE_CURRENCY * \n    Math.pow(CREATURE_CONSTANTS.CURRENCY_GROWTH, parsedLevel - 1)\n  );\n}\n\n/**\n * Calculate maximum archetype feats allowed based on level.\n */\nexport function calculateMaxArchetypeFeats(level: number): number {\n  return Math.max(0, Math.floor(level));\n}\n\n/**\n * Calculate maximum character feats allowed based on level.\n */\nexport function calculateMaxCharacterFeats(level: number): number {\n  return Math.max(0, Math.floor(level));\n}\n\n// =============================================================================\n// Ability Score Helpers\n// =============================================================================\n\n/**\n * Get the cost to increase an ability score.\n */\nexport function getAbilityIncreaseCost(currentValue: number): number {\n  if (currentValue >= ABILITY_LIMITS.COST_INCREASE_THRESHOLD) {\n    return 2;\n  }\n  return 1;\n}\n\n/**\n * Check if an ability increase is valid.\n */\nexport function canIncreaseAbility(\n  currentValue: number, \n  availablePoints: number, \n  isCreation = true\n): boolean {\n  const max = isCreation ? ABILITY_LIMITS.MAX_STARTING : ABILITY_LIMITS.MAX_ABSOLUTE;\n  if (currentValue >= max) return false;\n  \n  const cost = getAbilityIncreaseCost(currentValue);\n  return availablePoints >= cost;\n}\n\n/**\n * Check if an ability decrease is valid.\n */\nexport function canDecreaseAbility(currentValue: number): boolean {\n  return currentValue > ABILITY_LIMITS.MIN;\n}\n\n// =============================================================================\n// Archetype Helpers\n// =============================================================================\n\n/**\n * Get archetype configuration.\n */\nexport function getArchetypeConfig(archetypeType: ArchetypeCategory | string) {\n  return ARCHETYPE_CONFIGS[archetypeType as ArchetypeCategory] || ARCHETYPE_CONFIGS.power;\n}\n\n/**\n * Get the maximum armament value for an archetype.\n */\nexport function getArmamentMax(archetype: ArchetypeCategory | { type?: ArchetypeCategory }): number {\n  const type = typeof archetype === 'string' ? archetype : archetype?.type;\n  return getArchetypeConfig(type || 'power').armamentMax;\n}\n\n/**\n * Get the archetype feat limit.\n */\nexport function getArchetypeFeatLimit(archetype: ArchetypeCategory | { type?: ArchetypeCategory }): number {\n  const type = typeof archetype === 'string' ? archetype : archetype?.type;\n  return getArchetypeConfig(type || 'power').featLimit;\n}\n\n/**\n * Get the maximum innate energy for an archetype.\n */\nexport function getInnateEnergyMax(archetype: ArchetypeCategory | { type?: ArchetypeCategory }): number {\n  const type = typeof archetype === 'string' ? archetype : archetype?.type;\n  return getArchetypeConfig(type || 'power').innateEnergy;\n}\r\n"],"names":[],"mappings":"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"}