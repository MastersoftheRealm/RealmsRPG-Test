module.exports=[39721,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(33508),e=a.i(15618),f=a.i(5784),g=a.i(67552),h=a.i(3314),i=a.i(58120),j=a.i(50429),k=a.i(97063);let l=(0,a.i(60137).default)("coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);var m=a.i(96101);a.i(72500);var n=a.i(18239);a.i(76564);var o=a.i(20930);a.i(50889);var p=a.i(20747),q=a.i(97907),r=a.i(31903),s=a.i(85693);a.i(89606);var t=a.i(66206),u=a.i(77967);a.i(9912);var v=a.i(94318);a.i(39249);var w=a.i(55072);let x=[{value:"Weapon",label:"Weapon",icon:i.Sword},{value:"Armor",label:"Armor",icon:h.Shield},{value:"Shield",label:"Shield",icon:h.Shield},{value:"Accessory",label:"Accessory",icon:j.Target}],y=["none","slashing","piercing","bludgeoning","fire","cold","lightning","acid","poison","necrotic","radiant","psychic"],z=[4,6,8,10,12],A={Common:"text-gray-600 bg-gray-100",Uncommon:"text-green-600 bg-green-100",Rare:"text-blue-600 bg-blue-100",Epic:"text-purple-600 bg-purple-100",Legendary:"text-amber-600 bg-amber-100",Mythic:"text-red-600 bg-red-100",Ascended:"text-pink-600 bg-pink-100"};function B({selectedProperty:a,onRemove:e,onUpdate:h,allProperties:i}){let[j,k]=(0,c.useState)(!0),{property:l}=a,m=(0,c.useMemo)(()=>i.filter(a=>!(0,w.isGeneralProperty)(a)).sort((a,b)=>a.name.localeCompare(b.name)),[i]),n=(l.base_tp||l.tp_cost||0)+(l.op_1_tp||0)*a.op_1_lvl,o=l.op_1_desc&&""!==l.op_1_desc.trim();return(0,b.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden",children:[(0,b.jsxs)("div",{className:"bg-gray-50 px-4 py-3 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>k(!j),className:"text-gray-500 hover:text-gray-700",children:j?(0,b.jsx)(g.ChevronUp,{className:"w-5 h-5"}):(0,b.jsx)(f.ChevronDown,{className:"w-5 h-5"})}),(0,b.jsx)("span",{className:"font-medium text-gray-900",children:l.name}),n>0&&(0,b.jsxs)("span",{className:"text-sm text-purple-600 font-medium",children:["TP: ",n]})]}),(0,b.jsx)("button",{type:"button",onClick:e,className:"text-gray-400 hover:text-red-500",children:(0,b.jsx)(d.X,{className:"w-5 h-5"})})]}),j&&(0,b.jsxs)("div",{className:"px-4 py-4 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Property"}),(0,b.jsx)("select",{value:m.findIndex(a=>a.id===l.id),onChange:a=>{let b=m[parseInt(a.target.value)];b&&h({property:b,op_1_lvl:0})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm",children:m.map((a,c)=>(0,b.jsx)("option",{value:c,children:a.name},a.id))})]}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:l.description}),o&&(0,b.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("span",{className:"text-sm font-medium",children:["Option:"," ",l.op_1_tp&&(0,b.jsxs)("span",{className:"text-gray-500",children:["TP +",l.op_1_tp,"/level"]})]}),(0,b.jsx)(s.NumberStepper,{value:a.op_1_lvl,onChange:a=>h({op_1_lvl:a}),label:"Level:",variant:"item"})]}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:l.op_1_desc})]})]})]})}function C(){let{user:a}=(0,t.useAuthStore)(),[d,f]=(0,c.useState)(""),[g,h]=(0,c.useState)(""),[o,C]=(0,c.useState)("Weapon"),[D,E]=(0,c.useState)([]),[F,G]=(0,c.useState)({amount:1,size:6,type:"slashing"}),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(null),[L,M]=(0,c.useState)(!1),[N,O]=(0,c.useState)(!1),[P,Q]=(0,c.useState)(0),{data:R=[],isLoading:S,error:T}=(0,p.useItemProperties)(),{data:U=[],isLoading:V,error:W}=(0,q.useUserItems)(),X=(0,c.useMemo)(()=>0===P?"Melee":`${8*P} spaces`,[P]),Y=(0,c.useMemo)(()=>{let a=D.map(a=>({id:Number(a.property.id),name:a.property.name,op_1_lvl:a.op_1_lvl}));if("Weapon"===o&&N){let b=R.find(a=>"Two-Handed"===a.name);b&&a.push({id:Number(b.id),name:"Two-Handed",op_1_lvl:0})}if("Weapon"===o&&P>0){let b=R.find(a=>"Range"===a.name);b&&a.push({id:Number(b.id),name:"Range",op_1_lvl:P-1})}return a},[D,o,N,P,R]),Z=(0,c.useMemo)(()=>(0,w.calculateItemCosts)(Y,R),[Y,R]),{currencyCost:$,rarity:_}=(0,c.useMemo)(()=>(0,w.calculateCurrencyCostAndRarity)(Z.totalCurrency,Z.totalIP),[Z.totalCurrency,Z.totalIP]),aa=(0,c.useMemo)(()=>"Weapon"!==o||"none"===F.type||F.amount<1?"":`${F.amount}d${F.size} ${F.type}`,[o,F]),ab=(0,c.useCallback)(()=>{let a=R.filter(a=>!(0,w.isGeneralProperty)(a));if(0===a.length)return;let b=a.find(a=>!D.some(b=>b.property.id===a.id))||a[0];E(a=>[...a,{property:b,op_1_lvl:0}])},[R,D]),ac=(0,c.useCallback)(a=>{E(b=>b.filter((b,c)=>c!==a))},[]),ad=(0,c.useCallback)((a,b)=>{E(c=>c.map((c,d)=>d===a?{...c,...b}:c))},[]),ae=async()=>{if(!d.trim())return void K({type:"error",text:"Please enter an item name"});if(!a)return void K({type:"error",text:"You must be logged in to save"});I(!0),K(null);try{let a=(0,v.httpsCallable)(u.functions,"saveItemToLibrary"),b=D.map(a=>({id:Number(a.property.id),name:a.property.name,op_1_lvl:a.op_1_lvl})),c="Weapon"===o&&"none"!==F.type&&F.amount>0?[{amount:F.amount,size:F.size,type:F.type}]:[];await a({itemName:d.trim(),itemDescription:g.trim(),armamentType:o,properties:b,damage:c}),K({type:"success",text:"Item saved successfully!"}),setTimeout(()=>{f(""),h(""),E([]),G({amount:1,size:6,type:"slashing"}),K(null)},2e3)}catch(a){console.error("Error saving item:",a),K({type:"error",text:`Failed to save: ${a.message}`})}finally{I(!1)}},af=(0,c.useCallback)(a=>{if(f(a.name||""),h(a.description||""),C({weapon:"Weapon",armor:"Armor",shield:"Shield",accessory:"Accessory"}[a.type?.toLowerCase()]||"Weapon"),a.properties&&Array.isArray(a.properties)&&R.length>0){let b=[];for(let c of a.properties){let a=R.find(a=>a.id===String(c.id)||a.name===c.name);a&&b.push({property:a,op_1_lvl:c.op_1_lvl||0})}E(b)}else E([]);if(a.damage&&Array.isArray(a.damage)&&a.damage.length>0){let b=a.damage[0];G({amount:b.amount||1,size:b.size||6,type:b.type||"slashing"})}else G({amount:1,size:6,type:"slashing"});M(!1)},[R]);return S?(0,b.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,b.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,b.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),(0,b.jsx)("div",{className:"h-4 bg-gray-200 rounded w-2/3"}),(0,b.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})}):T?(0,b.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,b.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 text-center",children:(0,b.jsxs)("p",{className:"text-red-700",children:["Failed to load item properties: ",T.message]})})}):(0,b.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,b.jsxs)("div",{className:"mb-6 flex items-start justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 mb-2 flex items-center gap-2",children:[(0,b.jsx)(i.Sword,{className:"w-8 h-8 text-amber-600"}),"Item Creator"]}),(0,b.jsx)("p",{className:"text-gray-600",children:"Design custom weapons, armor, and accessories by combining item properties. Properties determine the item's rarity and cost."})]}),(0,b.jsxs)("button",{type:"button",onClick:()=>M(!0),className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors",children:[(0,b.jsx)(m.FolderOpen,{className:"w-5 h-5"}),"Load from Library"]})]}),(0,b.jsx)(r.LoadFromLibraryModal,{isOpen:L,onClose:()=>M(!1),onSelect:af,items:U,isLoading:V,error:W,itemType:"item",title:"Load Item from Library"}),(0,b.jsxs)("div",{className:"grid lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,b.jsx)("div",{className:"bg-white rounded-xl shadow-md p-6",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Name *"}),(0,b.jsx)("input",{type:"text",value:d,onChange:a=>f(a.target.value),placeholder:"Enter item name...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Item Type"}),(0,b.jsx)("div",{className:"grid grid-cols-4 gap-2",children:x.map(a=>(0,b.jsxs)("button",{onClick:()=>C(a.value),className:(0,n.cn)("py-2 px-3 rounded-lg font-medium text-sm transition-colors flex items-center justify-center gap-1",o===a.value?"bg-amber-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700"),children:[(0,b.jsx)(a.icon,{className:"w-4 h-4"}),a.label]},a.value))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,b.jsx)("textarea",{value:g,onChange:a=>h(a.target.value),placeholder:"Describe your item...",rows:2,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500"})]})]})}),"Weapon"===o&&(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Weapon Configuration"}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Handedness:"}),(0,b.jsxs)("div",{className:"flex rounded-lg border border-gray-300 overflow-hidden",children:[(0,b.jsx)("button",{type:"button",onClick:()=>O(!1),className:(0,n.cn)("px-4 py-2 text-sm font-medium transition-colors",N?"bg-gray-50 text-gray-700 hover:bg-gray-100":"bg-amber-600 text-white"),children:"One-Handed"}),(0,b.jsx)("button",{type:"button",onClick:()=>O(!0),className:(0,n.cn)("px-4 py-2 text-sm font-medium transition-colors",N?"bg-amber-600 text-white":"bg-gray-50 text-gray-700 hover:bg-gray-100"),children:"Two-Handed"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Range:"}),(0,b.jsx)("span",{className:"font-medium text-amber-600 min-w-[80px]",children:X}),(0,b.jsxs)("div",{className:"flex gap-1",children:[(0,b.jsx)("button",{type:"button",onClick:()=>Q(a=>Math.max(0,a-1)),disabled:0===P,className:"w-8 h-8 flex items-center justify-center bg-amber-600 text-white rounded-lg hover:bg-amber-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"-"}),(0,b.jsx)("button",{type:"button",onClick:()=>Q(a=>a+1),className:"w-8 h-8 flex items-center justify-center bg-amber-600 text-white rounded-lg hover:bg-amber-700",children:"+"})]}),P>0&&(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"(8 spaces per level)"})]})]})]}),"Weapon"===o&&(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Base Damage"}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,b.jsx)(s.NumberStepper,{value:F.amount,onChange:a=>G(b=>({...b,amount:a})),label:"Dice:",min:1,max:10,variant:"item"}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("span",{className:"font-bold text-lg",children:"d"}),(0,b.jsx)("select",{value:F.size,onChange:a=>G(b=>({...b,size:parseInt(a.target.value)})),className:"px-3 py-2 border border-gray-300 rounded-lg",children:z.map(a=>(0,b.jsx)("option",{value:a,children:a},a))})]}),(0,b.jsx)("select",{value:F.type,onChange:a=>G(b=>({...b,type:a.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg",children:y.filter(a=>"none"!==a).map(a=>(0,b.jsx)("option",{value:a,children:a.charAt(0).toUpperCase()+a.slice(1)},a))})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("h3",{className:"text-lg font-bold text-gray-900",children:["Properties (",D.length,")"]}),(0,b.jsxs)("button",{type:"button",onClick:ab,className:"flex items-center gap-1 px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors",children:[(0,b.jsx)(e.Plus,{className:"w-4 h-4"}),"Add Property"]})]}),0===D.length?(0,b.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,b.jsx)(k.Info,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{children:'No properties added yet. Click "Add Property" to enhance your item.'})]}):(0,b.jsx)("div",{className:"space-y-4",children:D.map((a,c)=>(0,b.jsx)(B,{selectedProperty:a,onRemove:()=>ac(c),onUpdate:a=>ad(c,a),allProperties:R},c))})]})]}),(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 sticky top-24",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Item Summary"}),(0,b.jsx)("div",{className:"text-center mb-6",children:(0,b.jsx)("span",{className:(0,n.cn)("inline-block px-4 py-1 rounded-full font-bold text-lg",A[_]||A.Common),children:_})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,b.jsxs)("div",{className:"bg-amber-50 rounded-lg p-4 text-center",children:[(0,b.jsx)(l,{className:"w-6 h-6 mx-auto text-amber-600 mb-1"}),(0,b.jsx)("div",{className:"text-2xl font-bold text-amber-600",children:$.toLocaleString()}),(0,b.jsx)("div",{className:"text-xs text-amber-600",children:"Gold Cost"})]}),(0,b.jsxs)("div",{className:"bg-purple-50 rounded-lg p-4 text-center",children:[(0,b.jsx)(j.Target,{className:"w-6 h-6 mx-auto text-purple-600 mb-1"}),(0,b.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:Z.totalTP}),(0,b.jsx)("div",{className:"text-xs text-purple-600",children:"Training Points"})]})]}),(0,b.jsxs)("div",{className:"space-y-2 text-sm mb-6",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Type:"}),(0,b.jsx)("span",{className:"font-medium",children:o})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Item Power:"}),(0,b.jsxs)("span",{className:"font-medium",children:[Z.totalIP," IP"]})]}),"Weapon"===o&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Handedness:"}),(0,b.jsx)("span",{className:"font-medium",children:N?"Two-Handed":"One-Handed"})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Range:"}),(0,b.jsx)("span",{className:"font-medium",children:X})]})]}),aa&&(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Damage:"}),(0,b.jsx)("span",{className:"font-medium",children:aa})]})]}),D.length>0&&(0,b.jsxs)("div",{className:"border-t border-gray-100 pt-4 mb-6",children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Properties"}),(0,b.jsx)("ul",{className:"text-xs text-gray-600 space-y-1",children:D.map((a,c)=>(0,b.jsxs)("li",{children:["â€¢ ",a.property.name,a.op_1_lvl>0&&` (Lvl ${a.op_1_lvl})`]},c))})]}),J&&(0,b.jsx)("div",{className:(0,n.cn)("mb-4 p-3 rounded-lg text-sm","success"===J.type?"bg-green-50 text-green-700":"bg-red-50 text-red-700"),children:J.text}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("button",{type:"button",onClick:ae,disabled:H||!d.trim(),className:(0,n.cn)("w-full py-3 rounded-xl font-bold transition-colors",H||!d.trim()?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),children:H?"Saving...":"Save to Library"}),(0,b.jsx)("button",{type:"button",onClick:()=>{f(""),h(""),C("Weapon"),E([]),G({amount:1,size:6,type:"slashing"}),K(null)},className:"w-full py-2 rounded-xl font-medium text-gray-600 hover:bg-gray-100 transition-colors",children:"Reset"})]})]})})]})]})}function D(){return(0,b.jsx)(o.ProtectedRoute,{children:(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 py-8 px-4",children:(0,b.jsx)(C,{})})})}a.s(["default",()=>D],39721)}];

//# sourceMappingURL=src_app_%28main%29_item-creator_page_tsx_25f0d277._.js.map