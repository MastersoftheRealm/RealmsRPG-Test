{"version":3,"sources":["../../../../src/app/%28main%29/technique-creator/page.tsx"],"sourcesContent":["/**\r\n * Technique Creator Page\r\n * ======================\r\n * Tool for creating custom martial techniques using the technique parts system.\r\n * \r\n * Features:\r\n * - Select technique parts from RTDB database\r\n * - Configure option levels for each part\r\n * - Calculate stamina and training point costs\r\n * - Save to user's library via Cloud Functions\r\n */\r\n\r\n'use client';\r\n\r\nimport { useState, useMemo, useCallback } from 'react';\r\nimport { X, Plus, ChevronDown, ChevronUp, Swords, Zap, Target, Info, Crosshair, FolderOpen } from 'lucide-react';\r\nimport { cn } from '@/lib/utils';\r\nimport { ProtectedRoute } from '@/components/layout';\r\nimport { useTechniqueParts, useUserTechniques, type TechniquePart } from '@/hooks';\r\nimport { useAuthStore } from '@/stores';\r\nimport { functions } from '@/lib/firebase/client';\r\nimport { httpsCallable } from 'firebase/functions';\r\nimport { LoadFromLibraryModal } from '@/components/creator/LoadFromLibraryModal';\r\nimport { NumberStepper } from '@/components/creator/number-stepper';\r\nimport {\r\n  calculateTechniqueCosts,\r\n  computeTechniqueActionTypeFromSelection,\r\n  formatTechniqueDamage,\r\n  type TechniquePartPayload,\r\n} from '@/lib/calculators';\r\n\r\n// =============================================================================\r\n// Types\r\n// =============================================================================\r\n\r\ninterface SelectedPart {\r\n  part: TechniquePart;\r\n  op_1_lvl: number;\r\n  op_2_lvl: number;\r\n  op_3_lvl: number;\r\n  selectedCategory: string;\r\n}\r\n\r\ninterface DamageConfig {\r\n  amount: number;\r\n  size: number;\r\n  type: string;\r\n}\r\n\r\ninterface WeaponConfig {\r\n  id: number;\r\n  name: string;\r\n}\r\n\r\n// =============================================================================\r\n// Constants\r\n// =============================================================================\r\n\r\nconst ACTION_OPTIONS = [\r\n  { value: 'basic', label: 'Basic Action' },\r\n  { value: 'quick', label: 'Quick Action' },\r\n  { value: 'free', label: 'Free Action' },\r\n  { value: 'long3', label: 'Long Action (3 AP)' },\r\n  { value: 'long4', label: 'Long Action (4 AP)' },\r\n];\r\n\r\nconst DAMAGE_TYPES = [\r\n  'none', 'physical', 'slashing', 'piercing', 'bludgeoning'\r\n];\r\n\r\nconst DIE_SIZES = [4, 6, 8, 10, 12];\r\n\r\nconst WEAPON_OPTIONS = [\r\n  { id: 0, name: 'Unarmed' },\r\n  { id: 1, name: 'Any Melee' },\r\n  { id: 2, name: 'Any Ranged' },\r\n  { id: 3, name: 'Sword' },\r\n  { id: 4, name: 'Axe' },\r\n  { id: 5, name: 'Spear' },\r\n  { id: 6, name: 'Bow' },\r\n  { id: 7, name: 'Crossbow' },\r\n];\r\n\r\n// =============================================================================\r\n// Subcomponents\r\n// =============================================================================\r\n\r\nfunction PartCard({\r\n  selectedPart,\r\n  index,\r\n  onRemove,\r\n  onUpdate,\r\n  allParts,\r\n}: {\r\n  selectedPart: SelectedPart;\r\n  index: number;\r\n  onRemove: () => void;\r\n  onUpdate: (updates: Partial<SelectedPart>) => void;\r\n  allParts: TechniquePart[];\r\n}) {\r\n  const [expanded, setExpanded] = useState(true);\r\n  const { part } = selectedPart;\r\n\r\n  // Get categories from all parts\r\n  const categories = useMemo(() => {\r\n    const cats = new Set(allParts.map((p) => p.category));\r\n    return ['any', ...Array.from(cats).sort()];\r\n  }, [allParts]);\r\n\r\n  // Filter parts by selected category\r\n  const filteredParts = useMemo(() => {\r\n    const cat = selectedPart.selectedCategory;\r\n    if (!cat || cat === 'any') return allParts.sort((a, b) => a.name.localeCompare(b.name));\r\n    return allParts.filter((p) => p.category === cat).sort((a, b) => a.name.localeCompare(b.name));\r\n  }, [allParts, selectedPart.selectedCategory]);\r\n\r\n  // Check which options have content\r\n  const hasOption = (n: 1 | 2 | 3) => {\r\n    const desc = part[`op_${n}_desc` as keyof TechniquePart] as string | undefined;\r\n    const en = part[`op_${n}_en` as keyof TechniquePart] as number | undefined;\r\n    const tp = part[`op_${n}_tp` as keyof TechniquePart] as number | undefined;\r\n    return (desc && desc.trim() !== '') || (en !== undefined && en !== 0) || (tp !== undefined && tp !== 0);\r\n  };\r\n\r\n  // Calculate part's individual contribution\r\n  const partStam =\r\n    (part.base_stam || 0) +\r\n    (part.op_1_en || 0) * selectedPart.op_1_lvl +\r\n    (part.op_2_en || 0) * selectedPart.op_2_lvl +\r\n    (part.op_3_en || 0) * selectedPart.op_3_lvl;\r\n\r\n  const partTP =\r\n    (part.base_tp || 0) +\r\n    (part.op_1_tp || 0) * selectedPart.op_1_lvl +\r\n    (part.op_2_tp || 0) * selectedPart.op_2_lvl +\r\n    (part.op_3_tp || 0) * selectedPart.op_3_lvl;\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden\">\r\n      {/* Header */}\r\n      <div className=\"bg-gray-50 px-4 py-3 flex items-center justify-between\">\r\n        <div className=\"flex items-center gap-2\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => setExpanded(!expanded)}\r\n            className=\"text-gray-500 hover:text-gray-700\"\r\n          >\r\n            {expanded ? <ChevronUp className=\"w-5 h-5\" /> : <ChevronDown className=\"w-5 h-5\" />}\r\n          </button>\r\n          <span className=\"font-medium text-gray-900\">{part.name}</span>\r\n          <span className=\"text-sm text-gray-500\">\r\n            Stam: {partStam.toFixed(1)} | TP: {Math.floor(partTP)}\r\n          </span>\r\n        </div>\r\n        <button\r\n          type=\"button\"\r\n          onClick={onRemove}\r\n          className=\"text-gray-400 hover:text-red-500\"\r\n        >\r\n          <X className=\"w-5 h-5\" />\r\n        </button>\r\n      </div>\r\n\r\n      {/* Expanded Content */}\r\n      {expanded && (\r\n        <div className=\"px-4 py-4 space-y-4\">\r\n          {/* Category and Part Selection */}\r\n          <div className=\"grid md:grid-cols-2 gap-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Category\r\n              </label>\r\n              <select\r\n                value={selectedPart.selectedCategory}\r\n                onChange={(e) => onUpdate({ selectedCategory: e.target.value })}\r\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm\"\r\n              >\r\n                {categories.map((cat) => (\r\n                  <option key={cat} value={cat}>\r\n                    {cat === 'any' ? 'All Categories' : cat}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Part\r\n              </label>\r\n              <select\r\n                value={filteredParts.findIndex((p) => p.id === part.id)}\r\n                onChange={(e) => {\r\n                  const idx = parseInt(e.target.value);\r\n                  const newPart = filteredParts[idx];\r\n                  if (newPart) {\r\n                    onUpdate({\r\n                      part: newPart,\r\n                      op_1_lvl: 0,\r\n                      op_2_lvl: 0,\r\n                      op_3_lvl: 0,\r\n                    });\r\n                  }\r\n                }}\r\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm\"\r\n              >\r\n                {filteredParts.map((p, idx) => (\r\n                  <option key={p.id} value={idx}>\r\n                    {p.name}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Description */}\r\n          <p className=\"text-sm text-gray-600\">{part.description}</p>\r\n\r\n          {/* Base Values */}\r\n          <div className=\"flex gap-4 text-sm\">\r\n            <span className=\"text-gray-600\">\r\n              Base Stamina: <strong>{part.base_stam}</strong>\r\n            </span>\r\n            <span className=\"text-gray-600\">\r\n              Base TP: <strong>{part.base_tp}</strong>\r\n            </span>\r\n          </div>\r\n\r\n          {/* Options */}\r\n          {(hasOption(1) || hasOption(2) || hasOption(3)) && (\r\n            <div className=\"space-y-3 pt-2 border-t border-gray-100\">\r\n              {hasOption(1) && (\r\n                <div className=\"bg-gray-50 rounded-lg p-3\">\r\n                  <div className=\"flex items-center justify-between mb-2\">\r\n                    <span className=\"text-sm font-medium\">\r\n                      Option 1:{' '}\r\n                      <span className=\"text-gray-500\">\r\n                        Stam {(part.op_1_en || 0) >= 0 ? '+' : ''}{part.op_1_en || 0}, TP{' '}\r\n                        {(part.op_1_tp || 0) >= 0 ? '+' : ''}{part.op_1_tp || 0}\r\n                      </span>\r\n                    </span>\r\n                    <NumberStepper\r\n                      value={selectedPart.op_1_lvl}\r\n                      onChange={(v) => onUpdate({ op_1_lvl: v })}\r\n                      label=\"Level:\"\r\n                      variant=\"technique\"\r\n                    />\r\n                  </div>\r\n                  {part.op_1_desc && (\r\n                    <p className=\"text-sm text-gray-600\">{part.op_1_desc}</p>\r\n                  )}\r\n                </div>\r\n              )}\r\n\r\n              {hasOption(2) && (\r\n                <div className=\"bg-gray-50 rounded-lg p-3\">\r\n                  <div className=\"flex items-center justify-between mb-2\">\r\n                    <span className=\"text-sm font-medium\">\r\n                      Option 2:{' '}\r\n                      <span className=\"text-gray-500\">\r\n                        Stam {(part.op_2_en || 0) >= 0 ? '+' : ''}{part.op_2_en || 0}, TP{' '}\r\n                        {(part.op_2_tp || 0) >= 0 ? '+' : ''}{part.op_2_tp || 0}\r\n                      </span>\r\n                    </span>\r\n                    <NumberStepper\r\n                      value={selectedPart.op_2_lvl}\r\n                      onChange={(v) => onUpdate({ op_2_lvl: v })}\r\n                      label=\"Level:\"\r\n                      variant=\"technique\"\r\n                    />\r\n                  </div>\r\n                  {part.op_2_desc && (\r\n                    <p className=\"text-sm text-gray-600\">{part.op_2_desc}</p>\r\n                  )}\r\n                </div>\r\n              )}\r\n\r\n              {hasOption(3) && (\r\n                <div className=\"bg-gray-50 rounded-lg p-3\">\r\n                  <div className=\"flex items-center justify-between mb-2\">\r\n                    <span className=\"text-sm font-medium\">\r\n                      Option 3:{' '}\r\n                      <span className=\"text-gray-500\">\r\n                        Stam {(part.op_3_en || 0) >= 0 ? '+' : ''}{part.op_3_en || 0}, TP{' '}\r\n                        {(part.op_3_tp || 0) >= 0 ? '+' : ''}{part.op_3_tp || 0}\r\n                      </span>\r\n                    </span>\r\n                    <NumberStepper\r\n                      value={selectedPart.op_3_lvl}\r\n                      onChange={(v) => onUpdate({ op_3_lvl: v })}\r\n                      label=\"Level:\"\r\n                      variant=\"technique\"\r\n                    />\r\n                  </div>\r\n                  {part.op_3_desc && (\r\n                    <p className=\"text-sm text-gray-600\">{part.op_3_desc}</p>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n// =============================================================================\r\n// Main Component\r\n// =============================================================================\r\n\r\nfunction TechniqueCreatorContent() {\r\n  const { user } = useAuthStore();\r\n  \r\n  // State\r\n  const [name, setName] = useState('');\r\n  const [description, setDescription] = useState('');\r\n  const [selectedParts, setSelectedParts] = useState<SelectedPart[]>([]);\r\n  const [actionType, setActionType] = useState('basic');\r\n  const [isReaction, setIsReaction] = useState(false);\r\n  const [damage, setDamage] = useState<DamageConfig>({ amount: 0, size: 6, type: 'none' });\r\n  const [weapon, setWeapon] = useState<WeaponConfig>(WEAPON_OPTIONS[0]);\r\n  const [saving, setSaving] = useState(false);\r\n  const [saveMessage, setSaveMessage] = useState<{ type: 'success' | 'error'; text: string } | null>(null);\r\n  const [showLoadModal, setShowLoadModal] = useState(false);\r\n\r\n  // Fetch technique parts\r\n  const { data: techniqueParts = [], isLoading, error } = useTechniqueParts();\r\n  \r\n  // Fetch user's saved techniques for loading\r\n  const { data: userTechniques, isLoading: loadingUserTechniques, error: userTechniquesError } = useUserTechniques();\r\n\r\n  // Convert selected parts to payload format for calculator\r\n  const partsPayload: TechniquePartPayload[] = useMemo(\r\n    () =>\r\n      selectedParts.map((sp) => ({\r\n        id: Number(sp.part.id),\r\n        name: sp.part.name,\r\n        part: sp.part,\r\n        op_1_lvl: sp.op_1_lvl,\r\n        op_2_lvl: sp.op_2_lvl,\r\n        op_3_lvl: sp.op_3_lvl,\r\n      })),\r\n    [selectedParts]\r\n  );\r\n\r\n  // Calculate costs - using technique parts as the database\r\n  const costs = useMemo(\r\n    () => calculateTechniqueCosts(partsPayload, techniqueParts),\r\n    [partsPayload, techniqueParts]\r\n  );\r\n\r\n  // Derived display values\r\n  const actionTypeDisplay = useMemo(\r\n    () => computeTechniqueActionTypeFromSelection(actionType, isReaction),\r\n    [actionType, isReaction]\r\n  );\r\n\r\n  const damageDisplay = useMemo(\r\n    () => formatTechniqueDamage(damage.type !== 'none' && damage.amount > 0 ? damage : undefined),\r\n    [damage]\r\n  );\r\n\r\n  // Actions\r\n  const addPart = useCallback(() => {\r\n    if (techniqueParts.length === 0) return;\r\n    setSelectedParts((prev) => [\r\n      ...prev,\r\n      {\r\n        part: techniqueParts[0],\r\n        op_1_lvl: 0,\r\n        op_2_lvl: 0,\r\n        op_3_lvl: 0,\r\n        selectedCategory: 'any',\r\n      },\r\n    ]);\r\n  }, [techniqueParts]);\r\n\r\n  const removePart = useCallback((index: number) => {\r\n    setSelectedParts((prev) => prev.filter((_, i) => i !== index));\r\n  }, []);\r\n\r\n  const updatePart = useCallback((index: number, updates: Partial<SelectedPart>) => {\r\n    setSelectedParts((prev) =>\r\n      prev.map((sp, i) => (i === index ? { ...sp, ...updates } : sp))\r\n    );\r\n  }, []);\r\n\r\n  const handleSave = async () => {\r\n    if (!name.trim()) {\r\n      setSaveMessage({ type: 'error', text: 'Please enter a technique name' });\r\n      return;\r\n    }\r\n    if (!user) {\r\n      setSaveMessage({ type: 'error', text: 'You must be logged in to save' });\r\n      return;\r\n    }\r\n\r\n    setSaving(true);\r\n    setSaveMessage(null);\r\n\r\n    try {\r\n      const saveTechniqueToLibrary = httpsCallable(functions, 'saveTechniqueToLibrary');\r\n      \r\n      // Format parts for saving\r\n      const partsToSave = selectedParts.map((sp) => ({\r\n        id: Number(sp.part.id),\r\n        name: sp.part.name,\r\n        op_1_lvl: sp.op_1_lvl,\r\n        op_2_lvl: sp.op_2_lvl,\r\n        op_3_lvl: sp.op_3_lvl,\r\n      }));\r\n\r\n      // Format damage\r\n      const damageToSave =\r\n        damage.type !== 'none' && damage.amount > 0\r\n          ? { amount: damage.amount, size: damage.size, type: damage.type }\r\n          : null;\r\n\r\n      await saveTechniqueToLibrary({\r\n        techniqueName: name.trim(),\r\n        techniqueDescription: description.trim(),\r\n        parts: partsToSave,\r\n        damage: damageToSave,\r\n        weapon: weapon.id > 0 ? weapon : null,\r\n      });\r\n\r\n      setSaveMessage({ type: 'success', text: 'Technique saved successfully!' });\r\n      \r\n      // Reset form after short delay\r\n      setTimeout(() => {\r\n        setName('');\r\n        setDescription('');\r\n        setSelectedParts([]);\r\n        setDamage({ amount: 0, size: 6, type: 'none' });\r\n        setWeapon(WEAPON_OPTIONS[0]);\r\n        setSaveMessage(null);\r\n      }, 2000);\r\n    } catch (err) {\r\n      console.error('Error saving technique:', err);\r\n      setSaveMessage({\r\n        type: 'error',\r\n        text: `Failed to save: ${(err as Error).message}`,\r\n      });\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const handleReset = () => {\r\n    setName('');\r\n    setDescription('');\r\n    setSelectedParts([]);\r\n    setActionType('basic');\r\n    setIsReaction(false);\r\n    setDamage({ amount: 0, size: 6, type: 'none' });\r\n    setWeapon(WEAPON_OPTIONS[0]);\r\n    setSaveMessage(null);\r\n  };\r\n\r\n  // Load a technique from the library\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  const handleLoadTechnique = useCallback((technique: any) => {\r\n    // Set name and description\r\n    setName(technique.name || '');\r\n    setDescription(technique.description || '');\r\n    \r\n    // Load parts\r\n    const savedParts = (technique.parts || technique.techniqueParts || []) as Array<{\r\n      id?: number | string;\r\n      name?: string;\r\n      op_1_lvl?: number;\r\n      op_2_lvl?: number;\r\n      op_3_lvl?: number;\r\n    }>;\r\n    \r\n    const loadedParts: SelectedPart[] = [];\r\n    for (const savedPart of savedParts) {\r\n      const matchedPart = techniqueParts.find(\r\n        (p) => p.id === String(savedPart.id) || p.name === savedPart.name\r\n      );\r\n      \r\n      if (matchedPart) {\r\n        loadedParts.push({\r\n          part: matchedPart,\r\n          op_1_lvl: savedPart.op_1_lvl || 0,\r\n          op_2_lvl: savedPart.op_2_lvl || 0,\r\n          op_3_lvl: savedPart.op_3_lvl || 0,\r\n          selectedCategory: matchedPart.category || 'any',\r\n        });\r\n      }\r\n    }\r\n    setSelectedParts(loadedParts);\r\n    \r\n    // Load weapon\r\n    if (technique.weapon) {\r\n      const weaponMatch = WEAPON_OPTIONS.find(\r\n        (w) => w.id === technique.weapon.id || w.name === technique.weapon.name\r\n      );\r\n      if (weaponMatch) {\r\n        setWeapon(weaponMatch);\r\n      }\r\n    }\r\n    \r\n    // Load damage\r\n    if (technique.damage) {\r\n      const dmg = technique.damage;\r\n      setDamage({\r\n        amount: dmg.amount || dmg.dice || 0,\r\n        size: dmg.size || dmg.sides || 6,\r\n        type: dmg.type || 'none',\r\n      });\r\n    } else {\r\n      setDamage({ amount: 0, size: 6, type: 'none' });\r\n    }\r\n    \r\n    setSaveMessage({ type: 'success', text: 'Technique loaded successfully!' });\r\n    setTimeout(() => setSaveMessage(null), 2000);\r\n  }, [techniqueParts]);\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"max-w-6xl mx-auto\">\r\n        <div className=\"animate-pulse space-y-4\">\r\n          <div className=\"h-8 bg-gray-200 rounded w-1/3\"></div>\r\n          <div className=\"h-4 bg-gray-200 rounded w-2/3\"></div>\r\n          <div className=\"h-64 bg-gray-200 rounded\"></div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"max-w-6xl mx-auto\">\r\n        <div className=\"bg-red-50 border border-red-200 rounded-xl p-6 text-center\">\r\n          <p className=\"text-red-700\">Failed to load technique parts: {error.message}</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-6xl mx-auto\">\r\n      <div className=\"mb-6 flex items-start justify-between\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold text-gray-900 mb-2 flex items-center gap-2\">\r\n            <Swords className=\"w-8 h-8 text-red-600\" />\r\n            Technique Creator\r\n          </h1>\r\n          <p className=\"text-gray-600\">\r\n            Design custom martial techniques by combining technique parts. Each part contributes to the total\r\n            stamina cost and training point requirements.\r\n          </p>\r\n        </div>\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => setShowLoadModal(true)}\r\n          className=\"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors\"\r\n        >\r\n          <FolderOpen className=\"w-5 h-5\" />\r\n          Load from Library\r\n        </button>\r\n      </div>\r\n\r\n      {/* Load from Library Modal */}\r\n      <LoadFromLibraryModal\r\n        isOpen={showLoadModal}\r\n        onClose={() => setShowLoadModal(false)}\r\n        onSelect={handleLoadTechnique}\r\n        items={userTechniques}\r\n        isLoading={loadingUserTechniques}\r\n        error={userTechniquesError}\r\n        itemType=\"technique\"\r\n        title=\"Load Technique from Library\"\r\n      />\r\n\r\n      <div className=\"grid lg:grid-cols-3 gap-6\">\r\n        {/* Main Editor */}\r\n        <div className=\"lg:col-span-2 space-y-6\">\r\n          {/* Name & Description */}\r\n          <div className=\"bg-white rounded-xl shadow-md p-6\">\r\n            <div className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  Technique Name *\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={name}\r\n                  onChange={(e) => setName(e.target.value)}\r\n                  placeholder=\"Enter technique name...\"\r\n                  className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  Description\r\n                </label>\r\n                <textarea\r\n                  value={description}\r\n                  onChange={(e) => setDescription(e.target.value)}\r\n                  placeholder=\"Describe what your technique does...\"\r\n                  rows={3}\r\n                  className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Weapon & Action Type */}\r\n          <div className=\"bg-white rounded-xl shadow-md p-6\">\r\n            <h3 className=\"text-lg font-bold text-gray-900 mb-4\">Combat Configuration</h3>\r\n            <div className=\"grid md:grid-cols-2 gap-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  Weapon Type\r\n                </label>\r\n                <select\r\n                  value={weapon.id}\r\n                  onChange={(e) => {\r\n                    const selected = WEAPON_OPTIONS.find(w => w.id === parseInt(e.target.value));\r\n                    if (selected) setWeapon(selected);\r\n                  }}\r\n                  className=\"w-full px-4 py-2 border border-gray-300 rounded-lg\"\r\n                >\r\n                  {WEAPON_OPTIONS.map((opt) => (\r\n                    <option key={opt.id} value={opt.id}>\r\n                      {opt.name}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  Action Type\r\n                </label>\r\n                <select\r\n                  value={actionType}\r\n                  onChange={(e) => setActionType(e.target.value)}\r\n                  className=\"w-full px-4 py-2 border border-gray-300 rounded-lg\"\r\n                >\r\n                  {ACTION_OPTIONS.map((opt) => (\r\n                    <option key={opt.value} value={opt.value}>\r\n                      {opt.label}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n            </div>\r\n            <div className=\"mt-4\">\r\n              <label className=\"flex items-center gap-2\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={isReaction}\r\n                  onChange={(e) => setIsReaction(e.target.checked)}\r\n                  className=\"rounded border-gray-300\"\r\n                />\r\n                <span className=\"text-sm\">Can be used as a Reaction</span>\r\n              </label>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Technique Parts */}\r\n          <div className=\"bg-white rounded-xl shadow-md p-6\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h3 className=\"text-lg font-bold text-gray-900\">\r\n                Technique Parts ({selectedParts.length})\r\n              </h3>\r\n              <button\r\n                type=\"button\"\r\n                onClick={addPart}\r\n                className=\"flex items-center gap-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors\"\r\n              >\r\n                <Plus className=\"w-4 h-4\" />\r\n                Add Part\r\n              </button>\r\n            </div>\r\n\r\n            {selectedParts.length === 0 ? (\r\n              <div className=\"text-center py-8 text-gray-500\">\r\n                <Info className=\"w-12 h-12 mx-auto mb-2 opacity-50\" />\r\n                <p>No parts added yet. Click &quot;Add Part&quot; to begin building your technique.</p>\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-4\">\r\n                {selectedParts.map((sp, idx) => (\r\n                  <PartCard\r\n                    key={idx}\r\n                    selectedPart={sp}\r\n                    index={idx}\r\n                    onRemove={() => removePart(idx)}\r\n                    onUpdate={(updates) => updatePart(idx, updates)}\r\n                    allParts={techniqueParts}\r\n                  />\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Additional Damage */}\r\n          <div className=\"bg-white rounded-xl shadow-md p-6\">\r\n            <h3 className=\"text-lg font-bold text-gray-900 mb-4\">Additional Damage (Optional)</h3>\r\n            <div className=\"flex flex-wrap items-center gap-4\">\r\n              <NumberStepper\r\n                value={damage.amount}\r\n                onChange={(v) => setDamage((d) => ({ ...d, amount: v }))}\r\n                label=\"Dice:\"\r\n                min={0}\r\n                max={20}\r\n                variant=\"technique\"\r\n              />\r\n              <div className=\"flex items-center gap-1\">\r\n                <span className=\"font-bold text-lg\">d</span>\r\n                <select\r\n                  value={damage.size}\r\n                  onChange={(e) => setDamage((d) => ({ ...d, size: parseInt(e.target.value) }))}\r\n                  className=\"px-3 py-2 border border-gray-300 rounded-lg\"\r\n                >\r\n                  {DIE_SIZES.map((size) => (\r\n                    <option key={size} value={size}>\r\n                      {size}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n              <select\r\n                value={damage.type}\r\n                onChange={(e) => setDamage((d) => ({ ...d, type: e.target.value }))}\r\n                className=\"px-3 py-2 border border-gray-300 rounded-lg\"\r\n              >\r\n                {DAMAGE_TYPES.map((type) => (\r\n                  <option key={type} value={type}>\r\n                    {type === 'none' ? 'No additional damage' : type.charAt(0).toUpperCase() + type.slice(1)}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n            {damage.type !== 'none' && damage.amount > 0 && (\r\n              <p className=\"mt-2 text-sm text-gray-600\">\r\n                Additional Damage: <strong>{damage.amount}d{damage.size} {damage.type}</strong>\r\n              </p>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Sidebar - Cost Summary */}\r\n        <div className=\"space-y-6\">\r\n          <div className=\"bg-white rounded-xl shadow-md p-6 sticky top-24\">\r\n            <h3 className=\"text-lg font-bold text-gray-900 mb-4\">Technique Summary</h3>\r\n\r\n            {/* Cost Display */}\r\n            <div className=\"grid grid-cols-2 gap-4 mb-6\">\r\n              <div className=\"bg-red-50 rounded-lg p-4 text-center\">\r\n                <Zap className=\"w-6 h-6 mx-auto text-red-600 mb-1\" />\r\n                <div className=\"text-3xl font-bold text-red-600\">{costs.totalEnergy}</div>\r\n                <div className=\"text-xs text-red-600\">Stamina Cost</div>\r\n              </div>\r\n              <div className=\"bg-purple-50 rounded-lg p-4 text-center\">\r\n                <Target className=\"w-6 h-6 mx-auto text-purple-600 mb-1\" />\r\n                <div className=\"text-3xl font-bold text-purple-600\">{costs.totalTP}</div>\r\n                <div className=\"text-xs text-purple-600\">Training Points</div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Derived Stats */}\r\n            <div className=\"space-y-2 text-sm mb-6\">\r\n              <div className=\"flex justify-between\">\r\n                <span className=\"text-gray-600\">Action:</span>\r\n                <span className=\"font-medium\">{actionTypeDisplay}</span>\r\n              </div>\r\n              <div className=\"flex justify-between\">\r\n                <span className=\"text-gray-600\">Weapon:</span>\r\n                <span className=\"font-medium\">{weapon.name}</span>\r\n              </div>\r\n              {damageDisplay && (\r\n                <div className=\"flex justify-between\">\r\n                  <span className=\"text-gray-600\">Damage:</span>\r\n                  <span className=\"font-medium\">{damageDisplay}</span>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* TP Sources */}\r\n            {costs.tpSources.length > 0 && (\r\n              <div className=\"border-t border-gray-100 pt-4 mb-6\">\r\n                <h4 className=\"text-sm font-medium text-gray-700 mb-2\">TP Breakdown</h4>\r\n                <ul className=\"text-xs text-gray-600 space-y-1\">\r\n                  {costs.tpSources.map((src, i) => (\r\n                    <li key={i}>â€¢ {src}</li>\r\n                  ))}\r\n                </ul>\r\n              </div>\r\n            )}\r\n\r\n            {/* Save Message */}\r\n            {saveMessage && (\r\n              <div\r\n                className={cn(\r\n                  'mb-4 p-3 rounded-lg text-sm',\r\n                  saveMessage.type === 'success'\r\n                    ? 'bg-green-50 text-green-700'\r\n                    : 'bg-red-50 text-red-700'\r\n                )}\r\n              >\r\n                {saveMessage.text}\r\n              </div>\r\n            )}\r\n\r\n            {/* Actions */}\r\n            <div className=\"space-y-2\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleSave}\r\n                disabled={saving || !name.trim()}\r\n                className={cn(\r\n                  'w-full py-3 rounded-xl font-bold transition-colors',\r\n                  saving || !name.trim()\r\n                    ? 'bg-gray-300 text-gray-500 cursor-not-allowed'\r\n                    : 'bg-green-600 text-white hover:bg-green-700'\r\n                )}\r\n              >\r\n                {saving ? 'Saving...' : 'Save to Library'}\r\n              </button>\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleReset}\r\n                className=\"w-full py-2 rounded-xl font-medium text-gray-600 hover:bg-gray-100 transition-colors\"\r\n              >\r\n                Reset\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function TechniqueCreatorPage() {\r\n  return (\r\n    <ProtectedRoute>\r\n      <div className=\"min-h-screen bg-gray-50 py-8 px-4\">\r\n        <TechniqueCreatorContent />\r\n      </div>\r\n    </ProtectedRoute>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}