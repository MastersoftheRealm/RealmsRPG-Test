module.exports=[64070,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);a.i(50889);var e=a.i(45838),f=a.i(34816);a.i(72500);var g=a.i(18239);let h={archetype:"1. Archetype",species:"2. Species",ancestry:"3. Ancestry",abilities:"4. Abilities",skills:"5. Skills",feats:"6. Feats",equipment:"7. Equipment",powers:"8. Powers",finalize:"9. Finalize"};function i(){let{currentStep:a,completedSteps:c,setStep:d,canNavigateToStep:e,resetCreator:i}=(0,f.useCharacterCreatorStore)();return(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-1 p-2 bg-gray-100 rounded-lg mb-4",children:[f.STEP_ORDER.map(f=>{let i=a===f,j=c.includes(f),k=e(f);return(0,b.jsxs)("button",{onClick:()=>d(f),disabled:!k,className:(0,g.cn)("px-3 py-2 rounded-lg text-sm font-medium transition-all",i&&"bg-primary-600 text-white shadow-md",!i&&j&&"bg-green-100 text-green-700 hover:bg-green-200",!i&&!j&&k&&"bg-white text-gray-600 hover:bg-gray-50",!i&&!j&&!k&&"bg-gray-200 text-gray-400 cursor-not-allowed"),children:[j&&!i&&"âœ“ ",h[f]]},f)}),(0,b.jsx)("button",{onClick:()=>{confirm("Are you sure you want to restart? All progress will be lost.")&&i()},className:"ml-auto px-3 py-2 rounded-lg text-sm font-medium bg-red-100 text-red-700 hover:bg-red-200 transition-colors",children:"Restart"})]})}let j=["strength","vitality","agility","acuity","intelligence","charisma"],k={power:{title:"Power",description:"Focus on supernatural, magical, or extraordinary abilities. You excel at manipulating energy and casting powerful effects."},"powered-martial":{title:"Powered-Martial",description:"A balanced blend of martial prowess and supernatural abilities. You can fight effectively while also wielding power."},martial:{title:"Martial",description:"Master of physical combat and martial techniques. You rely on skill, training, and physical prowess."}};var l=a.i(20747),m=a.i(46842),n=a.i(60137);let o=(0,n.default)("ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]),p=(0,n.default)("scale",[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]]);var q=a.i(1027),r=a.i(76472),s=a.i(40104),t=a.i(28620);let u={strength:{name:"Strength",description:"Physical power, melee damage, and carrying capacity",defenseLink:"Might"},vitality:{name:"Vitality",description:"Health, endurance, and resistance to physical effects",defenseLink:"Fortitude"},agility:{name:"Agility",description:"Speed, dexterity, reflexes, and finesse attacks",defenseLink:"Reflex"},acuity:{name:"Acuity",description:"Perception, awareness, and ranged accuracy",defenseLink:"Discernment"},intelligence:{name:"Intelligence",description:"Knowledge, reasoning, and mental power",defenseLink:"Mental Fortitude"},charisma:{name:"Charisma",description:"Force of personality, leadership, and social influence",defenseLink:"Resolve"}},v=["strength","vitality","agility","acuity","intelligence","charisma"];var w=a.i(47932);let x=["Strength","Vitality","Agility","Acuity","Intelligence","Charisma"];function y({skill:a,value:d,onAllocate:e,canIncrease:f}){let[h,i]=(0,c.useState)(!1);return(0,b.jsxs)("div",{className:(0,g.cn)("p-3 rounded-lg border transition-colors",d>0?"bg-primary-50 border-primary-200":"bg-gray-50 border-gray-200"),children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>i(!h),className:"text-gray-400 hover:text-gray-600 text-sm",children:"â„¹ï¸"}),(0,b.jsx)("span",{className:"font-medium text-gray-900",children:a.name})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>e(-1),disabled:0===d,className:(0,g.cn)("w-7 h-7 rounded flex items-center justify-center font-bold",d>0?"bg-gray-200 hover:bg-gray-300 text-gray-700":"bg-gray-100 text-gray-300 cursor-not-allowed"),children:"âˆ’"}),(0,b.jsx)("span",{className:(0,g.cn)("w-8 text-center font-bold",d>0?"text-primary-700":"text-gray-400"),children:d}),(0,b.jsx)("button",{onClick:()=>e(1),disabled:!f,className:(0,g.cn)("w-7 h-7 rounded flex items-center justify-center font-bold",f?"bg-primary-600 hover:bg-primary-700 text-white":"bg-gray-100 text-gray-300 cursor-not-allowed"),children:"+"})]})]}),h&&a.description&&(0,b.jsx)("p",{className:"text-xs text-gray-600 mt-2 border-t border-gray-200 pt-2",children:a.description})]})}var z=a.i(27922),A=a.i(38246),B=a.i(15618),C=a.i(54933),D=a.i(19221),E=a.i(33508);let F=(0,n.default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);a.i(43773);var G=a.i(61074),H=a.i(90101),I=a.i(97907);let J=[{id:"name",label:"Name",field:"name",type:"string"},{id:"cost",label:"Energy",field:"cost",type:"number"}],K=[{id:"name",label:"Name",field:"name",type:"string"},{id:"cost",label:"TP",field:"cost",type:"number"}];a.i(69387);var L=a.i(60574),M=a.i(77967);function N({isOpen:a,onClose:c,issues:d,onContinueAnyway:e}){if(!a)return null;let f=d.some(a=>"error"===a.severity),h=0===d.length;return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl max-w-lg w-full max-h-[80vh] overflow-hidden",children:[(0,b.jsxs)("div",{className:(0,g.cn)("p-4 border-b flex items-center gap-3",h?"bg-green-50":f?"bg-red-50":"bg-amber-50"),children:[(0,b.jsx)("span",{className:"text-2xl",children:h?"âœ…":f?"âš ï¸":"ðŸ“‹"}),(0,b.jsx)("h2",{className:"text-xl font-bold",children:h?"Character Ready!":f?"Issues Found":"Review Needed"})]}),(0,b.jsx)("div",{className:"p-4 overflow-y-auto max-h-[50vh]",children:h?(0,b.jsx)("p",{className:"text-gray-600 text-center py-8",children:'Your character is complete and ready for adventure! Click "Create Character" to save.'}):(0,b.jsx)("div",{className:"space-y-3",children:d.map((a,c)=>(0,b.jsxs)("div",{className:(0,g.cn)("p-3 rounded-lg flex gap-3","error"===a.severity?"bg-red-50":"bg-amber-50"),children:[(0,b.jsx)("span",{className:"text-xl flex-shrink-0",children:a.emoji}),(0,b.jsx)("p",{className:"text-gray-700",children:a.message})]},c))})}),(0,b.jsxs)("div",{className:"p-4 border-t flex justify-end gap-3",children:[(0,b.jsx)("button",{onClick:c,className:"px-4 py-2 rounded-lg border border-gray-300 hover:bg-gray-50",children:h?"Close":"Go Back & Fix"}),!f&&!h&&e&&(0,b.jsx)("button",{onClick:e,className:"px-4 py-2 rounded-lg bg-amber-500 text-white hover:bg-amber-600",children:"Continue Anyway"})]})]})})}a.s([],64306),a.i(64306);let O={archetype:function(){let{draft:a,setArchetype:d,nextStep:e}=(0,f.useCharacterCreatorStore)(),[h,i]=(0,c.useState)(a.archetype?.type||null),[l,m]=(0,c.useState)(a.pow_abil||a.mart_abil||null),[n,o]=(0,c.useState)(a.mart_abil||null),p=a.archetype?.type!==void 0,q=h&&l&&("powered-martial"!==h||n);return p?(0,b.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Your Archetype"}),(0,b.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6 mb-6",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-green-800 mb-2",children:k[a.archetype.type].title}),(0,b.jsx)("p",{className:"text-green-700 mb-4",children:k[a.archetype.type].description}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[a.pow_abil&&(0,b.jsxs)("span",{className:"px-3 py-1 bg-purple-100 text-purple-700 rounded-full",children:["Power Ability: ",a.pow_abil.charAt(0).toUpperCase()+a.pow_abil.slice(1)]}),a.mart_abil&&(0,b.jsxs)("span",{className:"px-3 py-1 bg-red-100 text-red-700 rounded-full",children:["Martial Ability: ",a.mart_abil.charAt(0).toUpperCase()+a.mart_abil.slice(1)]})]})]}),(0,b.jsx)("button",{onClick:()=>{i(null),m(null),o(null),f.useCharacterCreatorStore.setState({draft:{...a,archetype:void 0,pow_abil:void 0,mart_abil:void 0}})},className:"text-gray-600 hover:text-gray-900 underline",children:"Choose a different archetype"})]}):(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Choose Your Archetype"}),(0,b.jsx)("p",{className:"text-gray-600 mb-6",children:"Your archetype defines your character's approach to combat and supernatural abilities."}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:Object.entries(k).map(([a,c])=>(0,b.jsxs)("button",{onClick:()=>{i(a),m(null),o(null)},className:(0,g.cn)("p-6 rounded-xl border-2 text-left transition-all",h===a?"border-primary-600 bg-primary-50 shadow-lg":"border-gray-200 bg-white hover:border-gray-300 hover:shadow"),children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:c.title}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:c.description})]},a))}),h&&(0,b.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6 mb-6",children:[(0,b.jsx)("h3",{className:"font-bold text-gray-900 mb-4",children:"powered-martial"===h?"Choose Your Power and Martial Abilities":`Choose Your ${"power"===h?"Power":"Martial"} Ability`}),"powered-martial"===h?(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-purple-700 mb-2",children:"Power Ability"}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-2",children:j.map(a=>(0,b.jsx)("button",{onClick:()=>m(a),disabled:n===a,className:(0,g.cn)("px-3 py-2 rounded-lg text-sm font-medium transition-colors",l===a?"bg-purple-600 text-white":n===a?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white border border-gray-200 hover:border-purple-400"),children:a.charAt(0).toUpperCase()+a.slice(1)},`power-${a}`))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-medium text-red-700 mb-2",children:"Martial Ability"}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-2",children:j.map(a=>(0,b.jsx)("button",{onClick:()=>o(a),disabled:l===a,className:(0,g.cn)("px-3 py-2 rounded-lg text-sm font-medium transition-colors",n===a?"bg-red-600 text-white":l===a?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white border border-gray-200 hover:border-red-400"),children:a.charAt(0).toUpperCase()+a.slice(1)},`martial-${a}`))})]})]}):(0,b.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:j.map(a=>(0,b.jsx)("button",{onClick:()=>m(a),className:(0,g.cn)("px-4 py-3 rounded-lg font-medium transition-colors",l===a?"power"===h?"bg-purple-600 text-white":"bg-red-600 text-white":"bg-white border border-gray-200 hover:border-gray-400"),children:a.charAt(0).toUpperCase()+a.slice(1)},a))})]}),(0,b.jsx)("button",{onClick:()=>{h&&l&&("powered-martial"!==h||n)&&(d(h,l,"powered-martial"===h?n:void 0),e())},disabled:!q,className:(0,g.cn)("w-full py-3 rounded-xl font-bold text-lg transition-colors",q?"bg-primary-600 text-white hover:bg-primary-700":"bg-gray-200 text-gray-400 cursor-not-allowed"),children:"Confirm Archetype"})]})},species:function(){let{draft:a,nextStep:d,prevStep:e,setSpecies:h}=(0,f.useCharacterCreatorStore)(),{data:i,isLoading:j}=(0,l.useSpecies)(),{data:k}=(0,l.useTraits)(),[m,n]=(0,c.useState)(null);return j?(0,b.jsx)("div",{className:"max-w-4xl mx-auto flex items-center justify-center py-12",children:(0,b.jsx)("div",{className:"w-8 h-8 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin"})}):(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Choose Your Species"}),(0,b.jsx)("p",{className:"text-gray-600 mb-6",children:"Your species defines your character's physical traits and inherent abilities."}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8",children:i?.map(c=>{var d;let e=a.ancestry?.id===c.id,f=m===c.id,i=(d=c.id,k?k.filter(a=>a.species?.includes(d)):[]);return(0,b.jsxs)("div",{className:(0,g.cn)("rounded-xl border-2 overflow-hidden transition-all",e?"border-primary-600 bg-primary-50":"border-gray-200 bg-white hover:border-gray-300"),children:[(0,b.jsxs)("button",{onClick:()=>{h(c.id,c.name)},className:"w-full p-4 text-left",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h3",{className:"font-bold text-gray-900",children:c.name}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-xs px-2 py-0.5 bg-gray-100 rounded capitalize",children:c.size}),(0,b.jsxs)("span",{className:"text-xs px-2 py-0.5 bg-gray-100 rounded",children:["Speed ",c.speed]})]})]}),(0,b.jsx)("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:c.description}),c.ability_bonuses&&Object.keys(c.ability_bonuses).length>0&&(0,b.jsx)("div",{className:"flex gap-1 mt-2",children:Object.entries(c.ability_bonuses).map(([a,c])=>(0,b.jsxs)("span",{className:"text-xs px-2 py-0.5 bg-green-100 text-green-700 rounded",children:[a.substring(0,3).toUpperCase()," +",c]},a))})]}),i.length>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:a=>{a.stopPropagation(),n(f?null:c.id)},className:"w-full px-4 py-2 text-sm text-primary-600 hover:bg-primary-50 border-t border-gray-200",children:f?"Hide Traits â–²":`Show ${i.length} Traits â–¼`}),f&&(0,b.jsx)("div",{className:"px-4 pb-4 border-t border-gray-200 bg-gray-50",children:(0,b.jsx)("div",{className:"space-y-2 mt-3",children:i.map(a=>(0,b.jsxs)("div",{className:"p-2 bg-white rounded border border-gray-100",children:[(0,b.jsx)("span",{className:"font-medium text-sm",children:a.name}),(0,b.jsx)("p",{className:"text-xs text-gray-600",children:a.description})]},a.id))})})]})]},c.id)})}),(!i||0===i.length)&&(0,b.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-6 mb-8",children:(0,b.jsx)("p",{className:"text-amber-700 text-center",children:"No species data available. Please check Firebase connection."})}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("button",{onClick:e,className:"px-6 py-3 rounded-xl font-medium text-gray-600 hover:bg-gray-100",children:"â† Back"}),(0,b.jsx)("button",{onClick:d,disabled:!a.ancestry?.id,className:(0,g.cn)("px-8 py-3 rounded-xl font-bold transition-colors",a.ancestry?.id?"bg-primary-600 text-white hover:bg-primary-700":"bg-gray-200 text-gray-400 cursor-not-allowed"),children:"Continue â†’"})]})]})},ancestry:function(){let{draft:a,nextStep:d,prevStep:e,setStep:g}=(0,f.useCharacterCreatorStore)(),{data:h}=(0,l.useSpecies)(),{data:i}=(0,l.useTraits)(),j=(0,c.useMemo)(()=>h&&a.ancestry?.id?h.find(b=>b.id===a.ancestry?.id):null,[h,a.ancestry?.id]),k=(0,c.useMemo)(()=>{if(!i||!j)return[];let a=i.filter(a=>a.species?.includes(j.id)||a.species?.includes(j.name)),b=j.traits?.map(a=>i.find(b=>b.name.toLowerCase()===a.toLowerCase()||b.id===a)).filter(Boolean)||[],c=[...a];return b.forEach(a=>{c.some(b=>b.id===a.id)||c.push(a)}),c},[i,j]);return j?(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Confirm Your Ancestry"}),(0,b.jsx)("p",{className:"text-gray-600 mb-6",children:"Review your species' traits and characteristics before continuing."}),(0,b.jsxs)("div",{className:"bg-gradient-to-br from-primary-50 to-white border-2 border-primary-200 rounded-xl p-6 mb-6",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-primary-900 mb-1",children:j.name}),(0,b.jsx)("p",{className:"text-gray-600 max-w-xl",children:j.description})]}),(0,b.jsx)("button",{onClick:()=>g("species"),className:"text-sm text-primary-600 hover:text-primary-800 underline",children:"Change Species"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 bg-white rounded-lg px-3 py-2 border border-gray-200",children:[(0,b.jsx)(o,{className:"w-5 h-5 text-gray-400"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-xs text-gray-500 block",children:"Size"}),(0,b.jsx)("span",{className:"font-medium capitalize",children:j.sizes?.join(", ")||j.size})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 bg-white rounded-lg px-3 py-2 border border-gray-200",children:[(0,b.jsx)(q.Zap,{className:"w-5 h-5 text-gray-400"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-xs text-gray-500 block",children:"Speed"}),(0,b.jsxs)("span",{className:"font-medium",children:[j.speed," sq"]})]})]}),j.ave_height&&(0,b.jsxs)("div",{className:"flex items-center gap-2 bg-white rounded-lg px-3 py-2 border border-gray-200",children:[(0,b.jsx)(m.User,{className:"w-5 h-5 text-gray-400"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-xs text-gray-500 block",children:"Avg Height"}),(0,b.jsxs)("span",{className:"font-medium",children:[j.ave_height," cm"]})]})]}),j.ave_weight&&(0,b.jsxs)("div",{className:"flex items-center gap-2 bg-white rounded-lg px-3 py-2 border border-gray-200",children:[(0,b.jsx)(p,{className:"w-5 h-5 text-gray-400"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-xs text-gray-500 block",children:"Avg Weight"}),(0,b.jsxs)("span",{className:"font-medium",children:[j.ave_weight," kg"]})]})]})]}),j.ability_bonuses&&Object.keys(j.ability_bonuses).length>0&&(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700 block mb-2",children:"Ability Bonuses"}),(0,b.jsx)("div",{className:"flex gap-2 flex-wrap",children:Object.entries(j.ability_bonuses).map(([a,c])=>(0,b.jsxs)("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[a.charAt(0).toUpperCase()+a.slice(1)," +",c]},a))})]})]}),(0,b.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl overflow-hidden mb-6",children:[(0,b.jsx)("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:(0,b.jsxs)("h3",{className:"font-bold text-gray-900 flex items-center gap-2",children:[(0,b.jsx)(r.Heart,{className:"w-5 h-5 text-primary-600"}),"Species Traits",(0,b.jsxs)("span",{className:"text-sm font-normal text-gray-500",children:["(",k.length," trait",1!==k.length?"s":"",")"]})]})}),(0,b.jsx)("div",{className:"divide-y divide-gray-100",children:k.length>0?k.map(a=>(0,b.jsxs)("div",{className:"px-4 py-3 hover:bg-gray-50",children:[(0,b.jsx)("h4",{className:"font-medium text-gray-900",children:a.name}),(0,b.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:a.description})]},a.id)):(0,b.jsx)("div",{className:"px-4 py-6 text-center text-gray-500",children:"No specific traits defined for this species."})})]}),(0,b.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-8",children:(0,b.jsxs)("p",{className:"text-blue-800 text-sm",children:[(0,b.jsx)("strong",{children:"Ready to continue?"})," These traits will be automatically applied to your character. You can change your species at any time by going back."]})}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("button",{onClick:e,className:"px-6 py-3 rounded-xl font-medium text-gray-600 hover:bg-gray-100",children:"â† Back"}),(0,b.jsx)("button",{onClick:d,className:"px-8 py-3 rounded-xl font-bold bg-primary-600 text-white hover:bg-primary-700 transition-colors",children:"Continue â†’"})]})]}):(0,b.jsxs)("div",{className:"max-w-2xl mx-auto text-center",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Confirm Your Ancestry"}),(0,b.jsx)("p",{className:"text-gray-600 mb-6",children:"Review your species' traits and characteristics."}),(0,b.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-6 mb-8",children:[(0,b.jsxs)("p",{className:"text-amber-700 mb-4",children:[(0,b.jsx)("strong",{children:"No species selected!"})," Please choose a species first."]}),(0,b.jsx)("button",{onClick:()=>g("species"),className:"px-6 py-2 rounded-lg bg-amber-600 text-white font-medium hover:bg-amber-700",children:"Go to Species Selection"})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("button",{onClick:e,className:"px-6 py-3 rounded-xl font-medium text-gray-600 hover:bg-gray-100",children:"â† Back"}),(0,b.jsx)("button",{disabled:!0,className:"px-8 py-3 rounded-xl font-bold bg-gray-200 text-gray-400 cursor-not-allowed",children:"Continue â†’"})]})]})},abilities:function(){let{draft:a,updateAbility:d,nextStep:e,prevStep:h}=(0,f.useCharacterCreatorStore)(),i=a.level||1,j=a.abilities||{strength:0,vitality:0,agility:0,acuity:0,intelligence:0,charisma:0},k=(0,c.useMemo)(()=>(0,s.calculateAbilityPoints)(i),[i]),l=(0,c.useMemo)(()=>v.reduce((a,b)=>{let c=j[b]||0,d=0;for(let a=1;a<=c;a++)d+=a>t.ABILITY_LIMITS.COST_INCREASE_THRESHOLD?2:1;return c<0&&(d=c),a+d},0),[j]),m=k-l,n=m>=0;return(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Assign Ability Scores"}),(0,b.jsx)("p",{className:"text-gray-600 mb-4",children:"Distribute your ability points. Higher scores cost more at higher values. You can reduce abilities below 0 to gain extra points."}),(0,b.jsxs)("div",{className:(0,g.cn)("flex items-center justify-center gap-4 p-4 rounded-xl mb-6",m>0?"bg-green-50 border border-green-200":m<0?"bg-red-50 border border-red-200":"bg-gray-50 border border-gray-200"),children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("span",{className:"text-sm text-gray-500",children:"Total Points"}),(0,b.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:k})]}),(0,b.jsx)("div",{className:"text-3xl text-gray-300",children:"âˆ’"}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("span",{className:"text-sm text-gray-500",children:"Spent"}),(0,b.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:l})]}),(0,b.jsx)("div",{className:"text-3xl text-gray-300",children:"="}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("span",{className:"text-sm text-gray-500",children:"Remaining"}),(0,b.jsx)("div",{className:(0,g.cn)("text-2xl font-bold",m>0?"text-green-600":m<0?"text-red-600":"text-gray-600"),children:m})]})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8",children:v.map(c=>{let e=j[c]||0,f=u[c],h=(0,s.getAbilityIncreaseCost)(e),i=a.pow_abil===c||a.mart_abil===c;return(0,b.jsxs)("div",{className:(0,g.cn)("p-4 rounded-xl border-2 bg-white",i?"border-amber-400":"border-gray-200"),children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-bold text-gray-900",children:f.name}),i&&(0,b.jsx)("span",{className:"text-xs text-amber-600 font-medium",children:"Archetype Ability"})]}),(0,b.jsxs)("span",{className:"text-xs text-gray-400",children:["â†’ ",f.defenseLink]})]}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mb-3",children:f.description}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("button",{onClick:()=>{let a;return a=j[c]||0,void((0,s.canDecreaseAbility)(a)&&d(c,a-1))},disabled:!(0,s.canDecreaseAbility)(e),className:(0,g.cn)("w-10 h-10 rounded-full flex items-center justify-center text-xl font-bold transition-colors",(0,s.canDecreaseAbility)(e)?"bg-gray-200 hover:bg-gray-300 text-gray-700":"bg-gray-100 text-gray-300 cursor-not-allowed"),children:"âˆ’"}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:(0,g.cn)("text-3xl font-bold",e>0?"text-green-600":e<0?"text-red-600":"text-gray-600"),children:e>=0?`+${e}`:e}),(0,b.jsxs)("div",{className:"text-xs text-gray-400",children:["Cost: ",h]})]}),(0,b.jsx)("button",{onClick:()=>{let a;return a=j[c]||0,void((0,s.getAbilityIncreaseCost)(a),(0,s.canIncreaseAbility)(a,m,!0)&&d(c,a+1))},disabled:!(0,s.canIncreaseAbility)(e,m,!0),className:(0,g.cn)("w-10 h-10 rounded-full flex items-center justify-center text-xl font-bold transition-colors",(0,s.canIncreaseAbility)(e,m,!0)?"bg-primary-600 hover:bg-primary-700 text-white":"bg-gray-100 text-gray-300 cursor-not-allowed"),children:"+"})]})]},c)})}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("button",{onClick:h,className:"px-6 py-3 rounded-xl font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-100 transition-colors",children:"â† Back"}),(0,b.jsx)("button",{onClick:e,disabled:!n,className:(0,g.cn)("px-8 py-3 rounded-xl font-bold transition-colors",n?"bg-primary-600 text-white hover:bg-primary-700":"bg-gray-200 text-gray-400 cursor-not-allowed"),children:"Continue â†’"})]})]})},skills:function(){let{draft:a,nextStep:d,prevStep:e,updateDraft:h}=(0,f.useCharacterCreatorStore)(),{data:i,isLoading:j}=(0,w.useRTDBSkills)(),[k,l]=(0,c.useState)(null),m=(0,s.calculateSkillPoints)(a.level||1),[n,o]=(0,c.useState)(()=>a.skills||{}),p=m-(0,c.useMemo)(()=>Object.values(n).reduce((a,b)=>a+b,0),[n]),q=(0,c.useMemo)(()=>{if(!i)return{};let a={};i.forEach(b=>{let c=b.ability||b.category||"General";a[c]||(a[c]=[]),a[c].push(b)});let b={};return x.forEach(c=>{a[c]&&(b[c]=a[c])}),Object.keys(a).filter(a=>!x.includes(a)).forEach(c=>{b[c]=a[c]}),b},[i]),r=(0,c.useCallback)((a,b)=>{o(c=>{let d=Math.max(0,(c[a]||0)+b);if(b>0&&p<=0)return c;if(0===d){let{[a]:b,...d}=c;return d}return{...c,[a]:d}})},[p]);return j?(0,b.jsx)("div",{className:"max-w-4xl mx-auto flex items-center justify-center py-12",children:(0,b.jsx)("div",{className:"w-8 h-8 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin"})}):(0,b.jsxs)("div",{className:"max-w-5xl mx-auto",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Allocate Skills"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Distribute your skill points to define your character's trained abilities."})]}),(0,b.jsxs)("div",{className:(0,g.cn)("px-4 py-2 rounded-xl font-bold text-lg",p>0?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"),children:[p," / ",m," Points"]})]}),(0,b.jsx)("div",{className:"space-y-4 mb-8",children:Object.entries(q).map(([a,c])=>{let d=c.reduce((a,b)=>a+(n[b.id]||0),0),e=k===a||null===k;return(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:[(0,b.jsxs)("button",{onClick:()=>l(k===a?null:a),className:"w-full px-4 py-3 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("h3",{className:"font-bold text-gray-900",children:a}),(0,b.jsxs)("span",{className:"text-sm text-gray-500",children:[c.length," skills"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[d>0&&(0,b.jsxs)("span",{className:"px-2 py-0.5 text-sm bg-primary-100 text-primary-700 rounded",children:[d," pts"]}),(0,b.jsx)("span",{className:(0,g.cn)("transition-transform",e&&"rotate-180"),children:"â–¼"})]})]}),e&&(0,b.jsx)("div",{className:"p-4 grid md:grid-cols-2 gap-3",children:c.map(a=>(0,b.jsx)(y,{skill:a,value:n[a.id]||0,onAllocate:b=>r(a.id,b),canIncrease:p>0},a.id))})]},a)})}),(!i||0===i.length)&&(0,b.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-6 mb-8",children:(0,b.jsx)("p",{className:"text-amber-700 text-center",children:"No skill data available. Please check Firebase connection."})}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("button",{onClick:e,className:"px-6 py-3 rounded-xl font-medium text-gray-600 hover:bg-gray-100",children:"â† Back"}),(0,b.jsx)("button",{onClick:()=>{h({skills:n}),d()},className:"px-8 py-3 rounded-xl font-bold bg-primary-600 text-white hover:bg-primary-700 transition-colors",children:"Continue â†’"})]})]})},feats:function(){let{draft:a,nextStep:d,prevStep:e,updateDraft:h}=(0,f.useCharacterCreatorStore)(),{data:i,isLoading:j}=(0,z.useRTDBFeats)(),[k,l]=(0,c.useState)(""),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(!0),[q,r]=(0,c.useState)(!0),[t,u]=(0,c.useState)(null),v=(0,s.calculateMaxCharacterFeats)(a.level||1),w=(0,c.useMemo)(()=>a.feats?.map(a=>a.id)||[],[a.feats]),x=(0,c.useMemo)(()=>{if(!i)return[];let a=new Set;return i.forEach(b=>b.category&&a.add(b.category)),Array.from(a).sort()},[i]),y=(0,c.useMemo)(()=>i?i.filter(b=>{if(k){let a=k.toLowerCase();if(!(b.name.toLowerCase().includes(a)||b.description?.toLowerCase().includes(a)||b.tags.some(b=>b.toLowerCase().includes(a))))return!1}return(!!o||!!b.char_feat)&&(!!q||!b.char_feat)&&(!m||b.category===m)&&!(b.lvl_req>(a.level||1))}):[],[i,k,o,q,m,a.level]),A=b=>{if(w.includes(b.id))h({feats:a.feats?.filter(a=>a.id!==b.id)||[]});else{if(w.length>=v)return;h({feats:[...a.feats||[],{id:b.id,name:b.name,description:b.description,type:b.char_feat?"character":"archetype"}]})}};return j?(0,b.jsx)("div",{className:"max-w-5xl mx-auto flex items-center justify-center py-12",children:(0,b.jsx)("div",{className:"w-8 h-8 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin"})}):(0,b.jsxs)("div",{className:"max-w-5xl mx-auto",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Select Feats"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Choose feats that grant special abilities and bonuses."})]}),(0,b.jsxs)("div",{className:(0,g.cn)("px-4 py-2 rounded-xl font-bold text-lg",w.length<v?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"),children:[w.length," / ",v," Feats"]})]}),w.length>0&&(0,b.jsxs)("div",{className:"bg-primary-50 rounded-xl p-4 mb-6",children:[(0,b.jsx)("h3",{className:"font-medium text-primary-800 mb-2",children:"Selected Feats"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:a.feats?.map(a=>(0,b.jsxs)("span",{className:"px-3 py-1 bg-white text-primary-700 rounded-full text-sm flex items-center gap-2",children:[a.name,(0,b.jsx)("button",{onClick:()=>A({id:a.id,name:a.name}),className:"hover:text-red-500",children:"Ã—"})]},a.id))})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl p-4 mb-6 shadow-sm flex flex-wrap gap-4 items-center",children:[(0,b.jsx)("input",{type:"text",value:k,onChange:a=>l(a.target.value),placeholder:"Search feats...",className:"flex-1 min-w-[200px] px-3 py-2 border border-gray-300 rounded-lg"}),(0,b.jsxs)("select",{value:m,onChange:a=>n(a.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg",children:[(0,b.jsx)("option",{value:"",children:"All Categories"}),x.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]}),(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:o,onChange:a=>p(a.target.checked),className:"w-4 h-4 rounded text-primary-600"}),(0,b.jsx)("span",{className:"text-sm",children:"Archetype"})]}),(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:q,onChange:a=>r(a.target.checked),className:"w-4 h-4 rounded text-primary-600"}),(0,b.jsx)("span",{className:"text-sm",children:"Character"})]})]}),(0,b.jsxs)("div",{className:"space-y-2 mb-8 max-h-[500px] overflow-y-auto",children:[y.map(c=>{let d=w.includes(c.id),e=t===c.id,f=(b=>{let c=a.abilities||{};for(let a=0;a<b.ability_req.length;a++){let d=b.ability_req[a].toLowerCase(),e=b.abil_req_val[a]||0;if((c[d]||0)<e)return{met:!1,reason:`Requires ${b.ability_req[a]} ${e}+`}}return{met:!0}})(c),h=w.length<v||d;return(0,b.jsxs)("div",{className:(0,g.cn)("bg-white rounded-lg border overflow-hidden transition-all",d?"border-primary-400 bg-primary-50":"border-gray-200",!f.met&&"opacity-60"),children:[(0,b.jsxs)("div",{className:"p-3 flex items-center gap-3",children:[(0,b.jsx)("button",{onClick:()=>f.met&&h&&A(c),disabled:!f.met||!h,className:(0,g.cn)("w-6 h-6 rounded border-2 flex items-center justify-center flex-shrink-0",d?"bg-primary-600 border-primary-600 text-white":f.met&&h?"border-gray-300 hover:border-primary-400":"border-gray-200 bg-gray-100 cursor-not-allowed"),children:d&&"âœ“"}),(0,b.jsx)("div",{className:"flex-1 min-w-0",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,b.jsx)("span",{className:"font-medium text-gray-900",children:c.name}),c.char_feat&&(0,b.jsx)("span",{className:"px-1.5 py-0.5 text-xs bg-blue-100 text-blue-700 rounded",children:"Character"}),c.category&&(0,b.jsx)("span",{className:"px-1.5 py-0.5 text-xs bg-gray-100 text-gray-600 rounded",children:c.category}),!f.met&&(0,b.jsx)("span",{className:"px-1.5 py-0.5 text-xs bg-red-100 text-red-600 rounded",children:f.reason})]})}),(0,b.jsx)("button",{onClick:()=>u(e?null:c.id),className:"text-gray-400 hover:text-gray-600",children:e?"â–²":"â–¼"})]}),e&&(0,b.jsxs)("div",{className:"px-3 pb-3 pt-2 border-t border-gray-100",children:[(0,b.jsx)("p",{className:"text-sm text-gray-700",children:c.description}),c.tags.length>0&&(0,b.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:c.tags.map(a=>(0,b.jsx)("span",{className:"px-1.5 py-0.5 text-xs bg-primary-50 text-primary-700 rounded",children:a},a))})]})]},c.id)}),0===y.length&&(0,b.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No feats match your filters."})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("button",{onClick:e,className:"px-6 py-3 rounded-xl font-medium text-gray-600 hover:bg-gray-100",children:"â† Back"}),(0,b.jsx)("button",{onClick:d,className:"px-8 py-3 rounded-xl font-bold bg-primary-600 text-white hover:bg-primary-700 transition-colors",children:"Continue â†’"})]})]})},equipment:function(){let{draft:a,nextStep:d,prevStep:e,updateDraft:h}=(0,f.useCharacterCreatorStore)(),{data:i,isLoading:j}=(0,l.useEquipment)(),[k,m]=(0,c.useState)("weapon"),[n,o]=(0,c.useState)(""),p=(0,c.useMemo)(()=>Math.max(...Object.values(a.abilities||{}).filter(a=>"number"==typeof a),0),[a.abilities]),q=10*(0,s.calculateTrainingPoints)(a.level||1,p),r=(0,c.useMemo)(()=>(a.equipment?.inventory||[]).map(a=>({id:String(a.id),name:a.name,type:"equipment",cost:a.cost||0,damage:a.damage,armor:a.armor,properties:Array.isArray(a.properties)?a.properties.map(a=>"string"==typeof a?a:a.name):[]})),[a.equipment?.inventory]),t=q-(0,c.useMemo)(()=>r.reduce((a,b)=>a+(b.cost||0),0),[r]),u=(0,c.useMemo)(()=>i?i.filter(a=>{if(a.type!==k)return!1;if(n){let b=n.toLowerCase();if(!a.name.toLowerCase().includes(b)&&!a.description?.toLowerCase().includes(b))return!1}return!0}):[],[i,k,n]),v=b=>{let c=r.some(a=>a.id===b.id),d=a.equipment?.inventory||[];if(c)h({equipment:{...a.equipment,inventory:d.filter(a=>String(a.id)!==b.id)}});else{if(b.gold_cost>t)return;let c={id:b.id,name:b.name,cost:b.gold_cost,damage:b.damage,armor:b.armor_value,properties:b.properties};h({equipment:{...a.equipment,inventory:[...d,c]}})}};return j?(0,b.jsx)("div",{className:"max-w-5xl mx-auto flex items-center justify-center py-12",children:(0,b.jsx)("div",{className:"w-8 h-8 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin"})}):(0,b.jsxs)("div",{className:"max-w-5xl mx-auto",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Choose Equipment"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Select your starting weapons, armor, and gear."})]}),(0,b.jsxs)("div",{className:(0,g.cn)("px-4 py-2 rounded-xl font-bold text-lg",t>0?"bg-amber-100 text-amber-700":"bg-red-100 text-red-700"),children:[t," / ",q," Gold"]})]}),r.length>0&&(0,b.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[(0,b.jsx)("h3",{className:"font-medium text-gray-800 mb-2",children:"Selected Equipment"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:r.map(a=>(0,b.jsxs)("span",{className:"px-3 py-1 bg-white border border-gray-200 rounded-full text-sm flex items-center gap-2",children:[a.name,(0,b.jsxs)("span",{className:"text-amber-600 text-xs",children:[a.cost,"g"]}),(0,b.jsx)("button",{onClick:()=>v({id:a.id,name:a.name,gold_cost:a.cost,type:"equipment",properties:[],description:""}),className:"hover:text-red-500",children:"Ã—"})]},a.id))})]}),(0,b.jsx)("div",{className:"flex gap-2 mb-4",children:["weapon","armor","equipment"].map(a=>(0,b.jsxs)("button",{onClick:()=>m(a),className:(0,g.cn)("px-4 py-2 rounded-lg font-medium capitalize transition-colors",k===a?"bg-primary-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:[a,"s"]},a))}),(0,b.jsx)("input",{type:"text",value:n,onChange:a=>o(a.target.value),placeholder:`Search ${k}s...`,className:"w-full px-4 py-2 border border-gray-300 rounded-lg mb-4"}),(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-3 mb-8 max-h-[400px] overflow-y-auto",children:[u.map(a=>{let c=r.some(b=>b.id===a.id),d=a.gold_cost<=t||c;return(0,b.jsxs)("button",{onClick:()=>d&&v(a),disabled:!d,className:(0,g.cn)("p-4 rounded-lg border text-left transition-all",c?"border-primary-400 bg-primary-50":d?"border-gray-200 bg-white hover:border-gray-300":"border-gray-200 bg-gray-100 opacity-60 cursor-not-allowed"),children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[c&&(0,b.jsx)("span",{className:"w-5 h-5 rounded-full bg-primary-600 text-white text-xs flex items-center justify-center",children:"âœ“"}),(0,b.jsx)("span",{className:"font-medium text-gray-900",children:a.name})]}),(0,b.jsxs)("span",{className:(0,g.cn)("font-bold",d?"text-amber-600":"text-red-500"),children:[a.gold_cost,"g"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2",children:[a.damage&&(0,b.jsx)("span",{className:"px-2 py-0.5 bg-red-50 text-red-700 rounded",children:a.damage}),a.armor_value&&(0,b.jsxs)("span",{className:"px-2 py-0.5 bg-blue-50 text-blue-700 rounded",children:["+",a.armor_value," Armor"]})]}),a.description&&(0,b.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:a.description}),a.properties.length>0&&(0,b.jsxs)("div",{className:"flex flex-wrap gap-1 mt-2",children:[a.properties.slice(0,3).map(a=>(0,b.jsx)("span",{className:"px-1.5 py-0.5 text-xs bg-gray-100 rounded",children:a},a)),a.properties.length>3&&(0,b.jsxs)("span",{className:"text-xs text-gray-400",children:["+",a.properties.length-3," more"]})]})]},a.id)}),0===u.length&&(0,b.jsxs)("div",{className:"col-span-2 text-center py-8 text-gray-500",children:["No ",k,"s found."]})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("button",{onClick:e,className:"px-6 py-3 rounded-xl font-medium text-gray-600 hover:bg-gray-100",children:"â† Back"}),(0,b.jsx)("button",{onClick:d,className:"px-8 py-3 rounded-xl font-bold bg-primary-600 text-white hover:bg-primary-700 transition-colors",children:"Continue â†’"})]})]})},powers:function(){let{draft:a,updateDraft:d,nextStep:e,prevStep:g}=(0,f.useCharacterCreatorStore)(),[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)(!1),{data:m=[],isLoading:n}=(0,I.useUserPowers)(),{data:o=[],isLoading:p}=(0,I.useUserTechniques)(),{data:q}=(0,l.usePowerParts)(),{data:r}=(0,l.useTechniqueParts)(),s=a.powers||[],t=a.techniques||[],u=(0,c.useMemo)(()=>new Set(s.map(a=>String(a.id))),[s]),v=(0,c.useMemo)(()=>new Set(t.map(a=>String(a.id))),[t]),w=(0,c.useMemo)(()=>m.map(a=>{let b=a.damage?.[0];return(0,H.transformPower)({id:a.docId,name:a.name,description:a.description,parts:a.parts?.map(a=>String(a.name||a.id))||[],damage:b?`${b.amount}d${b.size}${b.type?` ${b.type}`:""}`:void 0})}),[m]),x=(0,c.useMemo)(()=>o.map(a=>{let b=a.damage?.[0];return(0,H.transformTechnique)({id:a.docId,name:a.name,description:a.description,parts:a.parts?.map(a=>String(a.name||a.id))||[],damage:b?`${b.amount}d${b.size}${b.type?` ${b.type}`:""}`:void 0})}),[o]),y=(0,c.useMemo)(()=>w.filter(a=>u.has(a.id)),[w,u]),z=(0,c.useMemo)(()=>x.filter(a=>v.has(a.id)),[x,v]),L=(0,c.useCallback)(a=>{d({powers:a.map(a=>({id:a.id,name:a.name}))}),i(!1)},[d]),M=(0,c.useCallback)(a=>{d({techniques:a.map(a=>({id:a.id,name:a.name}))}),k(!1)},[d]),N=(0,c.useCallback)(a=>{d({powers:s.filter(b=>String(b.id)!==a)})},[s,d]),O=(0,c.useCallback)(a=>{d({techniques:t.filter(b=>String(b.id)!==a)})},[t,d]),P=m.length>0||o.length>0;return(0,b.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,b.jsxs)("div",{className:"text-center mb-8",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-foreground mb-2",children:"Powers & Techniques"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Select powers and techniques from your library for your character to know."})]}),!n&&!p&&!P&&(0,b.jsxs)("div",{className:"bg-muted/30 border border-border rounded-xl p-8 text-center mb-8",children:[(0,b.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-muted flex items-center justify-center",children:(0,b.jsx)(C.Wand2,{className:"w-8 h-8 text-muted-foreground"})}),(0,b.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No Powers or Techniques Yet"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Create powers and techniques in your library first, then come back to add them to your character."}),(0,b.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,b.jsxs)(A.default,{href:"/power-creator",className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-primary text-primary-foreground hover:bg-primary/90 transition-colors",children:[(0,b.jsx)(B.Plus,{className:"w-4 h-4"}),"Create Power",(0,b.jsx)(F,{className:"w-3 h-3"})]}),(0,b.jsxs)(A.default,{href:"/technique-creator",className:"flex items-center gap-2 px-4 py-2 rounded-lg border border-border text-foreground hover:bg-muted transition-colors",children:[(0,b.jsx)(B.Plus,{className:"w-4 h-4"}),"Create Technique",(0,b.jsx)(F,{className:"w-3 h-3"})]})]})]}),(P||n)&&(0,b.jsxs)("section",{className:"mb-8",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-lg bg-primary/10 flex items-center justify-center",children:(0,b.jsx)(C.Wand2,{className:"w-5 h-5 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:"Powers"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[s.length," power",1!==s.length?"s":""," selected"]})]})]}),(0,b.jsxs)("button",{onClick:()=>i(!0),disabled:0===m.length,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-primary text-primary-foreground hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,b.jsx)(B.Plus,{className:"w-4 h-4"}),"Add Powers"]})]}),y.length>0?(0,b.jsx)("div",{className:"space-y-2",children:y.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border border-border bg-card",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(C.Wand2,{className:"w-4 h-4 text-primary"}),(0,b.jsx)("span",{className:"font-medium text-foreground",children:a.name}),void 0!==a.cost&&(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:[a.cost," ",a.costLabel]})]}),(0,b.jsx)("button",{onClick:()=>N(a.id),className:"p-1 rounded hover:bg-destructive/10 text-destructive transition-colors",title:"Remove power",children:(0,b.jsx)(E.X,{className:"w-4 h-4"})})]},a.id))}):m.length>0?(0,b.jsx)("div",{className:"p-4 rounded-lg border border-dashed border-border text-center text-muted-foreground",children:'No powers selected. Click "Add Powers" to choose from your library.'}):(0,b.jsxs)("div",{className:"p-4 rounded-lg border border-dashed border-border text-center",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"No powers in your library. "}),(0,b.jsxs)(A.default,{href:"/power-creator",className:"text-primary hover:underline inline-flex items-center gap-1",children:["Create one ",(0,b.jsx)(F,{className:"w-3 h-3"})]})]})]}),(P||p)&&(0,b.jsxs)("section",{className:"mb-8",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-lg bg-orange-500/10 flex items-center justify-center",children:(0,b.jsx)(D.Swords,{className:"w-5 h-5 text-orange-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:"Techniques"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[t.length," technique",1!==t.length?"s":""," selected"]})]})]}),(0,b.jsxs)("button",{onClick:()=>k(!0),disabled:0===o.length,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-orange-500 text-white hover:bg-orange-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,b.jsx)(B.Plus,{className:"w-4 h-4"}),"Add Techniques"]})]}),z.length>0?(0,b.jsx)("div",{className:"space-y-2",children:z.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border border-border bg-card",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(D.Swords,{className:"w-4 h-4 text-orange-500"}),(0,b.jsx)("span",{className:"font-medium text-foreground",children:a.name}),void 0!==a.cost&&(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:[a.cost," ",a.costLabel]})]}),(0,b.jsx)("button",{onClick:()=>O(a.id),className:"p-1 rounded hover:bg-destructive/10 text-destructive transition-colors",title:"Remove technique",children:(0,b.jsx)(E.X,{className:"w-4 h-4"})})]},a.id))}):o.length>0?(0,b.jsx)("div",{className:"p-4 rounded-lg border border-dashed border-border text-center text-muted-foreground",children:'No techniques selected. Click "Add Techniques" to choose from your library.'}):(0,b.jsxs)("div",{className:"p-4 rounded-lg border border-dashed border-border text-center",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"No techniques in your library. "}),(0,b.jsxs)(A.default,{href:"/technique-creator",className:"text-primary hover:underline inline-flex items-center gap-1",children:["Create one ",(0,b.jsx)(F,{className:"w-3 h-3"})]})]})]}),(0,b.jsxs)("div",{className:"flex justify-between pt-6 border-t border-border",children:[(0,b.jsx)("button",{onClick:g,className:"px-6 py-3 rounded-xl font-medium text-muted-foreground hover:bg-muted transition-colors",children:"â† Back"}),(0,b.jsx)("button",{onClick:e,className:"px-8 py-3 rounded-xl font-bold bg-primary text-primary-foreground hover:bg-primary/90 transition-colors",children:"Continue â†’"})]}),(0,b.jsx)(G.ItemSelectionModal,{isOpen:h,onClose:()=>i(!1),onConfirm:L,items:w,title:"Select Powers",description:"Choose powers from your library for your character to know.",initialSelectedIds:u,sortOptions:J,searchPlaceholder:"Search powers...",loading:n}),(0,b.jsx)(G.ItemSelectionModal,{isOpen:j,onClose:()=>k(!1),onConfirm:M,items:x,title:"Select Techniques",description:"Choose techniques from your library for your character to know.",initialSelectedIds:v,sortOptions:K,searchPlaceholder:"Search techniques...",loading:p})]})},finalize:function(){let a=(0,d.useRouter)(),{user:h}=(0,e.useAuth)(),{draft:i,updateDraft:j,getCharacter:k,resetCreator:l,prevStep:m}=(0,f.useCharacterCreatorStore)(),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)(null),[r,t]=(0,c.useState)(!1),u=(0,c.useMemo)(()=>{let a=[],b=i.level||1;i.name?.trim()||a.push({emoji:"ðŸ“",message:"Your hero needs a name! Give them something legendary.",severity:"error"}),i.archetype?.type||a.push({emoji:"ðŸŽ­",message:"You haven't selected an archetype yet! Head back to the Archetype tab.",severity:"error"}),i.ancestry?.id||a.push({emoji:"ðŸŒŸ",message:"You need to choose your species! Head to the Species tab.",severity:"error"});let c=(0,s.calculateAbilityPoints)(b)-(i.abilities?Object.values(i.abilities).reduce((a,b)=>b<=0?a:b<=3?a+b:a+3+(b-3)*2,0):0);c>0?a.push({emoji:"âš¡",message:`You still have ${c} ability point${1===c?"":"s"} to spend!`,severity:"warning"}):c<0&&a.push({emoji:"âš¡",message:`You've overspent ability points by ${Math.abs(c)}!`,severity:"error"});let d=(0,s.calculateSkillPoints)(b)-((i.skills?Object.values(i.skills).reduce((a,b)=>a+(b||0),0):0)+(i.defenseSkills?Object.values(i.defenseSkills).reduce((a,b)=>a+2*(b||0),0):0));d>0?a.push({emoji:"ðŸ“š",message:`You have ${d} skill point${1===d?"":"s"} left to spend!`,severity:"warning"}):d<0&&a.push({emoji:"ðŸ“š",message:`You've overspent skill points by ${Math.abs(d)}!`,severity:"error"});let e=(0,s.calculateHealthEnergyPool)(b,"PLAYER")-((i.healthPoints||0)+(i.energyPoints||0));e>0&&a.push({emoji:"â¤ï¸",message:`You have ${e} Health-Energy point${1===e?"":"s"} to allocate!`,severity:"warning"});let f=i.abilities?Math.max(...Object.values(i.abilities).filter(a=>"number"==typeof a)):0,g=(0,s.calculateTrainingPoints)(b,f)-(i.trainingPointsSpent||0);g<0&&a.push({emoji:"ðŸŽ¯",message:`You've overspent training points by ${Math.abs(g)}!`,severity:"error"});let h=(i.equipment?.items||[]).reduce((a,b)=>a+(b.cost||0),0);h>200&&a.push({emoji:"ðŸ’°",message:`You've overspent currency by ${h-200}gp!`,severity:"error"});let j=i.archetype?.type,k=i.archetypeFeats||[],l=0;if("power"===j?l=1:"powered-martial"===j?l=2:"martial"===j&&(l=3),k.length<l){let b=l-k.length;a.push({emoji:"ðŸ’ª",message:`You need to select ${b} more archetype feat${1===b?"":"s"}!`,severity:"warning"})}return(i.feats||[]).length<1&&a.push({emoji:"ðŸŒ ",message:"You need to select a character feat!",severity:"warning"}),a},[i]),v=async()=>{if(!h)return void q("You must be logged in to save a character");if(!i.name?.trim())return void q("Please enter a character name");try{o(!0),q(null),t(!1);let b=k(),c=await (0,L.addDoc)((0,L.collection)(M.db,"users",h.uid,"character"),{...b,userId:h.uid,createdAt:L.Timestamp.now(),updatedAt:L.Timestamp.now()});l(),a.push(`/characters/${c.id}`)}catch(a){console.error("Error saving character:",a),q("Failed to save character. Please try again.")}finally{o(!1)}};return(0,b.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Finalize Your Character"}),(0,b.jsx)("p",{className:"text-gray-600 mb-6",children:"Add the final details to bring your character to life."}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Character Name *"}),(0,b.jsx)("input",{type:"text",value:i.name||"",onChange:a=>j({name:a.target.value}),placeholder:"Enter your character's name",className:"w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-primary-500 focus:ring-2 focus:ring-primary-200 transition-colors"})]}),(0,b.jsxs)("div",{className:"bg-gray-50 rounded-xl p-6 mb-6",children:[(0,b.jsx)("h3",{className:"font-bold text-gray-900 mb-4",children:"Character Summary"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Level:"}),(0,b.jsx)("span",{className:"ml-2 font-medium",children:i.level||1})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Archetype:"}),(0,b.jsx)("span",{className:"ml-2 font-medium",children:i.archetype?.type?i.archetype.type.charAt(0).toUpperCase()+i.archetype.type.slice(1):"Not selected"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Species:"}),(0,b.jsx)("span",{className:"ml-2 font-medium",children:i.ancestry?.name||"Not selected"})]}),i.pow_abil&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Power Ability:"}),(0,b.jsx)("span",{className:"ml-2 font-medium capitalize",children:i.pow_abil})]}),i.mart_abil&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Martial Ability:"}),(0,b.jsx)("span",{className:"ml-2 font-medium capitalize",children:i.mart_abil})]})]}),i.abilities&&(0,b.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[(0,b.jsx)("span",{className:"text-gray-500 text-sm",children:"Abilities:"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:Object.entries(i.abilities).map(([a,c])=>(0,b.jsxs)("span",{className:(0,g.cn)("px-2 py-1 rounded text-sm font-medium",c>0?"bg-green-100 text-green-700":c<0?"bg-red-100 text-red-700":"bg-gray-100 text-gray-600"),children:[a.charAt(0).toUpperCase(),": ",c>=0?`+${c}`:c]},a))})]})]}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description (Optional)"}),(0,b.jsx)("textarea",{value:i.description||"",onChange:a=>j({description:a.target.value}),placeholder:"Describe your character's appearance, personality, or background...",rows:4,className:"w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-primary-500 focus:ring-2 focus:ring-primary-200 transition-colors resize-none"})]}),(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),(0,b.jsx)("textarea",{value:i.notes||"",onChange:a=>j({notes:a.target.value}),placeholder:"Any additional notes about your character...",rows:3,className:"w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-primary-500 focus:ring-2 focus:ring-primary-200 transition-colors resize-none"})]}),p&&(0,b.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl text-red-700",children:p}),u.length>0&&(0,b.jsxs)("div",{className:(0,g.cn)("mb-6 p-4 rounded-xl",u.some(a=>"error"===a.severity)?"bg-red-50 border border-red-200":"bg-amber-50 border border-amber-200"),children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("span",{className:"text-xl",children:u.some(a=>"error"===a.severity)?"âš ï¸":"ðŸ“‹"}),(0,b.jsxs)("span",{className:"font-medium",children:[u.filter(a=>"error"===a.severity).length," error",1!==u.filter(a=>"error"===a.severity).length?"s":"",","," ",u.filter(a=>"warning"===a.severity).length," warning",1!==u.filter(a=>"warning"===a.severity).length?"s":""]})]}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:'Click "Review & Create" to see all issues before saving.'})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("button",{onClick:m,disabled:n,className:"px-6 py-3 rounded-xl font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-100 transition-colors disabled:opacity-50",children:"â† Back"}),(0,b.jsx)("button",{onClick:()=>{t(!0)},disabled:n,className:(0,g.cn)("px-8 py-3 rounded-xl font-bold transition-colors flex items-center gap-2",n?"bg-gray-200 text-gray-400 cursor-not-allowed":u.some(a=>"error"===a.severity)?"bg-amber-500 text-white hover:bg-amber-600":"bg-green-600 text-white hover:bg-green-700"),children:n?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):u.length>0?(0,b.jsx)(b.Fragment,{children:"ðŸ“‹ Review & Create"}):(0,b.jsx)(b.Fragment,{children:"âœ“ Create Character"})})]}),(0,b.jsx)(N,{isOpen:r,onClose:()=>t(!1),issues:u,onContinueAnyway:u.every(a=>"error"!==a.severity)?v:void 0})]})}};function P(){let a=(0,d.useRouter)(),{user:g,loading:h}=(0,e.useAuth)(),{currentStep:j}=(0,f.useCharacterCreatorStore)();if((0,c.useEffect)(()=>{h||g||a.push("/login?redirect=/characters/new")},[h,g,a]),h)return(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 border-4 border-primary-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})});if(!g)return null;let k=O[j];return(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 py-6",children:(0,b.jsxs)("div",{className:"max-w-6xl mx-auto px-4",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Create New Character"}),(0,b.jsx)("p",{className:"text-gray-600 mt-1",children:"Follow the steps below to build your character"})]}),(0,b.jsx)(i,{}),(0,b.jsx)("div",{className:"bg-white rounded-xl shadow-md p-6 md:p-8",children:(0,b.jsx)(k,{})})]})})}a.s(["default",()=>P],64070)}];

//# sourceMappingURL=src_app_%28main%29_characters_new_page_tsx_40a967c5._.js.map