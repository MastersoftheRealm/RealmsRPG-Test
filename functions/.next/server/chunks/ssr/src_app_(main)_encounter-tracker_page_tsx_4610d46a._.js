module.exports=[69597,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(72500);var d=a.i(18239);a.i(76564);var e=a.i(20930);let f=(0,a.i(60137).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),g="realms-encounter-tracker",h=[{name:"Bleeding",decaying:!0,description:"Bleeding creatures lose 1 Hit Point for each level of bleeding at the beginning of their turn. Any healing received reduces the bleeding condition by the amount healed."},{name:"Blinded",decaying:!1,description:"All targets are considered completely obscured to a blinded creature that relies on basic vision. Acuity Skill rolls that rely on sight automatically fail."},{name:"Charmed",decaying:!1,description:"Charmed creatures can't attack or perform harmful Actions against the creature that charmed them. All Charisma rolls and potencies against this target from the charmer gain +2."},{name:"Dazed",decaying:!1,description:"Dazed creatures cannot take Reactions."},{name:"Deafened",decaying:!1,description:"You cannot hear anything in the world around you. You have resistance to sonic damage. Acuity Skill rolls that rely on hearing automatically fail."},{name:"Dying",decaying:!1,description:"When your Hit Point total is reduced to zero or a negative value, you enter the dying condition. Each turn, at the beginning of your turn, you take 1d4 irreducible damage, doubling each turn."},{name:"Exhausted",decaying:!1,description:"Exhaustion reduces all bonuses and Evasion by an amount equal to its level. At level 10, the character dies."},{name:"Exposed",decaying:!0,description:"Exposed creatures decrease their Evasion by 1 for each level of Exposed."},{name:"Faint",decaying:!1,description:"You have -1 to Evasion, Might, Reflex, and on all D20 rolls requiring balance or poise."},{name:"Frightened",decaying:!1,description:"Frightened creatures have -2 on all scores and D20 rolls against the source of their fear."},{name:"Grappled",decaying:!1,description:"Grappled targets have -2 to attack rolls, are +2 to hit, and cannot take movement Actions."},{name:"Hidden",decaying:!1,description:"While hidden, you have a +2 bonus on attack rolls made against creatures unaware of your location."},{name:"Immobile",decaying:!1,description:"Immobile creatures cannot take Movement Actions, and their Speed is considered 0."},{name:"Invisible",decaying:!1,description:"You are considered completely obscured to all creatures relying on basic vision."},{name:"Prone",decaying:!1,description:"While prone, your movement speed is reduced by ½. You are +2 to hit by others and have -2 to hit others."},{name:"Resilient",decaying:!0,description:"Resilient creatures take 1 less damage each time they are damaged per Resilient level."},{name:"Slowed",decaying:!0,description:"Slowed creatures lose 1 or more movement speed depending on the level of Slowed."},{name:"Stunned",decaying:!0,description:"Stunned creatures lose 1 or more Action Points based on the level of Stun."},{name:"Susceptible",decaying:!0,description:"Susceptible creatures take 1 extra damage each time they are damaged per Susceptible level."},{name:"Terminal",decaying:!1,description:"Your current health is at or below ¼ of your maximum health, placing you in the Terminal Range."},{name:"Weakened",decaying:!0,description:"Weakened creatures decrease all D20 rolls by 1 or more depending on the level of Weakened."}].sort((a,b)=>a.name.localeCompare(b.name));function i(){let[a,e]=(0,c.useState)(!1),[i,k]=(0,c.useState)({name:"New Encounter",combatants:[],round:0,currentTurnIndex:-1,isActive:!1,applySurprise:!1});(0,c.useEffect)(()=>{try{let a=localStorage.getItem(g);if(a){let b=JSON.parse(a);k(b)}}catch(a){console.error("Failed to load encounter:",a)}e(!0)},[]),(0,c.useEffect)(()=>{if(a)try{localStorage.setItem(g,JSON.stringify(i))}catch(a){console.error("Failed to save encounter:",a)}},[i,a]);let[l,m]=(0,c.useState)({name:"",initiative:0,acuity:0,maxHealth:20,maxEnergy:10,armor:0,evasion:10,isAlly:!0,isSurprised:!1}),n=(0,c.useMemo)(()=>[...i.combatants].sort((a,b)=>{if(1===i.round&&i.applySurprise){if(a.isSurprised&&!b.isSurprised)return 1;if(!a.isSurprised&&b.isSurprised)return -1}return b.initiative!==a.initiative?b.initiative-a.initiative:b.acuity-a.acuity}),[i.combatants,i.round,i.applySurprise]),o=(a,b)=>{k(c=>({...c,combatants:c.combatants.map(c=>c.id===a?{...c,...b}:c)}))},p=(0,c.useCallback)((a,b)=>{o(a,{currentHealth:Math.max(0,i.combatants.find(b=>b.id===a).currentHealth-b)})},[i.combatants]),q=(0,c.useCallback)((a,b)=>{let c=i.combatants.find(b=>b.id===a);o(a,{currentHealth:Math.min(c.maxHealth,c.currentHealth+b)})},[i.combatants]);return(i.isActive&&n[i.currentTurnIndex],a)?(0,b.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Encounter Tracker"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Manage combat encounters, track initiative, and monitor combatant status."}),(0,b.jsxs)("p",{className:"text-xs text-green-600 mt-1 flex items-center gap-1",children:[(0,b.jsx)(f,{className:"w-3 h-3"}),"Auto-saved to browser"]})]}),(0,b.jsx)("div",{className:"flex items-center gap-2 text-lg",children:i.isActive&&(0,b.jsxs)("div",{className:"px-4 py-2 bg-red-100 text-red-800 rounded-lg font-bold",children:["Round ",i.round]})})]}),(0,b.jsxs)("div",{className:"grid lg:grid-cols-4 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-3 space-y-4",children:[(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-4 flex flex-wrap items-center gap-4",children:[i.isActive?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>{k(a=>0===a.currentTurnIndex&&1===a.round?a:0===a.currentTurnIndex?{...a,round:a.round-1,currentTurnIndex:n.length-1}:{...a,currentTurnIndex:a.currentTurnIndex-1})},className:"px-4 py-2 rounded-lg bg-gray-200 hover:bg-gray-300",children:"← Previous"}),(0,b.jsx)("button",{onClick:()=>{k(a=>{let b=a.currentTurnIndex+1;return b>=n.length?{...a,round:a.round+1,currentTurnIndex:0}:{...a,currentTurnIndex:b}})},className:"px-6 py-2 rounded-lg font-bold bg-primary-600 text-white hover:bg-primary-700",children:"Next Turn →"}),(0,b.jsx)("button",{onClick:()=>{k(a=>({...a,round:0,currentTurnIndex:-1,isActive:!1}))},className:"px-4 py-2 rounded-lg bg-red-100 text-red-700 hover:bg-red-200",children:"End Combat"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>{0!==n.length&&k(a=>({...a,round:1,currentTurnIndex:0,isActive:!0}))},disabled:0===i.combatants.length,className:"px-6 py-2 rounded-lg font-bold bg-green-600 text-white hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Start Encounter"}),(0,b.jsx)("button",{onClick:()=>{k(a=>({...a,combatants:[...a.combatants]}))},className:"px-4 py-2 rounded-lg bg-primary-600 text-white hover:bg-primary-700",children:"Sort Initiative"}),(0,b.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 bg-amber-50 rounded-lg border border-amber-200",children:[(0,b.jsx)("input",{type:"checkbox",checked:i.applySurprise,onChange:()=>{k(a=>({...a,applySurprise:!a.applySurprise}))},className:"w-4 h-4 rounded text-amber-600"}),(0,b.jsx)("span",{className:"text-sm text-amber-800",children:"Apply Surprise"})]})]}),(0,b.jsx)("button",{onClick:()=>{k(a=>({...a,combatants:a.combatants.map(a=>({...a,currentHealth:a.maxHealth,currentEnergy:a.maxEnergy,ap:4,conditions:[],isSurprised:!1})),round:0,currentTurnIndex:-1,isActive:!1}))},className:"px-4 py-2 rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200 ml-auto",children:"Reset All"}),(0,b.jsx)("button",{onClick:()=>k(a=>({...a,combatants:[]})),className:"px-4 py-2 rounded-lg bg-red-100 text-red-700 hover:bg-red-200",children:"Clear All"})]}),(0,b.jsx)("div",{className:"space-y-3",children:0===n.length?(0,b.jsx)("div",{className:"bg-white rounded-xl shadow-md p-8 text-center text-gray-500",children:"No combatants added yet. Add some using the panel on the right."}):n.map((a,c)=>(0,b.jsx)(j,{combatant:a,isCurrentTurn:i.isActive&&c===i.currentTurnIndex,onUpdate:b=>o(a.id,b),onRemove:()=>{var b;return b=a.id,void k(a=>({...a,combatants:a.combatants.filter(a=>a.id!==b)}))},onAddCondition:b=>{var c;let d;return c=a.id,void((d=h.find(a=>a.name===b))&&k(a=>({...a,combatants:a.combatants.map(a=>a.id!==c||a.conditions.some(a=>a.name===b)?a:{...a,conditions:[...a.conditions,{name:b,level:+!!d.decaying}]})})))},onRemoveCondition:b=>{var c;return c=a.id,void k(a=>({...a,combatants:a.combatants.map(a=>a.id!==c?a:{...a,conditions:a.conditions.filter(a=>a.name!==b)})}))},onUpdateConditionLevel:(b,c)=>{var d;return d=a.id,void k(a=>({...a,combatants:a.combatants.map(a=>a.id!==d?a:{...a,conditions:a.conditions.map(a=>{if(a.name!==b)return a;let d=a.level+c;return d<=0?null:{...a,level:d}}).filter(a=>null!==a)})}))},onUpdateAP:b=>{var c;return c=a.id,void k(a=>({...a,combatants:a.combatants.map(a=>a.id!==c?a:{...a,ap:Math.max(0,Math.min(10,a.ap+b))})}))},onDamage:b=>p(a.id,b),onHeal:b=>q(a.id,b)},a.id))})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 sticky top-24",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Add Combatant"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),(0,b.jsx)("input",{type:"text",value:l.name,onChange:a=>m(b=>({...b,name:a.target.value})),placeholder:"Creature name...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Roll"}),(0,b.jsx)("input",{type:"number",value:l.initiative||"",onChange:a=>m(b=>({...b,initiative:parseInt(a.target.value)||0})),placeholder:"Init",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Acuity"}),(0,b.jsx)("input",{type:"number",value:l.acuity||"",onChange:a=>m(b=>({...b,acuity:parseInt(a.target.value)||0})),placeholder:"Acuity",className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max HP"}),(0,b.jsx)("input",{type:"number",value:l.maxHealth,onChange:a=>m(b=>({...b,maxHealth:parseInt(a.target.value)||1})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"radio",name:"side",checked:l.isAlly,onChange:()=>m(a=>({...a,isAlly:!0})),className:"w-4 h-4 text-blue-600"}),(0,b.jsx)("span",{className:"text-sm text-gray-700",children:"Ally"})]}),(0,b.jsxs)("label",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"radio",name:"side",checked:!l.isAlly,onChange:()=>m(a=>({...a,isAlly:!1})),className:"w-4 h-4 text-red-600"}),(0,b.jsx)("span",{className:"text-sm text-gray-700",children:"Enemy"})]}),(0,b.jsxs)("label",{className:"flex items-center gap-2 ml-auto",children:[(0,b.jsx)("input",{type:"checkbox",checked:l.isSurprised,onChange:a=>m(b=>({...b,isSurprised:a.target.checked})),className:"w-4 h-4 rounded text-amber-600"}),(0,b.jsx)("span",{className:"text-sm text-gray-700",children:"Surprised"})]})]}),(0,b.jsx)("button",{onClick:()=>{if(!l.name.trim())return;let a={id:Math.random().toString(36).substring(2,9),name:l.name,initiative:l.initiative,acuity:l.acuity,maxHealth:l.maxHealth,maxEnergy:l.maxEnergy,armor:l.armor,evasion:l.evasion,currentHealth:l.maxHealth,currentEnergy:l.maxEnergy,ap:4,conditions:[],notes:"",isAlly:l.isAlly,isSurprised:l.isSurprised};k(b=>({...b,combatants:[...b.combatants,a]})),m({name:"",initiative:0,acuity:0,maxHealth:20,maxEnergy:10,armor:0,evasion:10,isAlly:!0,isSurprised:!1})},disabled:!l.name.trim(),className:"w-full py-2 rounded-lg font-bold bg-green-600 text-white hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Add Creature"})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Conditions Reference"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:h.map(a=>(0,b.jsxs)("span",{title:a.description,className:(0,d.cn)("px-2 py-1 text-xs rounded-full cursor-help",a.decaying?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-600"),children:[a.name,a.decaying&&" ⬇"]},a.name))}),(0,b.jsx)("p",{className:"mt-2 text-xs text-gray-500",children:"⬇ = Decaying (has levels). Hover for description."})]})]})]})]}):(0,b.jsx)("div",{className:"max-w-7xl mx-auto flex items-center justify-center py-20",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Loading encounter..."})]})})}function j({combatant:a,isCurrentTurn:e,onUpdate:f,onRemove:g,onAddCondition:i,onRemoveCondition:j,onUpdateConditionLevel:k,onUpdateAP:l,onDamage:m,onHeal:n}){let[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(""),w=a.maxHealth>0?a.currentHealth/a.maxHealth*100:0,x=a.currentHealth<=0&&!a.isAlly,y=()=>{let a=parseInt(o);a>0&&(m(a),p(""))},z=()=>{let a=parseInt(q);a>0&&(n(a),r(""))};return(0,b.jsx)("div",{className:(0,d.cn)("bg-white rounded-xl shadow-md p-4 transition-all",e&&"ring-2 ring-primary-500 shadow-lg",x&&"bg-red-50 opacity-75",a.isAlly?"border-l-4 border-l-blue-500":"border-l-4 border-l-red-500"),children:(0,b.jsxs)("div",{className:"flex items-start gap-4",children:[(0,b.jsxs)("div",{className:(0,d.cn)("w-12 h-12 rounded-lg flex flex-col items-center justify-center",e?"bg-primary-600 text-white":"bg-gray-100 text-gray-600"),children:[(0,b.jsx)("span",{className:"text-xl font-bold",children:a.initiative}),0!==a.acuity&&(0,b.jsxs)("span",{className:"text-xs opacity-75",children:["+",a.acuity]})]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("h3",{className:(0,d.cn)("text-lg font-bold",x&&"line-through text-gray-500"),children:a.name}),a.isSurprised&&(0,b.jsx)("span",{className:"px-2 py-0.5 text-xs bg-amber-100 text-amber-700 rounded-full font-medium",children:"Surprised"}),e&&(0,b.jsx)("span",{className:"px-2 py-0.5 text-xs bg-primary-100 text-primary-700 rounded-full font-medium",children:"Current Turn"}),x&&(0,b.jsx)("span",{className:"px-2 py-0.5 text-xs bg-red-100 text-red-700 rounded-full font-medium",children:"Down"}),(0,b.jsxs)("div",{className:"flex items-center gap-1 ml-auto",children:[(0,b.jsx)("span",{className:"text-sm text-gray-500",children:"AP:"}),(0,b.jsx)("button",{onClick:()=>l(-1),className:"w-6 h-6 rounded bg-gray-200 hover:bg-gray-300 flex items-center justify-center font-bold text-sm",children:"−"}),(0,b.jsx)("span",{className:(0,d.cn)("w-8 text-center font-bold",0===a.ap&&"text-red-600"),children:a.ap}),(0,b.jsx)("button",{onClick:()=>l(1),className:"w-6 h-6 rounded bg-gray-200 hover:bg-gray-300 flex items-center justify-center font-bold text-sm",children:"+"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 mb-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-sm text-gray-500",children:"HP:"}),(0,b.jsx)("input",{type:"number",value:a.currentHealth,onChange:a=>f({currentHealth:parseInt(a.target.value)||0}),className:(0,d.cn)("w-16 px-2 py-1 text-sm border rounded text-center font-medium",a.currentHealth<=0?"border-red-300 bg-red-50 text-red-700":"border-gray-300")}),(0,b.jsx)("span",{className:"text-gray-400",children:"/"}),(0,b.jsx)("input",{type:"number",value:a.maxHealth,onChange:a=>f({maxHealth:parseInt(a.target.value)||1}),className:"w-16 px-2 py-1 text-sm border border-gray-300 rounded text-center"})]}),(0,b.jsx)("div",{className:"flex-1 h-3 bg-gray-200 rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:(0,d.cn)("h-full transition-all",w>50?"bg-green-500":w>25?"bg-yellow-500":"bg-red-500"),style:{width:`${Math.max(0,Math.min(100,w))}%`}})})]}),a.conditions.length>0&&(0,b.jsx)("div",{className:"flex flex-wrap gap-1 mb-3",children:a.conditions.map(a=>{let c=h.find(b=>b.name===a.name),e=c?.decaying||!1;return(0,b.jsxs)("div",{className:(0,d.cn)("px-2 py-0.5 text-xs rounded-full flex items-center gap-1",e?"bg-purple-100 text-purple-800":"bg-amber-100 text-amber-800"),title:c?.description,children:[(0,b.jsxs)("span",{onClick:()=>e&&k(a.name,1),className:(0,d.cn)(e&&"cursor-pointer hover:underline"),children:[a.name,e&&` (${a.level})`]}),(0,b.jsx)("button",{onClick:()=>e?k(a.name,-1):j(a.name),className:"hover:text-red-600 font-bold",title:e?"Decrease level (removes at 0)":"Remove condition",children:"×"})]},a.name)})}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2 pt-2 border-t border-gray-100",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("input",{type:"number",value:o,onChange:a=>p(a.target.value),placeholder:"Dmg",className:"w-14 px-2 py-1 text-sm border border-gray-300 rounded",onKeyDown:a=>"Enter"===a.key&&y()}),(0,b.jsx)("button",{onClick:y,className:"px-2 py-1 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200",children:"Dmg"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("input",{type:"number",value:q,onChange:a=>r(a.target.value),placeholder:"Heal",className:"w-14 px-2 py-1 text-sm border border-gray-300 rounded",onKeyDown:a=>"Enter"===a.key&&z()}),(0,b.jsx)("button",{onClick:z,className:"px-2 py-1 text-sm bg-green-100 text-green-700 rounded hover:bg-green-200",children:"Heal"})]}),(0,b.jsxs)("button",{onClick:()=>t(!s),className:(0,d.cn)("px-2 py-1 text-sm rounded",s?"bg-amber-500 text-white":"bg-amber-100 text-amber-700 hover:bg-amber-200"),children:[s?"▲":"▼"," Conditions"]}),(0,b.jsx)("button",{onClick:g,className:"px-2 py-1 text-sm bg-gray-100 text-gray-700 rounded hover:bg-gray-200 ml-auto",children:"✕"})]}),s&&(0,b.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsxs)("select",{value:u,onChange:a=>v(a.target.value),className:"flex-1 px-3 py-1 text-sm border border-gray-300 rounded",children:[(0,b.jsx)("option",{value:"",children:"Select Condition..."}),h.map(c=>(0,b.jsxs)("option",{value:c.name,disabled:a.conditions.some(a=>a.name===c.name),children:[c.name,c.decaying?" ⬇":""]},c.name))]}),(0,b.jsx)("button",{onClick:()=>{u&&(i(u),v(""))},disabled:!u,className:"px-3 py-1 text-sm bg-amber-600 text-white rounded hover:bg-amber-700 disabled:opacity-50",children:"Add"})]}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Click condition name to increase level. Click × to decrease/remove."})]})]})]})})}function k(){return(0,b.jsx)(e.ProtectedRoute,{children:(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 py-8 px-4",children:(0,b.jsx)(i,{})})})}a.s(["default",()=>k],69597)}];

//# sourceMappingURL=src_app_%28main%29_encounter-tracker_page_tsx_4610d46a._.js.map